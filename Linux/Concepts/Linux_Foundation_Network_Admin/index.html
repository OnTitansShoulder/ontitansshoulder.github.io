<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="We are all standing on the shoulders of the giants..."><meta name=author content="Zhongkai Liu"><link rel="shortcut icon" href=../../../assets/favicon.ico><meta name=generator content="mkdocs-1.1.2, mkdocs-material-6.2.6"><title>Linux Network Adminstration - Ontitansshoulder</title><link rel=stylesheet href=../../../assets/stylesheets/main.cb6bc1d0.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.39b8e14a.min.css><meta name=theme-color content=#4051b5><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style><link rel=stylesheet href=../../../css/extra.css></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#networking-concepts class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid" aria-label=Header> <a href=../../.. title=Ontitansshoulder class="md-header-nav__button md-logo" aria-label=Ontitansshoulder> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg> </a> <label class="md-header-nav__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header-nav__title data-md-component=header-title> <div class=md-header-nav__ellipsis> <div class=md-header-nav__topic> <span class=md-ellipsis> Ontitansshoulder </span> </div> <div class=md-header-nav__topic> <span class=md-ellipsis> Linux Network Adminstration </span> </div> </div> </div> <label class="md-header-nav__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query data-md-state=active required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <button type=reset class="md-search__icon md-icon" aria-label=Clear data-md-component=search-reset tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class="md-tabs__link md-tabs__link--active"> Notes </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title=Ontitansshoulder class="md-nav__button md-logo" aria-label=Ontitansshoulder> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg> </a> Ontitansshoulder </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1 type=checkbox id=nav-1 checked> <label class=md-nav__link for=nav-1> Notes <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Notes data-md-level=1> <label class=md-nav__title for=nav-1> <span class="md-nav__icon md-icon"></span> Notes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> Welcome </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-2 type=checkbox id=nav-1-2> <label class=md-nav__link for=nav-1-2> Foundamentals <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Foundamentals data-md-level=2> <label class=md-nav__title for=nav-1-2> <span class="md-nav__icon md-icon"></span> Foundamentals </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Foundamental/Data_Structures_and_Algos/ class=md-nav__link> Data Structures and Algos </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-3 type=checkbox id=nav-1-3 checked> <label class=md-nav__link for=nav-1-3> Linux <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Linux data-md-level=2> <label class=md-nav__title for=nav-1-3> <span class="md-nav__icon md-icon"></span> Linux </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-3-1 type=checkbox id=nav-1-3-1 checked> <label class=md-nav__link for=nav-1-3-1> Concepts <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Concepts data-md-level=3> <label class=md-nav__title for=nav-1-3-1> <span class="md-nav__icon md-icon"></span> Concepts </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Linux_Foundation/ class=md-nav__link> Linux Foundation </a> </li> <li class=md-nav__item> <a href=../Linux_Foundation_System_Admin/ class=md-nav__link> Linux System Administration </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Linux Network Administration <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Linux Network Administration </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#networking-concepts class=md-nav__link> Networking Concepts </a> <nav class=md-nav aria-label="Networking Concepts"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#the-osi-model class=md-nav__link> The OSI Model </a> <nav class=md-nav aria-label="The OSI Model"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#physical-layer class=md-nav__link> Physical Layer </a> </li> <li class=md-nav__item> <a href=#data-link-layer class=md-nav__link> Data Link Layer </a> </li> <li class=md-nav__item> <a href=#network-layer class=md-nav__link> Network Layer </a> <nav class=md-nav aria-label="Network Layer"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#internet-protocol class=md-nav__link> Internet Protocol </a> </li> <li class=md-nav__item> <a href=#ip-address class=md-nav__link> IP Address </a> </li> <li class=md-nav__item> <a href=#ip-routing class=md-nav__link> IP Routing </a> </li> <li class=md-nav__item> <a href=#ipv4-and-ipv6 class=md-nav__link> IPv4 and IPv6 </a> </li> <li class=md-nav__item> <a href=#ip-management-tools class=md-nav__link> IP Management Tools </a> </li> <li class=md-nav__item> <a href=#network-types class=md-nav__link> Network Types </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#transport-layer class=md-nav__link> Transport Layer </a> <nav class=md-nav aria-label="Transport Layer"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#tcp-udp-sctp class=md-nav__link> TCP, UDP, SCTP </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#session-layer class=md-nav__link> Session Layer </a> </li> <li class=md-nav__item> <a href=#presentation-layer class=md-nav__link> Presentation Layer </a> </li> <li class=md-nav__item> <a href=#application-layer class=md-nav__link> Application Layer </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#manage-system-services-with-systemd class=md-nav__link> Manage System Services with systemd </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#network-configuration class=md-nav__link> Network Configuration </a> <nav class=md-nav aria-label="Network Configuration"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#layer-2-configuration class=md-nav__link> Layer 2 Configuration </a> </li> <li class=md-nav__item> <a href=#layer-3-configuration class=md-nav__link> Layer 3 Configuration </a> </li> <li class=md-nav__item> <a href=#boot-time-configuration class=md-nav__link> Boot Time Configuration </a> <nav class=md-nav aria-label="Boot Time Configuration"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#network-manager class=md-nav__link> Network Manager </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#vpn class=md-nav__link> VPN </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#network-troubleshoot-and-monitor class=md-nav__link> Network Troubleshoot and Monitor </a> <nav class=md-nav aria-label="Network Troubleshoot and Monitor"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#client-side-troubleshoot class=md-nav__link> Client side Troubleshoot </a> </li> <li class=md-nav__item> <a href=#server-side-troubleshoot class=md-nav__link> Server side Troubleshoot </a> </li> <li class=md-nav__item> <a href=#network-monitoring class=md-nav__link> Network Monitoring </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#remote-access class=md-nav__link> Remote Access </a> <nav class=md-nav aria-label="Remote Access"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cryptography class=md-nav__link> Cryptography </a> </li> <li class=md-nav__item> <a href=#secure-shell class=md-nav__link> Secure Shell </a> <nav class=md-nav aria-label="Secure Shell"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#client-ssh-config class=md-nav__link> Client SSH config </a> </li> <li class=md-nav__item> <a href=#openssh-tunnel class=md-nav__link> OpenSSH Tunnel </a> </li> <li class=md-nav__item> <a href=#parallel-ssh-commands class=md-nav__link> Parallel SSH Commands </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#vnc-server class=md-nav__link> VNC Server </a> <nav class=md-nav aria-label="VNC Server"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#x-window-system class=md-nav__link> X Window System </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#domain-name-service class=md-nav__link> Domain Name Service </a> <nav class=md-nav aria-label="Domain Name Service"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#queryrecord-types class=md-nav__link> Query/Record Types </a> </li> <li class=md-nav__item> <a href=#dns-queries class=md-nav__link> DNS Queries </a> <nav class=md-nav aria-label="DNS Queries"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#dns-client class=md-nav__link> DNS Client </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#bind class=md-nav__link> BIND </a> </li> <li class=md-nav__item> <a href=#dns-tools class=md-nav__link> DNS Tools </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#http-servers class=md-nav__link> HTTP Servers </a> <nav class=md-nav aria-label="HTTP Servers"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#logs class=md-nav__link> Logs </a> </li> <li class=md-nav__item> <a href=#mod_userdir class=md-nav__link> mod_userdir </a> </li> <li class=md-nav__item> <a href=#ipport-virtual-hosts class=md-nav__link> IP/Port Virtual Hosts </a> </li> <li class=md-nav__item> <a href=#access-control class=md-nav__link> Access Control </a> </li> <li class=md-nav__item> <a href=#secure-sockets-layer class=md-nav__link> Secure Sockets Layer </a> </li> <li class=md-nav__item> <a href=#rewriting-rules-with-mod_rewrite class=md-nav__link> Rewriting rules with mod_rewrite </a> </li> <li class=md-nav__item> <a href=#mod_alias class=md-nav__link> mod_alias </a> </li> <li class=md-nav__item> <a href=#mod_status-mod_include-mod_perl class=md-nav__link> mod_status, mod_include, mod_perl </a> </li> <li class=md-nav__item> <a href=#multi-processing-modules-mpms class=md-nav__link> Multi-Processing Modules (MPMs) </a> </li> <li class=md-nav__item> <a href=#load-test class=md-nav__link> Load Test </a> </li> <li class=md-nav__item> <a href=#load-balance class=md-nav__link> Load Balance </a> </li> <li class=md-nav__item> <a href=#cacheing-and-proxy class=md-nav__link> Cacheing and Proxy </a> </li> <li class=md-nav__item> <a href=#c10k-problem-and-speciality-http-servers class=md-nav__link> C10k Problem and Speciality HTTP Servers </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#email-servers class=md-nav__link> Email Servers </a> <nav class=md-nav aria-label="Email Servers"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#email-lifecycle class=md-nav__link> Email lifecycle </a> <nav class=md-nav aria-label="Email lifecycle"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#postfix class=md-nav__link> Postfix </a> </li> <li class=md-nav__item> <a href=#dovecot class=md-nav__link> Dovecot </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#file-sharing class=md-nav__link> File Sharing </a> <nav class=md-nav aria-label="File Sharing"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#vsftpd class=md-nav__link> vsftpd </a> </li> <li class=md-nav__item> <a href=#rsync class=md-nav__link> rsync </a> </li> <li class=md-nav__item> <a href=#scp-and-sftp class=md-nav__link> scp and sftp </a> </li> <li class=md-nav__item> <a href=#webdav class=md-nav__link> WebDAV </a> </li> <li class=md-nav__item> <a href=#bittorrent class=md-nav__link> BitTorrent </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#advanced-networking class=md-nav__link> Advanced Networking </a> <nav class=md-nav aria-label="Advanced Networking"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#routing class=md-nav__link> Routing </a> </li> <li class=md-nav__item> <a href=#vlan class=md-nav__link> VLAN </a> </li> <li class=md-nav__item> <a href=#dhcp-server class=md-nav__link> DHCP Server </a> </li> <li class=md-nav__item> <a href=#network-time-protocol class=md-nav__link> Network Time Protocol </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-3-2 type=checkbox id=nav-1-3-2> <label class=md-nav__link for=nav-1-3-2> Practical References <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Practical References" data-md-level=3> <label class=md-nav__title for=nav-1-3-2> <span class="md-nav__icon md-icon"></span> Practical References </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Commands/Freq-Used-Shell-Cmds/ class=md-nav__link> Freq Used Shell Cmds </a> </li> <li class=md-nav__item> <a href=../../Commands/Networking-Shell-Cmds/ class=md-nav__link> Freq Used Network Cmds </a> </li> <li class=md-nav__item> <a href=../../Commands/Text-Manipulating-Cmds/ class=md-nav__link> Text Manipulating Cmds </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-3-3 type=checkbox id=nav-1-3-3> <label class=md-nav__link for=nav-1-3-3> Tricks <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Tricks data-md-level=3> <label class=md-nav__title for=nav-1-3-3> <span class="md-nav__icon md-icon"></span> Tricks </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../References/Freq-Tasks/ class=md-nav__link> Freq Linux Tasks </a> </li> <li class=md-nav__item> <a href=../../References/Terminal-Tricks/ class=md-nav__link> Linux Terminal Tricks </a> </li> <li class=md-nav__item> <a href=../../References/Vim-Tricks/ class=md-nav__link> Vim Tricks </a> </li> <li class=md-nav__item> <a href=../../References/Account-Administration/ class=md-nav__link> Manage Accounts & Groups </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-4 type=checkbox id=nav-1-4> <label class=md-nav__link for=nav-1-4> Cloud <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Cloud data-md-level=2> <label class=md-nav__title for=nav-1-4> <span class="md-nav__icon md-icon"></span> Cloud </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Cloud-and-Containers/Architecture/Cloud-App-Architecture/ class=md-nav__link> Cloud App Architecture </a> </li> <li class=md-nav__item> <a href=../../../Cloud-and-Containers/Docker/Docker/ class=md-nav__link> Docker and Containers </a> </li> <li class=md-nav__item> <a href=../../../Cloud-and-Containers/Docker/Docker-Practical/ class=md-nav__link> Docker Practical </a> </li> <li class=md-nav__item> <a href=../../../Cloud-and-Containers/k8s/K8s-Knowledge/ class=md-nav__link> K8s Knowledge </a> </li> <li class=md-nav__item> <a href=../../../Cloud-and-Containers/k8s/service_mesh/ class=md-nav__link> Service Mesh </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-5 type=checkbox id=nav-1-5> <label class=md-nav__link for=nav-1-5> Monitoring <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Monitoring data-md-level=2> <label class=md-nav__title for=nav-1-5> <span class="md-nav__icon md-icon"></span> Monitoring </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-5-1 type=checkbox id=nav-1-5-1> <label class=md-nav__link for=nav-1-5-1> Splunk <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Splunk data-md-level=3> <label class=md-nav__title for=nav-1-5-1> <span class="md-nav__icon md-icon"></span> Splunk </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Dev-Tools-Reference/Splunk/Splunk-References/ class=md-nav__link> Splunk Knowledge </a> </li> <li class=md-nav__item> <a href=../../../Dev-Tools-Reference/Splunk/Splunk-Dashboarding/ class=md-nav__link> Splunk Dashboarding </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-6 type=checkbox id=nav-1-6> <label class=md-nav__link for=nav-1-6> Programming Langs <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Programming Langs" data-md-level=2> <label class=md-nav__title for=nav-1-6> <span class="md-nav__icon md-icon"></span> Programming Langs </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-6-1 type=checkbox id=nav-1-6-1> <label class=md-nav__link for=nav-1-6-1> Golang <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Golang data-md-level=3> <label class=md-nav__title for=nav-1-6-1> <span class="md-nav__icon md-icon"></span> Golang </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Programming-Lang-Reference/Golang/Golang-Specs/ class=md-nav__link> Golang Language Reference </a> </li> <li class=md-nav__item> <a href=../../../Programming-Lang-Reference/Golang/Best-Practices/ class=md-nav__link> Effective Go </a> </li> <li class=md-nav__item> <a href=../../../Programming-Lang-Reference/Golang/Freq-Used-Libs/ class=md-nav__link> Go libraries and examples </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-6-2 type=checkbox id=nav-1-6-2> <label class=md-nav__link for=nav-1-6-2> Java <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Java data-md-level=3> <label class=md-nav__title for=nav-1-6-2> <span class="md-nav__icon md-icon"></span> Java </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Programming-Lang-Reference/Java/Style-Guide/ class=md-nav__link> Style Guide </a> </li> <li class=md-nav__item> <a href=../../../Programming-Lang-Reference/Java/Best-Practices/ class=md-nav__link> Effective Java </a> </li> <li class=md-nav__item> <a href=../../../Programming-Lang-Reference/Java/Design-Patterns/ class=md-nav__link> Java Design Patterns </a> </li> <li class=md-nav__item> <a href=../../../Programming-Lang-Reference/Java/Testing-Design-Patterns/ class=md-nav__link> Testing Design Patterns </a> </li> <li class=md-nav__item> <a href=../../../Programming-Lang-Reference/Java/Java_Std_Lib_Cheatsheet/ class=md-nav__link> Java Std Lib Cheatsheet </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-6-3 type=checkbox id=nav-1-6-3> <label class=md-nav__link for=nav-1-6-3> C++ <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=C++ data-md-level=3> <label class=md-nav__title for=nav-1-6-3> <span class="md-nav__icon md-icon"></span> C++ </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Programming-Lang-Reference/CPP/CPlusPlus_Lang_Specs/ class=md-nav__link> C++ Language Reference </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-6-4 type=checkbox id=nav-1-6-4> <label class=md-nav__link for=nav-1-6-4> Perl <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Perl data-md-level=3> <label class=md-nav__title for=nav-1-6-4> <span class="md-nav__icon md-icon"></span> Perl </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Programming-Lang-Reference/Perl/Perl-Lang-Specs/ class=md-nav__link> Perl Language Reference </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-6-5 type=checkbox id=nav-1-6-5> <label class=md-nav__link for=nav-1-6-5> Shell <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Shell data-md-level=3> <label class=md-nav__title for=nav-1-6-5> <span class="md-nav__icon md-icon"></span> Shell </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Programming-Lang-Reference/Shell/Shell-Scripting/ class=md-nav__link> Shell Scripting </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../Programming-Lang-Reference/Github-Markdown/ class=md-nav__link> Github Markdown Guide </a> </li> <li class=md-nav__item> <a href=../../../Programming-Lang-Reference/Regex-Specs/ class=md-nav__link> Regex Cheatsheet </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-7 type=checkbox id=nav-1-7> <label class=md-nav__link for=nav-1-7> Reading Notes <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Reading Notes" data-md-level=2> <label class=md-nav__title for=nav-1-7> <span class="md-nav__icon md-icon"></span> Reading Notes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Reading-Notes/How-Netflix-Works/ class=md-nav__link> How Netflix Works </a> </li> <li class=md-nav__item> <a href=../../../Reading-Notes/System-Design-Concepts/ class=md-nav__link> System Design Guide </a> </li> <li class=md-nav__item> <a href=../../../Reading-Notes/Why-Latency-Matters/ class=md-nav__link> Why Latency Matters </a> </li> <li class=md-nav__item> <a href=../../../Reading-Notes/DevOps_SRE/ class=md-nav__link> Intro to DevOps and SRE </a> </li> <li class=md-nav__item> <a href=../../../Reading-Notes/Leading-without-formal-authority/ class=md-nav__link> Leading Without Formal Authority </a> </li> <li class=md-nav__item> <a href=../../../Reading-Notes/Google-SRE-Book/ class=md-nav__link> Google SRE Book </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../Good-Reads/ class=md-nav__link> Good Reads </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#networking-concepts class=md-nav__link> Networking Concepts </a> <nav class=md-nav aria-label="Networking Concepts"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#the-osi-model class=md-nav__link> The OSI Model </a> <nav class=md-nav aria-label="The OSI Model"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#physical-layer class=md-nav__link> Physical Layer </a> </li> <li class=md-nav__item> <a href=#data-link-layer class=md-nav__link> Data Link Layer </a> </li> <li class=md-nav__item> <a href=#network-layer class=md-nav__link> Network Layer </a> <nav class=md-nav aria-label="Network Layer"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#internet-protocol class=md-nav__link> Internet Protocol </a> </li> <li class=md-nav__item> <a href=#ip-address class=md-nav__link> IP Address </a> </li> <li class=md-nav__item> <a href=#ip-routing class=md-nav__link> IP Routing </a> </li> <li class=md-nav__item> <a href=#ipv4-and-ipv6 class=md-nav__link> IPv4 and IPv6 </a> </li> <li class=md-nav__item> <a href=#ip-management-tools class=md-nav__link> IP Management Tools </a> </li> <li class=md-nav__item> <a href=#network-types class=md-nav__link> Network Types </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#transport-layer class=md-nav__link> Transport Layer </a> <nav class=md-nav aria-label="Transport Layer"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#tcp-udp-sctp class=md-nav__link> TCP, UDP, SCTP </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#session-layer class=md-nav__link> Session Layer </a> </li> <li class=md-nav__item> <a href=#presentation-layer class=md-nav__link> Presentation Layer </a> </li> <li class=md-nav__item> <a href=#application-layer class=md-nav__link> Application Layer </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#manage-system-services-with-systemd class=md-nav__link> Manage System Services with systemd </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#network-configuration class=md-nav__link> Network Configuration </a> <nav class=md-nav aria-label="Network Configuration"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#layer-2-configuration class=md-nav__link> Layer 2 Configuration </a> </li> <li class=md-nav__item> <a href=#layer-3-configuration class=md-nav__link> Layer 3 Configuration </a> </li> <li class=md-nav__item> <a href=#boot-time-configuration class=md-nav__link> Boot Time Configuration </a> <nav class=md-nav aria-label="Boot Time Configuration"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#network-manager class=md-nav__link> Network Manager </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#vpn class=md-nav__link> VPN </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#network-troubleshoot-and-monitor class=md-nav__link> Network Troubleshoot and Monitor </a> <nav class=md-nav aria-label="Network Troubleshoot and Monitor"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#client-side-troubleshoot class=md-nav__link> Client side Troubleshoot </a> </li> <li class=md-nav__item> <a href=#server-side-troubleshoot class=md-nav__link> Server side Troubleshoot </a> </li> <li class=md-nav__item> <a href=#network-monitoring class=md-nav__link> Network Monitoring </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#remote-access class=md-nav__link> Remote Access </a> <nav class=md-nav aria-label="Remote Access"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cryptography class=md-nav__link> Cryptography </a> </li> <li class=md-nav__item> <a href=#secure-shell class=md-nav__link> Secure Shell </a> <nav class=md-nav aria-label="Secure Shell"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#client-ssh-config class=md-nav__link> Client SSH config </a> </li> <li class=md-nav__item> <a href=#openssh-tunnel class=md-nav__link> OpenSSH Tunnel </a> </li> <li class=md-nav__item> <a href=#parallel-ssh-commands class=md-nav__link> Parallel SSH Commands </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#vnc-server class=md-nav__link> VNC Server </a> <nav class=md-nav aria-label="VNC Server"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#x-window-system class=md-nav__link> X Window System </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#domain-name-service class=md-nav__link> Domain Name Service </a> <nav class=md-nav aria-label="Domain Name Service"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#queryrecord-types class=md-nav__link> Query/Record Types </a> </li> <li class=md-nav__item> <a href=#dns-queries class=md-nav__link> DNS Queries </a> <nav class=md-nav aria-label="DNS Queries"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#dns-client class=md-nav__link> DNS Client </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#bind class=md-nav__link> BIND </a> </li> <li class=md-nav__item> <a href=#dns-tools class=md-nav__link> DNS Tools </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#http-servers class=md-nav__link> HTTP Servers </a> <nav class=md-nav aria-label="HTTP Servers"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#logs class=md-nav__link> Logs </a> </li> <li class=md-nav__item> <a href=#mod_userdir class=md-nav__link> mod_userdir </a> </li> <li class=md-nav__item> <a href=#ipport-virtual-hosts class=md-nav__link> IP/Port Virtual Hosts </a> </li> <li class=md-nav__item> <a href=#access-control class=md-nav__link> Access Control </a> </li> <li class=md-nav__item> <a href=#secure-sockets-layer class=md-nav__link> Secure Sockets Layer </a> </li> <li class=md-nav__item> <a href=#rewriting-rules-with-mod_rewrite class=md-nav__link> Rewriting rules with mod_rewrite </a> </li> <li class=md-nav__item> <a href=#mod_alias class=md-nav__link> mod_alias </a> </li> <li class=md-nav__item> <a href=#mod_status-mod_include-mod_perl class=md-nav__link> mod_status, mod_include, mod_perl </a> </li> <li class=md-nav__item> <a href=#multi-processing-modules-mpms class=md-nav__link> Multi-Processing Modules (MPMs) </a> </li> <li class=md-nav__item> <a href=#load-test class=md-nav__link> Load Test </a> </li> <li class=md-nav__item> <a href=#load-balance class=md-nav__link> Load Balance </a> </li> <li class=md-nav__item> <a href=#cacheing-and-proxy class=md-nav__link> Cacheing and Proxy </a> </li> <li class=md-nav__item> <a href=#c10k-problem-and-speciality-http-servers class=md-nav__link> C10k Problem and Speciality HTTP Servers </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#email-servers class=md-nav__link> Email Servers </a> <nav class=md-nav aria-label="Email Servers"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#email-lifecycle class=md-nav__link> Email lifecycle </a> <nav class=md-nav aria-label="Email lifecycle"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#postfix class=md-nav__link> Postfix </a> </li> <li class=md-nav__item> <a href=#dovecot class=md-nav__link> Dovecot </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#file-sharing class=md-nav__link> File Sharing </a> <nav class=md-nav aria-label="File Sharing"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#vsftpd class=md-nav__link> vsftpd </a> </li> <li class=md-nav__item> <a href=#rsync class=md-nav__link> rsync </a> </li> <li class=md-nav__item> <a href=#scp-and-sftp class=md-nav__link> scp and sftp </a> </li> <li class=md-nav__item> <a href=#webdav class=md-nav__link> WebDAV </a> </li> <li class=md-nav__item> <a href=#bittorrent class=md-nav__link> BitTorrent </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#advanced-networking class=md-nav__link> Advanced Networking </a> <nav class=md-nav aria-label="Advanced Networking"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#routing class=md-nav__link> Routing </a> </li> <li class=md-nav__item> <a href=#vlan class=md-nav__link> VLAN </a> </li> <li class=md-nav__item> <a href=#dhcp-server class=md-nav__link> DHCP Server </a> </li> <li class=md-nav__item> <a href=#network-time-protocol class=md-nav__link> Network Time Protocol </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <h1>Linux Network Administration</h1> <p>This set of notes were taken from the Linux Foundation Course: <a href=https://trainingportal.linuxfoundation.org/learn/course/linux-networking-and-administration-lfs211/ target=_blank>Linux Networking and Administration (LFS211)</a>.</p> <h2 id=networking-concepts>Networking Concepts<a class=headerlink href=#networking-concepts title="Permanent link">&para;</a></h2> <h3 id=the-osi-model>The OSI Model<a class=headerlink href=#the-osi-model title="Permanent link">&para;</a></h3> <p>The <strong>Open System Interconnection (OSI)</strong> model was created to standardize the language used to describe networking protocols.</p> <p>OSI defines the manner in which systems communicate with one another using abstraction <strong>layers</strong>. Each layer communicates with the layer directly above and below. Not all layers are used at all times.</p> <p><img src=https://d36ai2hkxl16us.cloudfront.net/course-uploads/e0df7fbf-a057-42af-8a1f-590912be5460/47s4lc4nv4i6-osi-stack.png></p> <p>Most networking stacks have layer 1-4 and 7. The layer 5-6 is often combined into layer 4 or 7.</p> <h4 id=physical-layer>Physical Layer<a class=headerlink href=#physical-layer title="Permanent link">&para;</a></h4> <p>The <strong>Physical Layer</strong> is the lowest possible layer and deals with the actual physical transfer of information; it deals with transferring bits over a physical medium such as:</p> <ul> <li>Electric pulses over copper cables</li> <li>Laser pulses over fiber optic cables</li> <li>Frequency modulations over radio waves</li> <li>Scraps of paper over carrier pigeons</li> </ul> <p>Some protocols, hardware types and standards defined for this layer:</p> <ul> <li>IEEE 802.3: Copper or fiber connections (examples and additional information about various cables and connection is available on Wikipedia, in the "10BASE2" article)</li> <li>IEEE 802.11: Wireless (Wi-Fi) connections</li> <li>Bluetooth: Wireless connections</li> <li>USB: Copper connections</li> <li>RS232: Copper serial connections</li> </ul> <p>A <strong>Frame</strong> is a unit of data collected from the physical layer interface.</p> <h4 id=data-link-layer>Data Link Layer<a class=headerlink href=#data-link-layer title="Permanent link">&para;</a></h4> <p>The <strong>Data Link Layer</strong> accepts data from the hardware in Layer 1 and <strong>prepends</strong> an <strong>address</strong> to all the inbound packets it accepts.</p> <p>The address number is 6 bytes, 3 bytes for the manufacturer and 3 random bytes assigned to the adapter. This 6 byte address is known as the <strong>MAC (Media Access Control) Address</strong>.</p> <p>The Data Link layer deals with transferring data between <strong>network nodes</strong> using the MAC address. This layer is where the <em>IP address</em> and <em>MAC address</em> are associated using the <strong>ARP protocol</strong>.</p> <p>A broadcast is initiated to find the MAC address of the IP address that is required. Quite often a broadcast is initiated requesting MAC addresses as the associations time out and are deleted. The ARP frame usually has the data of <code>Who has 192.168.0.2? Tell 192.168.0.7</code>.</p> <p>Since ARP uses broadcasts, the packets are confined to a single network segment. A network segment may also be called a <strong>broadcast domain</strong> or <strong>collision domain</strong>. A collision domain may be expanded with the use of a <strong>bridge</strong>. Bridges will work but all nodes will hear and examine all traffic on the wire. Adding bridges increases the number of nodes on the wire.</p> <p>Common Data Link protocols or EtherType include:</p> <ul> <li>ARP: ID=x0806, Address Resolution Protocol</li> <li>RARP: ID=x0825, Reverse Address Resolution Protocol</li> <li>IPv4: ID=x0800, Internet Protocol version 4</li> <li>PPPoE: ID=x8863, Point to Point Protocol over Ethernet (discovery)</li> <li>STP: Spanning Tree Protocol, does not have an ID as it uses an Ethernet II frame with a LLC (Logical Link Control) header.</li> </ul> <h4 id=network-layer>Network Layer<a class=headerlink href=#network-layer title="Permanent link">&para;</a></h4> <p>The <strong>Network Layer</strong> deals with routing and forwarding packets, and may also have Quality of Service component.</p> <p>The Data Link layer is confined to a single network segment and is used by Network Layer for local delivery.</p> <p>Some of the common Layer 3 protocols are:</p> <ul> <li>IPv4, Internet Protocol version 4</li> <li>IPv6, Internet Protocol version 6</li> <li>OSPF, Open Shortest Path First</li> <li>IGRP, Interior Gateway Routing Protocol</li> <li>ICMP, Internet Control Message Protocol</li> </ul> <p>The layer 3 is tasked with packet delivery to the next hop. Each packet is sent/forwarded on its own merits and run in a connectionless environment. In many cases the final destination is not adjacent to this machine so the packets are routed based on the local routing table information.</p> <h5 id=internet-protocol>Internet Protocol<a class=headerlink href=#internet-protocol title="Permanent link">&para;</a></h5> <p>The <strong>addressing</strong> function examines the address on the incoming packet:</p> <ul> <li>If the address indicates the datagram is for the local system then the headers are removed and the datagram is passed up to the next layer in the protocol stack.</li> <li>If the address indicates the datagram is for another machine then it is passed to the next system in the direction of the final destination.</li> </ul> <p>The <strong>fragmentation</strong> component will split and re-assemble the packets if the path to the next system uses a smaller transmission unit size.</p> <h5 id=ip-address>IP Address<a class=headerlink href=#ip-address title="Permanent link">&para;</a></h5> <p>IP addresses have two parts:</p> <ul> <li>Network Part - indicated by the value of the netmask</li> <li>Host Part - the remaining bits after the host network component is removed</li> </ul> <p>They are distinguished by using a <strong>netmask</strong>, a bitmask defining which part of an IP address is the network part.</p> <p>IP networks can be broken into smaller pieces by using a <strong>subnet</strong>.</p> <p>As an example:</p> <table> <thead> <tr> <th>parts</th> <th>address</th> <th></th> <th></th> <th></th> </tr> </thead> <tbody> <tr> <td>IP Addr Dec</td> <td>10</td> <td>20</td> <td>0</td> <td>100</td> </tr> <tr> <td>Netmask Dec</td> <td>255</td> <td>255</td> <td>0</td> <td>0</td> </tr> <tr> <td>IP Addr Bin</td> <td>00001010</td> <td>00010100</td> <td>00000000</td> <td>01100100</td> </tr> <tr> <td>Netmask Bin</td> <td>11111111</td> <td>11111111</td> <td>00000000</td> <td>00000000</td> </tr> <tr> <td>Subnet Bin</td> <td></td> <td></td> <td>11111111</td> <td></td> </tr> <tr> <td>Network Part Bin</td> <td>00001010</td> <td>00010100</td> <td></td> <td></td> </tr> <tr> <td>Subnet Part Bin</td> <td></td> <td></td> <td>00000000</td> <td></td> </tr> <tr> <td>Host Part Bin</td> <td></td> <td></td> <td>00000000</td> <td>01100100</td> </tr> </tbody> </table> <p>Originally, the IPv4 addresses were broken into the following three classes:</p> <ul> <li>Class A: 0.0.0.0/255.0.0.0</li> <li>Class B: 128.0.0.0/255.255.0.0</li> <li>Class C: 192.0.0.0/255.255.255.0</li> </ul> <p>Original classes of networks and subnets did not scale well. Networks which did not fit in a class B were often given a class A. This led to IP addresses going to waste and the creation of <strong>CIDR</strong> (Classless Inter-Domain Routing) which uses a <strong>numbered bitmask</strong> instead of the <strong>class bitmask</strong>.</p> <p>Example CIDR Network Netmask:</p> <table> <thead> <tr> <th>parts</th> <th>address</th> <th></th> <th></th> <th></th> </tr> </thead> <tbody> <tr> <td>CIDR /18 Dec</td> <td>255</td> <td>255</td> <td>192</td> <td>0</td> </tr> <tr> <td>CIDR /18 Bin</td> <td>11111111</td> <td>11111111</td> <td>11000000</td> <td>00000000</td> </tr> </tbody> </table> <h5 id=ip-routing>IP Routing<a class=headerlink href=#ip-routing title="Permanent link">&para;</a></h5> <p>Routing begins when the adapter collects a Frame of data and passes it up the stack.</p> <ol> <li>In the first stage the Data Link (MAC) is examined to see if it matches the local machine’s hardware address.</li> <li>When a match is made, the packet is examined for a match of the Destination IP Address.</li> <li>If a match of IP addresses is made, then the packet’s destination is the local machine. The packet is then passed up to Layer 4 (Transport), for additional processing.</li> <li>If there is no IP address match then the datagram is forwarded to the next hop based on the local routing tables.</li> <li>The MAC address is updated to the next hop machine and the packet is passed along. Notice that the MAC address is modified to the next hop and the IP address is the final destination and is not usually modified.</li> </ol> <p>Network routers inspect packet headers, and make routing decisions based on the destination address. There are multiple routes the packets can take to reach the final destination and the routers involved make routing decisions based on path data for most direct path or fastest path.</p> <h5 id=ipv4-and-ipv6>IPv4 and IPv6<a class=headerlink href=#ipv4-and-ipv6 title="Permanent link">&para;</a></h5> <p>IPv4 was the first major Internet Protocol version and most used protocol. Its 32bit address allows 4,294,967,296 possible addresses, which has exhausted on Jan. 31, 2011.</p> <p>Some solutions for mitigating the problem are:</p> <ul> <li>The move from Classed networks to Classless Inter-Domain Routing (CIDR)</li> <li>The invention of Network Address Translation (NAT)</li> <li>The move to IPv6</li> </ul> <p><a href=https://ietf.org/rfc/rfc2460.txt>IPv6</a> is the successor to IPv4; it has 128bit address allows for 3.4 x 10^38 possible addresses. It was designed to deal with IPv4 exhaustion and other shortcomings:</p> <ul> <li>Expanded addresses capabilities</li> <li>Header format simplification</li> <li>Improved support for extensions and options</li> <li>Flow labeling capabilities</li> </ul> <h5 id=ip-management-tools>IP Management Tools<a class=headerlink href=#ip-management-tools title="Permanent link">&para;</a></h5> <p><code>ip</code> is part of the iproute2 package, the default tool for many distributions that manages layer 2 and 3 settings.</p> <p><strong>NetworkManager</strong> is a daemon with D-bus for communication to applications and a robust API available to inspect network settings and operations. It has command line interface (<code>nmcli</code>), curses-based interface (<code>nmtui</code>) and graphical interface (<code>nm-connection-editor</code>)</p> <p><code>ifconfig</code> is part of the net-tools package, not recommened as some new constructs created by <code>ip</code> are not visible to <code>ifconfig</code>.</p> <h5 id=network-types>Network Types<a class=headerlink href=#network-types title="Permanent link">&para;</a></h5> <p><strong>Local Area Network</strong> (LAN) form a network on its own</p> <ul> <li>Smaller, locally connected network.</li> <li>Connected at layer 2 by the same series of switches or hubs.</li> <li>Node to node communication happens at layer 3 using the same network.</li> <li>Layer 2 to layer 3 association may use layer 2 broadcasts and the ARP and RARP protocols to associate MAC addresses with IP addresses.</li> </ul> <p><strong>Virtual Local Area Network</strong> (VLAN) is a method for combining two or more separated LANs to appear as the same LAN, or securing several LANs from each other on the same set of switches.</p> <p>VLANs are defined to the switch, and must configure the trunk port for switch-to-switch communication.</p> <p>A <strong>network bridge</strong> or repeater accepts packets on one side of the bridge and passes them through to the other side of the bridge, and it is bi-directional. It can be a hardware bridge or software bridge.</p> <ul> <li>It is a combination of two or more networks at layer 2.</li> <li>Bridged networks communicate as a <strong>single network</strong>.</li> <li>It is generally used to increase the length of the network connections or increase the number of connections by <strong>joining</strong> two LANs.</li> </ul> <p>Software bridges are present in Kernel and mostly noticeable when implementing VMs, containers or network namespaces. Several methods for configuring software bridges: <code>iproute2, systemd-networkd, nmcli, and VM software</code></p> <p><strong>Wide Area Networks</strong> (WAN) are the components that make the internet work. Typically a WAN is comprised of many individual LAN’s connected together.</p> <p><img src=https://d36ai2hkxl16us.cloudfront.net/course-uploads/e0df7fbf-a057-42af-8a1f-590912be5460/ikyygzinaabv-WAN-v2.png></p> <p>The layer 2 (MAC address) contains the address of the "gateway" node. Once the "gateway" node receives the packet it determines if the packet is local or needs to be "forwarded" to the next "gateway".</p> <h4 id=transport-layer>Transport Layer<a class=headerlink href=#transport-layer title="Permanent link">&para;</a></h4> <p>The <strong>Transport Layer</strong> is responsible for the end-to-end communication protocols. Data is properly multiplexed by defining source and destination port numbers.</p> <p>This layer deals with reliability by adding check sums, doing request repeats, and avoiding congestion.</p> <p>Common protocols in the Transport Layer include:</p> <ul> <li>Transmission Control Protocol (TCP), the main component of the TCP/IP (Internet Protocol Suite) stack.</li> <li>User Datagram Protocol (UDP), another popular component of the Internet Protocol Suite stack.</li> <li>Stream Control Transmission Protocol (SCTP)</li> </ul> <p>Transport Layer uses port numbers to allow for connection multiplexing. The port numbers are usually used in pairs, servers have fixed ports that they listen on and clients use a random port number for port number.</p> <p>The ports are classed in three different ways:</p> <ul> <li>Well-Known Ports 0-1023 - assigned by the Internet Assigned Numbers Authority (IANA), and usually require super-user privilege to be bound. Some of the well-known ports are: <code>22 TCP: SSH; 25 TCP: SMTP; 80 TCP: HTTP; 443 TCP: HTTPS</code>.</li> <li>Registered Ports 1024-49151 - also assigned by the IANA. They can be bound on most systems by non-super-user privilege.</li> <li>Dynamic or Ephemeral Ports 49152-65535 - used as source ports for the client-side of a TCP or UDP connection. Can also be used for a temporary or non-root service.</li> </ul> <h5 id=tcp-udp-sctp>TCP, UDP, SCTP<a class=headerlink href=#tcp-udp-sctp title="Permanent link">&para;</a></h5> <p>TCP is useful when data integrity, ordered delivery and reliability are important.</p> <p>UDP is useful when transmission speed is important and the integrity of the data isn’t as important, or is managed by a higher layer.</p> <p>SCTP is an evolving protocol designed for efficient robust communication. Some of the features are still being sorted such as using SCTP through a NAT firewall.</p> <table> <thead> <tr> <th>Characteristics</th> <th>TCP</th> <th>UDP</th> <th>SCTP</th> </tr> </thead> <tbody> <tr> <td>Connection-oriented</td> <td>Yes</td> <td>No</td> <td>Yes</td> </tr> <tr> <td>Reliable</td> <td>Yes</td> <td>No</td> <td>Yes</td> </tr> <tr> <td>Ordered delivery</td> <td>Yes</td> <td>No</td> <td>Yes</td> </tr> <tr> <td>Checksums</td> <td>Yes</td> <td>Optional</td> <td>Yes</td> </tr> <tr> <td>Flow control</td> <td>Yes</td> <td>No</td> <td>Yes</td> </tr> <tr> <td>Congestion avoidance</td> <td>Yes</td> <td>No</td> <td>Yes</td> </tr> <tr> <td>NAT friendly</td> <td>Yes</td> <td>Yes</td> <td>Not yet</td> </tr> <tr> <td>ECC</td> <td>Yes</td> <td>Yes</td> <td>No</td> </tr> <tr> <td>Header size</td> <td>20-60 bytes</td> <td>8 bytes</td> <td>12 bytes</td> </tr> </tbody> </table> <h4 id=session-layer>Session Layer<a class=headerlink href=#session-layer title="Permanent link">&para;</a></h4> <p><strong>Session Layer</strong> is used for establishing, managing, synchronizing and termination of application connections between local and remote application.</p> <p>If an established connection is lost or disrupted, this layer may try to recover the connection. If a connection is not used for a long time, the session layer may close and reopen it.</p> <p>There are two types of sessions: connection-mode service and connectionless-mode sessions. </p> <p>Session options:</p> <ul> <li>Simplex or duplex communication</li> <li>Transport Layer reliability</li> <li>Checkpoints of data units</li> </ul> <p>Session services may be involved in:</p> <ul> <li>Authentication for Transport Layer</li> <li>Setup and encryption initialization</li> <li>Support for steaming media</li> <li>Support for smtp,http and https protocols</li> <li>SOCKS proxy, Secure Sockets, TLS</li> </ul> <p>The Session Layer creates a semi-permanent connection which is then used for communications, many of the RPC-type protocols depend on this layer:</p> <ul> <li>NetBIOS: Network Basic Input Output System</li> <li>RPC: Remote Procedure Call</li> <li>PPTP: Point to Point Tunneling Protocol</li> </ul> <h4 id=presentation-layer>Presentation Layer<a class=headerlink href=#presentation-layer title="Permanent link">&para;</a></h4> <p>The Presentation Layer is commonly rolled up into a different layer, Layer 5 and/or Layer 7. </p> <p>Some of the protocols that function at this level include:</p> <ul> <li>AFP, Apple filing protocol</li> <li>NCP, Netware Core protocol</li> <li>x25 PAD, x25 Packet Assembler/Disassembler</li> </ul> <p>Some of the services that may be available at the Presentation level are:</p> <ul> <li>Data Conversion (EBCDIC to ASCII)</li> <li>Compression</li> <li>Encryption/Decryption</li> <li>Serialization</li> </ul> <h4 id=application-layer>Application Layer<a class=headerlink href=#application-layer title="Permanent link">&para;</a></h4> <p>The Application Layer is the top of the stack and deals with the protocols which make a global communications network function.</p> <p>Common protocols which exist in the Application Layer are:</p> <ul> <li>HTTP: Hypertext Transfer Protocol</li> <li>SMTP: Simple Mail Transfer Protocol</li> <li>DNS: Domain Name System</li> <li>FTP: File Transfer Protocol</li> <li>DHCP: Dynamic Host Configuration Protocol</li> </ul> <h3 id=manage-system-services-with-systemd>Manage System Services with systemd<a class=headerlink href=#manage-system-services-with-systemd title="Permanent link">&para;</a></h3> <p>Common actions performed from <code>systemctl</code> utility:</p> <div class=highlight><pre><span></span><code><span class=c1># Start the service</span>
systemctl start httpd.service
<span class=c1># Stop the service</span>
systemctl stop httpd.service
<span class=c1># Enable the service to auto start on system boot</span>
systemctl <span class=nb>enable</span> httpd.service
<span class=c1># Disable or prohibit a service from auto starting</span>
systemctl disable httpd.service
<span class=c1># Obtain the status of a service</span>
systemctl status httpd.service
<span class=c1># reload systemd confs after making changes</span>
systemctl daemon-reload
<span class=c1># restart a service after the reload (.service can be omitted)</span>
systemctl restart httpd
<span class=c1># Run the service in foreground for debugging</span>
/usr/sbin/httpd -f /etc/httpd/httpd.conf

<span class=c1># List the services (units) currently loaded</span>
systemctl
<span class=c1># List the sockets in use by systemd launched services</span>
systemctl list-sockets
<span class=c1># List the timers currently active</span>
systemctl list-timers
<span class=c1># Set specific unit runtime values if supported; this will set properties used for resource control if enabled</span>
systemctl  set-property foobar.service <span class=nv>CPUWeight</span><span class=o>=</span><span class=m>200</span> <span class=nv>MemoryMax</span><span class=o>=</span>2G <span class=nv>IPAccounting</span><span class=o>=</span>yes
<span class=c1># Display the status, state, configuration file(s) and last few log messages for this service</span>
systemctl status httpd.service
<span class=c1># Find overridden configuration files and display the differences</span>
systemd-delta
</code></pre></div> <p>Some transient system services are not used enough to keep a daemon running full time. The <code>xinet</code> daemon was created to manage these transient daemons. Its default configuration file is <code>/etc/xinetd.conf</code>, with additional per-service files in <code>/etc/xinetd.d/</code>.</p> <p>The sequence that systemd processes the configuration files is predictable and extensible. The common scan sequence is:</p> <ul> <li>The vendor or package supplied unit files in one of the following directories: <code>/usr/lib/systemd/system/&lt;service&gt;.service</code> or <code>/lib/systemd/system/&lt;service&gt;.service</code></li> <li>Optional or dynamically created unit files in <code>/run/systemd/system/</code> directory</li> <li>Optional user unit override files in <code>/etc/systemd/system/</code> directory</li> <li>Optional user drop-in files in <code>/etc/systemd/system/&lt;service&gt;.d</code> (most popular drop-in directory)<ul> <li><code>&lt;service&gt;.d</code> might need to be manually created</li> <li>It is common practice to copy the vendor unit file into the <code>/etc/systemd/system/</code> directory and make appropriate customizations.</li> </ul> </li> </ul> <p>Often times it is desirable to add or change features by program or script control, the drop-in files are convenient for this. One item of caution, if one is changing a previously defined function (like ExecStart) it must be undefined first then added back in.</p> <p>With <code>systemd</code>, additional features and capabilities can be easily added. As an example, <strong>cgroups</strong> controls can be added to our service by adding a <code>Slice</code> directive in the <code>Service</code> block.</p> <h2 id=network-configuration>Network Configuration<a class=headerlink href=#network-configuration title="Permanent link">&para;</a></h2> <h3 id=layer-2-configuration>Layer 2 Configuration<a class=headerlink href=#layer-2-configuration title="Permanent link">&para;</a></h3> <p>There are two methods for examining/changing additional parameters for Layer 2:</p> <ul> <li>Kernel module tools modinfo and modprobe using <code>/etc/modprobe.d/</code>, with suffix in <code>.conf</code> or <code>.local</code></li> <li>udev using the drop-in directory <code>/etc/udev/rules.d/</code></li> </ul> <p>The <strong>udev</strong> (user device facility) is used to manage network hardware interfaces for the Linux kernel. Sometimes changes are needed to rename interfaces or change configurations to match hardware MAC addresses. When rules are processed, all the files in the rules directories are combined and sorted in a lexical order.</p> <p>The udevadm command is used for control, query and debugging udev configuration files. You can see an example rule to rename a network interface:</p> <div class=highlight><pre><span></span><code>cat /etc/udev/rules.d/70-persistent-net.rules
<span class=nv>SUBSYSTEM</span><span class=o>==</span><span class=s2>&quot;net&quot;</span> ,ACTION<span class=o>==</span><span class=s2>&quot;add&quot;</span> ,ATTR<span class=o>{</span>address<span class=o>}==</span><span class=s2>&quot;52:54:42:42:00:01&quot;</span> ,NAME<span class=o>=</span><span class=s2>&quot;net%n&quot;</span>
</code></pre></div> <p>The operations required are:</p> <ul> <li>List optional parameters</li> <li>Set optional parameters</li> <li>Verify additional parameters</li> <li>Block or allow hardware modules from loading</li> </ul> <p>Sometimes it becomes necessary to inhibit the loading of a hardware module. The syntax is <code>blacklist MODULENAME</code></p> <p>Example of changing layer 2 configuration:</p> <div class=highlight><pre><span></span><code><span class=c1># change the maximum transmission unit (MTU):</span>
ip link <span class=nb>set</span> mtu <span class=m>1492</span> dev eth0
<span class=c1># change the link speed:</span>
ethtool -s eth0 speed <span class=m>1000</span> duplex full
<span class=c1># check the link status</span>
ip -s link
ip -s link show dev eth0
<span class=c1># check the network interface driver</span>
ethtool -i eth0
<span class=c1># check driver module info to understand optional parameters to the module</span>
modinfo e1000
udevadm info -a /sys/class/net/ens9
<span class=c1># add parameters in /etc/modprobe.d/mynic.conf:</span>
options e1000 <span class=nv>Speed</span><span class=o>=</span><span class=m>100</span> <span class=nv>Duplex</span><span class=o>=</span><span class=m>0</span> <span class=nv>AutoNeg</span><span class=o>=</span><span class=m>0</span>
</code></pre></div> <h3 id=layer-3-configuration>Layer 3 Configuration<a class=headerlink href=#layer-3-configuration title="Permanent link">&para;</a></h3> <p>Examples of changing layer 3 configuration</p> <div class=highlight><pre><span></span><code><span class=c1># manually set a network (Layer 3) address:</span>
ip addr add <span class=m>10</span>.0.2.25/255.255.255.0 dev eth0
<span class=c1># manually set or change the default route:</span>
ip route add default via <span class=m>10</span>.0.2.2
route add default gw <span class=m>10</span>.0.2.2
<span class=c1># add the address of a DNS server, use:</span>
<span class=nb>echo</span> <span class=s2>&quot;nameserver 4.2.2.1&quot;</span> &gt;&gt; /etc/resolv.conf
<span class=c1># manually request a DHCP configuration, use the dhclient command:</span>
dhclient eth0
</code></pre></div> <h3 id=boot-time-configuration>Boot Time Configuration<a class=headerlink href=#boot-time-configuration title="Permanent link">&para;</a></h3> <p>Network settings are stored in configuration files which allow for persistent configuration across reboots. <strong>Network-Manager</strong> is an example of a common configuration tool with several interfaces (<code>nmcli</code>).</p> <p>The <code>systemd-network</code> service relies on text file configuration and has no text or GUI menu application (<code>networkctl</code>).</p> <p><code>netplan</code> is a a Ubuntu-specific tool that creates a network configuration at runtime from a pre-defined yaml file. It can dynamically create either a Network Manager or a systemd-networkd based configuration.</p> <h4 id=network-manager>Network Manager<a class=headerlink href=#network-manager title="Permanent link">&para;</a></h4> <p>Network Manager is used by Ubuntu, CenOS, SUSE, and Debian, which provides:</p> <ul> <li>GUI tool (<code>nm-connection-editor</code>)</li> <li>applet (<code>nm-applet</code>)</li> <li>text interface (<code>nmtui</code>)</li> <li>CLI interface (<code>nmcli</code>)</li> </ul> <p>The current release of Network Manager will automatically configure and start a network interface with a Dynamic Host Configuration Protocol (DHCP) if there is no network configuration file for the adapter.</p> <p>If there is a configuration file, Network Manager will set the device to an "unmanaged" state and initialize the adapter with the attributes of the configuration file.</p> <p>Network Manager can manage</p> <ul> <li>Hardware: <code>Bluetooth, DSL/PPPoE, Ethernet, InfiniBand, Mobile Broadband, Wi-Fi</code></li> <li>Virtual: <code>Bond, Bridge, IP Tunnel, MACsec, Team, Vlan, Wireguard</code></li> </ul> <p>The network configuration files on an Ubuntu system typically reside in the <code>/etc/network</code> directory, with the interface configuration file being <code>/etc/network/interfaces</code>. The hostname config file is <code>/etc/hostname</code>.</p> <p>The network configuration files on a CentOS system are located in the <code>/etc/sysconfig/network-scripts</code> directory and match the <code>ifcfg-&lt;interface&gt;</code> pattern. The DNS client settings are managed by editing the <code>/etc/resolv.conf</code> file.</p> <p>Beware that some of the network adapters may be excluded from Network Manager and will have to be re-added to allow Network Manager to control the interfaces.</p> <h3 id=vpn>VPN<a class=headerlink href=#vpn title="Permanent link">&para;</a></h3> <p><strong>Virtual Private Networks</strong> (VPNs) provide a secure connection for remote users through unsecured networks. Data is encrypted to avoid unwanted exposure. Initialization of the connection usually has multi-factor authentication for additional security. There are VPN types provided by many different protocols:</p> <ul> <li>Secure Transport Layer (SSL/TLS)</li> <li>Internet Protocol Security (IPSEC)</li> <li>Datagram Transport Layer (DTLS)</li> <li>Secure Shell (SSH) VPN.</li> </ul> <p>One of the more popular VPN tools is <a href=https://openvpn.net/community/ >OpenVPN</a>, which provides SSL/TLS-based VPN connectivity. OpenVPN is a single binary for both the server and the client, and is a command-line tool.</p> <h2 id=network-troubleshoot-and-monitor>Network Troubleshoot and Monitor<a class=headerlink href=#network-troubleshoot-and-monitor title="Permanent link">&para;</a></h2> <h3 id=client-side-troubleshoot>Client side Troubleshoot<a class=headerlink href=#client-side-troubleshoot title="Permanent link">&para;</a></h3> <p>Some common networking issues found at the client side include DNS issues, Firewall settings, or incorrect network settings (routes, netmasks).</p> <p>The basics of network troubleshooting usually deal with connectivity testing. You can use the tools <code>ping, traceroute, and nmap</code></p> <p>Use <code>ping</code> for checking connectivity. <code>ping</code> uses the ICMP protocol. Test the IP address to your network adapter, gateway, and DNS. Use the DNS name for domain name resolution.</p> <p>Use <code>traceroute</code> or <code>mtr</code> which shows the connectivity path to the destination. <code>mtr</code> show statistics of the connection and packets drops/failures.</p> <p>Use <code>nmap</code> which scans the server to see if the required ports are available.</p> <p>Use <code>telnet</code> to test plain-text protocols, such as http. i.e. <code>telnet example.com 80</code>.</p> <p>Use <code>openssl</code> to test SSL or TLS protocols. i.e. <code>openssl s_client -connect www.google.com:443</code></p> <p>Use <code>arp</code> to check link-layer connectivity.</p> <p>Advanced troubleshooting involves using <code>tcpdump</code> and <code>wireshark</code>. The command line-based <code>tcpdump</code> truncates packets by default and generates <code>pcap</code> files. </p> <p><code>wireshark</code> uses the graphical interface to capture packets. It can capture and analyze packets in real time. It is useful to analyze <code>pcap</code> files, but you may not want wireshark installed on the system you are troubleshooting.</p> <p>To capture packets with tcpdump for use with wireshark, do <code>sudo tcpdump -i eth0 -s 65535 -w capture.pcap port 22</code></p> <h3 id=server-side-troubleshoot>Server side Troubleshoot<a class=headerlink href=#server-side-troubleshoot title="Permanent link">&para;</a></h3> <p>Common server problems include broken DNS, overzealous firewall rules, incorrect network settings, and the daemon not listening on the right interface/port. Some protocols break when return traffic comes back from a different IP address. Verify that your egress route is correct. Some access control systems require that Reverse DNS be properly set up.</p> <p>Perform basic server troubleshooting: test the network connectivity from the server's point of view. One of the first steps in troubleshooting a server-side daemon should be to check the log files, and verify the daemon/service is running.</p> <p>Use <code>netstat</code> to list the ports that daemons listen on, i.e. <code>sudo netstat -taupe | grep httpd</code></p> <p>The <code>ss</code> command is another socket statistics utility. It may be a replacement to <code>netstat</code> although it is missing some socket types. Usage: <code>sudo ss -ltp | grep httpd</code>.</p> <p>Server side firewall configuration needs to take into account that it allows certain inbound and outbound traffic. Also check the settings of tools such as TCP wrappers (<code>/etc/hosts.allow</code> and <code>/etc/hosts.deny</code>). Consult <code>man 5 hosts_access</code> for additional details.</p> <p>For advanced server troubleshooting, the /proc filesystem has settings that affect the network stack:</p> <ul> <li><code>/proc/sys/net/ipv4/ip_forward</code> - Allows for network traffic to be forwarded from one interface to another.</li> <li><code>/proc/sys/net/ipv4/conf/*/accept_redirects</code> - Accepting Internet Control Message Protocol (ICMP) redirects from a router to find better routes. This setting has the potential to be exploited by a malicious party to redirect your traffic.</li> <li><code>/proc/sys/net/ipv4/icmp_echo_ignore_all</code> - Changing this setting will affect the host's visibility to ICMP ping packets.</li> <li><code>/proc/sys/net/ipv4/icmp_echo_ignore_broadcasts</code> - This setting will change the host's visibility to broadcast ICMP ping packets.</li> <li><code>/proc/net/arp</code> - Contains the current arp table.</li> </ul> <p>These settings are not persistent across reboots. To persistently enable changes you must use the sysctl command with its configuration file <code>/etc/sysctl.conf</code>. The syntax for <code>/etc/sysctl.conf</code> matches the path for the file in <code>/proc/sys</code> with the <code>.</code> character instead of <code>/</code>.</p> <p><code>netcat</code> is a TCP and UDP sender and listener. To test a network connection, use <code>netcat</code> to open a listening port on one system with <code>netcat -l 4242</code>, cause it to listen on all adapters port 4242 for traffic. On another machine, use <code>netcat &lt;listener_ip_address&gt; 4242</code> to open a connection to the listener, then send input which should appear on the listener side, the communication is bi-directional.</p> <p><code>netcat</code> can save many hours of frustration by proving TCP and UDP traffic can transverse the network.</p> <h3 id=network-monitoring>Network Monitoring<a class=headerlink href=#network-monitoring title="Permanent link">&para;</a></h3> <p>The <code>iptraf</code> tool is a real-time network traffic analyzer. It recognizes protocols: <code>IP, TCP, UDP, ICMP, IGMP, IGP, IGRP, OSPF, ARP, RARP</code>.</p> <p><code>snort</code> is a network intrusion detection system. In addition to being a network monitor, it can help pinpoint unwanted traffic inside of a network.</p> <p><code>ntop</code> is an application and web app for monitoring network usage. It can pinpoint bandwidth use, display network statistics, and more.</p> <p><code>tcpdump</code> has been around for a long time, it is text-based, small and efficient.</p> <p><code>wireshark</code>, graphical tracer with protocol decode that allows the user to view more or less data depending on the requirement. It can read <code>tcpdump</code> output files, which allows the collection of trace data with the efficient <code>tcpdump</code> on prod system and then use <code>wireshark</code> to display the information for analysis.</p> <h2 id=remote-access>Remote Access<a class=headerlink href=#remote-access title="Permanent link">&para;</a></h2> <h3 id=cryptography>Cryptography<a class=headerlink href=#cryptography title="Permanent link">&para;</a></h3> <p>Cryptography is about securing communications.</p> <p><strong>Symmetric encryption</strong> uses a single secret <strong>shared key</strong>, which both parties must have to communicate. Plain text encrypted with a symmetric encryption method can easily be turned back into plain text using the same key. Example <a href=https://en.wikipedia.org/wiki/Caesar_cipher target=_blank>Caesar cipher</a></p> <p>One benefit of symmetric encryption is that it is less computationally-intensive than asymmetric encryption. One downside of symmetric encryption is that a secure shared key exchange is difficult to attain.</p> <p><strong>Asymmetric encryption</strong> uses mathematically-related public and private keys to communicate. Plain text encrypted with an asymmetric <strong>public key</strong> can only be decrypted by using the <strong>corresponding private key</strong>, not the public key.</p> <p>Asymmetric encryption has no key-exchange problem and uses the published public key to send secure messages. However, it is more computationally-intensive than symmetric encryption, and needs proper verification on the shared public key.</p> <p>By using the asymmetric encryption to pass the symmetric key, you can overcome the problems associated with both.</p> <ol> <li>Party One creates a session key using a symmetric algorithm.</li> <li>Party One then encrypts the session key, using the public key of Party Two, and sends the encrypted session key to Party Two.</li> <li>Party Two uses their private key to decrypt the session key.</li> <li>Both parties now communicate using the symmetric session key for encryption.</li> </ol> <h3 id=secure-shell>Secure Shell<a class=headerlink href=#secure-shell title="Permanent link">&para;</a></h3> <p><code>telnet</code> is one of the earlier protocols developed for the Internet back in 1969 and was not built with security in mind, the protocol is sent over the wire in plain text.</p> <p>Remote Shell <code>rsh</code> was originally written for the BSD (Berkeley Software Distribution) system in 1983. <code>rsh</code> is a similar system to <code>telnet</code> and is an insecure protocol, which is not encrypted and sends data in clear text.</p> <p>The Secure Shell (<code>ssh</code>) protocol was developed to overcome the security concerns of <code>telnet</code> and <code>rsh</code>.</p> <p>OpenSSH is the most widely used version of SSH and is built upon the concepts of symmetric and asymmetric encryption.</p> <p>OpenSSH Architecture Layers:</p> <ul> <li>transport layer - deals with the initial key-exchange and setting up a symmetric-key session and establish the connection layer.</li> <li>user auth layer - deals with authenticating and authorizing the user accounts.</li> <li>connection layer - deals with the communication once the session is set up.</li> </ul> <p>The OpenSSH host-wide client configuration is <code>/etc/ssh/ssh_config</code>. The per-user client configuration is each user's <code>$HOME/.ssh/config</code>. SSH uses a key-based authentication. Syntax can be found with <code>man 5 ssh_config</code></p> <p>Other protocols can be tunneled over SSH. The X11 protocol support is part of the OpenSSH client. You can also manually open a connection for any other protocol using the LocalForward and RemoteForward tokens in the OpenSSH client configuration.</p> <h4 id=client-ssh-config>Client SSH config<a class=headerlink href=#client-ssh-config title="Permanent link">&para;</a></h4> <p><code>$HOME/.ssh/config</code> can be set up with shortcuts to servers you frequently access.</p> <p>As an example, you can do <code>ssh web</code> rather than typing <code>ssh webusr@www.example.com</code>:</p> <div class=highlight><pre><span></span><code>Host web
  HostName www.example.com
  User webusr
</code></pre></div> <p>More advanced configuration:</p> <div class=highlight><pre><span></span><code>Host web
  KeepAlive yes
  IdentityFile ~/.ssh/web_id_rsa
  HostName www.example.com
  Port 2222
  User webusr
  ForwardX11 no
Host  *
  Port 22
</code></pre></div> <p>OpenSSH client key-based authentication provides a <strong>passwordless</strong> authentication for users. Private keys can be encrypted and password protected. <code>ssh-agent</code> program can cache decrypted private keys. <code>ssh-copy-id</code> program can copy your public key to a remote host.</p> <div class=highlight><pre><span></span><code><span class=c1># To generate a user key for SSH authentication, use:</span>
$ ssh-keygen -f <span class=nv>$HOME</span>/.ssh/id_rsa -N <span class=s1>&#39;supersecret&#39;</span> -t rsa
<span class=c1># To start ssh-agent and use it to cache your private key, use:</span>
$ <span class=nb>eval</span> <span class=k>$(</span>ssh-agent<span class=k>)</span>
$ ssh-add <span class=nv>$HOME</span>/.ssh/id_rsa
<span class=c1># To copy your public key to the remote system overthere for remote user joe, use:</span>
$ ssh-copy-id joe@overthere
</code></pre></div> <h4 id=openssh-tunnel>OpenSSH Tunnel<a class=headerlink href=#openssh-tunnel title="Permanent link">&para;</a></h4> <p><img src=https://d36ai2hkxl16us.cloudfront.net/course-uploads/e0df7fbf-a057-42af-8a1f-590912be5460/vsm3q4vd0omm-wur4d50lt2am-OpenSSHTunnel.png></p> <p>The local tunnel (<code>ssh -L</code>) indicates which port is to be opened on the local host (4242) and the final destination to be (charlie:2200), and the connection to the final destination is made by machine (bob).</p> <p>The remote tunnel (<code>ssh -R</code>) requests machine (bob) to open a listening port (2424) to which any connection will be transferred to the destination, (charlie:2200).</p> <p>There is also dynamic port forwarding using <code>ssh -B</code>. Option <code>-N</code> sets the option to not execute a command on connection to the remote system, and option <code>-f</code> informs ssh to go into background just before command execution.</p> <h4 id=parallel-ssh-commands>Parallel SSH Commands<a class=headerlink href=#parallel-ssh-commands title="Permanent link">&para;</a></h4> <p>The <code>pssh</code> package is available for execute the same command on many systems, which includes:</p> <ul> <li>pssh: parallel ssh</li> <li>pnuke: parallel process kill</li> <li>prsync: parallel copy program using rsync</li> <li>pscp: parallel copy using scp</li> <li>pslurp: parallel copy from hosts</li> </ul> <p>The pssh command and friends use the existing ssh configuration. It is best to configure aliases, keys, known hosts and authorized keys prior to attempting to use pssh. If there is a password or fingerprint prompt, the pssh command will FAIL.</p> <p>When using pssh, it is convenient to create a file with a list of the hosts you wish to access. The list can contain IP addresses or hostnames.</p> <div class=highlight><pre><span></span><code>$ cat ~/ips.txt
<span class=m>127</span>.0.0.1
<span class=m>192</span>.168.42.1
$ pssh -i -h ~/ips.txt date
<span class=o>[</span><span class=m>1</span><span class=o>]</span> <span class=m>10</span>:07:35 <span class=o>[</span>SUCCESS<span class=o>]</span> <span class=m>120</span>.0.0.1
Thu Sep <span class=m>28</span> <span class=m>10</span>:07:35 CDT <span class=m>2017</span>
<span class=o>[</span><span class=m>2</span><span class=o>]</span> <span class=m>10</span>:07:35 <span class=o>[</span>SUCCESS<span class=o>]</span> <span class=m>192</span>.168.42.1
Thu Sep <span class=m>28</span> <span class=m>10</span>:07:35 CDT <span class=m>2017</span>
</code></pre></div> <h3 id=vnc-server>VNC Server<a class=headerlink href=#vnc-server title="Permanent link">&para;</a></h3> <p>The Virtual Network Computing (VNC) server allows for cross-platform, graphical remote access. The most common implementation is <code>tigervnc</code> client and server.</p> <p>The server component has <code>Xvnc</code> (the main server for VNC and X), <code>vncserver</code> (Perl script to control Xvnc), <code>vncpasswd</code> (set and change vnc-only password), and <code>vncconfig</code> (configure and control a running Xvnc).</p> <p>When the server starts, it uses the xstartup configuration from the users <code>~/.vnc</code> directory. If the xstartup file is altered, the vncserver needs to be restarted.</p> <p>VNC is a display-based protocol, which makes it cross-platform. It also means that it is a relatively heavy protocol, as pixel updates have to be sent over-the-wire.</p> <p>The client, <code>vncviewer</code>, is usually packaged separately. It connects to the VNC server on the specified port or display number. Passwords are not sent in clear text. On its own, VNC is not secure after the authentication step. However, the protocol can be tunneled through SSH or VPN connections.</p> <h4 id=x-window-system>X Window System<a class=headerlink href=#x-window-system title="Permanent link">&para;</a></h4> <p>The X Window system was developed as part of Project Athena at MIT in 1984. This simple network-transparent GUI system provides basic GUI primitives and is network transparent, allowing for ease of use.</p> <p>When it comes to X authentication, the client-server security is done using keys.</p> <p>To secure the X protocol, it must be tunneled with VPN or SSH. OpenSSH supports X11 tunneling via <code>-X</code> option.</p> <h2 id=domain-name-service>Domain Name Service<a class=headerlink href=#domain-name-service title="Permanent link">&para;</a></h2> <p>Before <code>DNS</code>, there was <code>ARPANET</code>. The original solution to a name service was a flat text file called HOSTS.TXT. This file was hosted on a single machine, and, when you wanted to get a copy, you pulled it from this central server using File Transfer Protocol (FTP) or a similar protocol.</p> <p>A descendant of the HOSTS.TXT file is the <code>/etc/hosts</code> file. It has a very simple syntax: <code>&lt;IP ADDRESS&gt; &lt;HOSTNAME&gt; [HOSTNAME or alias] ...</code>. This hosts file usually takes precedence over other resolution methods.</p> <p><strong>The Domain Name System</strong> (DNS) is a distributed, hierarchical database for converting DNS names into IP addresses. The DNS protocol runs in two modes: <code>recursive with caching, authoritative</code></p> <p>When a network node makes a DNS query, it most often makes that query against a recursive, caching server. That recursive, caching server will then make a recursive query through the DNS database, until it comes to an authoritative server. The authoritative server will then send the answer for the query.</p> <p><img src=https://d36ai2hkxl16us.cloudfront.net/course-uploads/e0df7fbf-a057-42af-8a1f-590912be5460/jq1cp4ny4pui-DNS-Tree.png></p> <p>The DNS database consists of a tree-like, key-value store. The database is broken into tree nodes called Domains. These domains are managed as part of a zone. Zones are the area of the namespace managed by authoritative server(s). DNS delegation is done on zone boundaries.</p> <p><img src=https://d36ai2hkxl16us.cloudfront.net/course-uploads/e0df7fbf-a057-42af-8a1f-590912be5460/muu8okika9sp-DNS-Query.png></p> <p>The Caching Server most likely have already cached those frequently accessed top domains so this process would usually be fast.</p> <h3 id=queryrecord-types>Query/Record Types<a class=headerlink href=#queryrecord-types title="Permanent link">&para;</a></h3> <ul> <li>A Record - Address Mapping Records, a 32bit IPv4 address.</li> <li>AAAA Record - IP Version 6 Address Records, a 128big IPv6 address.</li> <li>CNAME - Canonical Name Records, an alias to another name</li> <li>MX - Mail Exchanger Records, the message transfer agents (mail servers) for a domain.</li> <li>NS - Nameserver Records, delegate an authoritative DNS zone nameserver.</li> <li>PTR - Reverse-Lookup Pointer Records, pointer to a canonical name (IP address to name).</li> <li>SOA - Start of Authority Records, Start of Authority for a domain (domain and zone settings).</li> <li>TXT - Text Records, arbitrary human-readable text, or machine-readable data for specific purposes.</li> </ul> <p>More about <a href=https://www.ietf.org/rfc/rfc1034.txt target=_blank>DNS</a></p> <h3 id=dns-queries>DNS Queries<a class=headerlink href=#dns-queries title="Permanent link">&para;</a></h3> <p><strong>Forward DNS queries</strong> use A or AAAA record types and are most often used to turn a <code>DNS</code> name into an IP address.</p> <p>A <strong>Fully Qualified Domain Name</strong> (FQDN) is the full DNS address in the DNS database, and the most significant part is first.</p> <p>A <strong>reverse DNS query</strong> is used to turn an IP address into a DNS name. It uses a <code>PTR</code> record type and an <code>arpa.</code> domain in a DNS database. In an IP address, the most significant part is on the right; we have to translate an IP address to put it into the DNS database. i.e. <code>192.168.13.32</code> becomes <code>32.13.168.192.in-addr.arpa.</code>; <code>2001:500:88:200::10</code> becomes <code>0.1.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.2.0.8.8.0.0.0.0.5.0.1.0.0.2.ip6.arpa.</code></p> <p>See <a href=https://en.wikipedia.org/wiki/Comparison_of_DNS_server_software target=_blank>popular DNS servers</a>.</p> <h4 id=dns-client>DNS Client<a class=headerlink href=#dns-client title="Permanent link">&para;</a></h4> <p>Network configuration is more dynamic and the nameserver entries need to be adjusted dynamically.</p> <p>In most distros, the nameserver information may be added to the interface configuration file, overwriting or modifying the <code>/etc/resolv.conf</code> when the interface is started.</p> <p>The DHCP Server often provides nameserver information as part of the information sent to the DHCP client, replacing the existing nameserver records.</p> <p><code>resolvconf</code> service uses additional files like <code>/etc/resolvconf.conf</code> and a background service resolvconf.service to "optimize" the contents of /etc/resolv.conf.</p> <p><code>dnsmasq</code> sets up in "mini" caching DNS server and may alter the resolver configuration to look at dnsmasq instead of the items listed in /etc/resolv.conf.</p> <p><code>systemd.resolved</code> provides a DNS stub listener on IP address 127.0.0.53 on the loopback adapter and takes input from several files including: <code>/etc/systemd/resolved.conf, /etc/systemd/network/*.network</code> and any DNS information made available by other services like "dnsmasq".</p> <h3 id=bind>BIND<a class=headerlink href=#bind title="Permanent link">&para;</a></h3> <p><code>BIND</code>, Berkeley Internet Name Domain, is a widely-used, ISC standard DNS Internet software available for most UNIX-type systems. Its configuration file is <code>/etc/named.conf</code> or <code>/etc/bind/named.conf</code>, syntax specified in <code>man 5 named.conf</code>. On CenOS or SUSE distro, its package is <code>bind</code> and the service is <code>named</code>; on Ubuntu, its package is <code>bind9</code> and the service is also <code>bind9</code>.</p> <p>Authoritative zones are defined and must contain an SOA (Start of Authority) record. Zone files should contain an NS (nameserver) record.</p> <p>Some of the syntax considerations include:</p> <ul> <li>The record format is: "{name} {ttl} {class} {type} {data}"</li> <li>Always use trailing "." on all fully-qualified domain names</li> <li>@ special character</li> <li>GENERATE syntax</li> <li>Comment marker - ; to end of line.</li> </ul> <p>The SOA (Start of Authority) is required for every zone. Special control fields include:</p> <ul> <li>Admin email</li> <li>Primary name server</li> <li>Serial number</li> <li>Timers (secondary server refresh settings)<ul> <li>Refresh: How often to check for new serial from primary.</li> <li>Retry: How often to retry if no response from primary.</li> <li>Expire: How long to keep returning authoritative answers when we cannot reach the primary server.</li> <li>Negative TTL: How long to cache an NX domain answer.</li> </ul> </li> </ul> <p>A <strong>DNS view</strong> (aka split horizon) will cause the DNS server to respond with different data depending on the match criteria, such as source IP address:</p> <ul> <li>it can provide different DNS answers to requests depending on selection criteria</li> <li>uses multiple zone files with different data for the same zone</li> <li>can provide DNS services inside a corporation using private or non-routable addresses.​​​​​​​​​​​​​​</li> </ul> <h3 id=dns-tools>DNS Tools<a class=headerlink href=#dns-tools title="Permanent link">&para;</a></h3> <p>Tools for DNS testing are in three categories: server configuration testing, server information testing, and server update.</p> <p>DNS client tools formulate a standard DNS request and send it off to the default or named DNS server.</p> <p><code>dig</code> (domain information groper) queries DNS for for domain name or ip address mapping, and output format resembles the records used by the DNS server.</p> <p><code>host</code> is a simple interface for DNS queries, good for use in scripts</p> <p><code>nslookup</code> queries DNS for domain name or IP address mapping and less verbose than <code>dig</code></p> <p><code>nsupdate</code> end updates to a name server and requires authentication and permission</p> <h2 id=http-servers>HTTP Servers<a class=headerlink href=#http-servers title="Permanent link">&para;</a></h2> <p>Apache used to be the lead technology of all active web servers. The location of the Apache configuration files move from distribution to distribution, and so is its systemd.service name and package name.</p> <div class=highlight><pre><span></span><code><span class=c1># On RedHat, CentOS, or Fedora:</span>
Package: httpd
Service: httpd
Primary configuration file: /etc/httpd/conf/httpd.conf

<span class=c1># On OpenSUSE:</span>
Package: apache2
Service: apache2
Primary configuration file: /etc/apache2/httpd.conf

<span class=c1># On Debian, Ubuntu, or Linux Mint:</span>
Package: apache2
Service: apache2
Primary configuration file: /etc/apache2/apache2.conf
</code></pre></div> <p>Apache allows include other files and directories from the primary configuration files, just like a drop-in configuration file. The default include directories are:</p> <div class=highlight><pre><span></span><code><span class=c1># CentOS:</span>
/etc/httpd/conf.d/*.conf

<span class=c1># OpenSUSE:</span>
/etc/apache2/conf.d/
/etc/apache2/*

<span class=c1># Ubuntu:</span>
/etc/apache2/*-enabled
/etc/apache2/*-available/
</code></pre></div> <p>Other important files include the document root (<code>/var/www/html/, /srv/www/htdocs</code>), log file locations (<code>/var/log/httpd, /var/log/apache2</code>), and module locations.</p> <h3 id=logs>Logs<a class=headerlink href=#logs title="Permanent link">&para;</a></h3> <p>To create custom logs on an Apache server, you must first define a custom log format: <code>LogFormat "example-custom-fmt %h %l %u %t "%r" %&gt;s %b" example-custom-fmt</code></p> <table> <thead> <tr> <th>Variable</th> <th>Explanation</th> </tr> </thead> <tbody> <tr> <td>%h</td> <td>Remote host name</td> </tr> <tr> <td>%l</td> <td>Remote login name</td> </tr> <tr> <td>​%u</td> <td>Remote user</td> </tr> <tr> <td>%t</td> <td>​Time of request</td> </tr> <tr> <td>%r</td> <td>First line of request</td> </tr> <tr> <td>​%s</td> <td>Status</td> </tr> <tr> <td>%b</td> <td>Size of response</td> </tr> </tbody> </table> <p>More tokens reference is here <a href=http://httpd.apache.org/docs/2.2/mod/mod_log_config.html#formats target=_blank>apache mod_log_config</a></p> <h3 id=mod_userdir>mod_userdir<a class=headerlink href=#mod_userdir title="Permanent link">&para;</a></h3> <p>The <code>mod_userdir</code> module is used to allow all or some users to share a part of their home directory via the web server, even without access to the main document root. The URIs will look something like http://example.com/~user/index.html and will commonly be placed in the /home/user/public_html/ directory.</p> <h3 id=ipport-virtual-hosts>IP/Port Virtual Hosts<a class=headerlink href=#ipport-virtual-hosts title="Permanent link">&para;</a></h3> <p>For multiple web sites using multiple addresses/ports, use VirtualHost stanzas, and a unique IP address and port pair. Ensure all of the IP addresses and ports are defined in a Listen directive, and add a stanza for each virtual host. i.e.</p> <div class=highlight><pre><span></span><code>Listen 192.168.42.11:4374
&lt;VirtualHost 192.168.42.11:4374&gt;
   ServerAdmin webmaster@host1.example.com
    DocumentRoot /www/docs/host1.example.com
    ServerName host1.example.com
    ErrorLog logs/host1.example.com-error_log
    CustomLog logs/host1.example.com-access_log common
&lt;/VirtualHost&gt;
</code></pre></div> <p>To enable a name-based virtual host for an IP/Port, create a VirtualHost stanza and modify the DocumentRoot and ServerName directives. Host names which are not defined in a VirtualHost stanza which match the IP address and port will be served by the first VirtualHost stanza.</p> <p>Name-based virtual hosts have some SSL limitations. Due to the way SSL works, the server has no way of knowing which host name is being sent by the client before the SSL session is started. The server cannot send the proper certificate back to the client without the proper host name. This has been worked around by using <a href=https://en.wikipedia.org/wiki/Server_Name_Indication target=_blank>Server Name Indication</a> (SNI).</p> <h3 id=access-control>Access Control<a class=headerlink href=#access-control title="Permanent link">&para;</a></h3> <p>Password-protected directories are protected via SSL. Use <code>htpasswd</code> to create new passwords. See <code>man 1 htpasswd</code>. Per-User Access Control is activated using AllowOverride (.htaccess file). i.e.</p> <div class=highlight><pre><span></span><code>&lt;Location /secure/&gt;
    AuthType Basic
    AuthName &quot;Restricted Files&quot;
    AuthUserFile secure.passwords
    Require valid-user
&lt;/Location&gt;
&lt;Directory /var/www/html/get-only/&gt;
  &lt;LimitExcept GET&gt;
    Require valid-user
  &lt;/LimitExcept&gt;
&lt;/Directory&gt;
</code></pre></div> <p>Filesystem permissions must allow access for the user the Apache httpd daemon is running under (<code>apache</code> on most systems).</p> <p>A properly configured SELinux system can increase the security of an Apache web server. There are some settings you may need to change:</p> <ul> <li>To allow Apache to make outbound network connections (not directly related to serving a request), modify the httpd_can_network_connect boolean.</li> <li>The default Document Root and CGI root have the proper SELinux context. If you serve files from outside those locations, you need to use the chcon command.</li> <li>To enable the userdir module, modify the httpd_read_user_content boolean.</li> <li>To serve files from an NFS filesystem, modify the httpd_use_nfs boolean.</li> </ul> <h3 id=secure-sockets-layer>Secure Sockets Layer<a class=headerlink href=#secure-sockets-layer title="Permanent link">&para;</a></h3> <p>While HTTP is a clear text protocol, <strong>Secure Sockets Layer</strong> (SSL) is a port-based vhost. Types of SSL certificates include:</p> <ul> <li>Self-signed: for hobby or testing use.</li> <li>Certificate Authority Signed (Certificate Signing Request or CSR)​.</li> </ul> <div class=highlight><pre><span></span><code><span class=c1># generate a private key</span>
$ openssl genrsa -aes128 <span class=m>2048</span> &gt; server.key
<span class=c1># generate a CSR</span>
$ openssl req -new -key server.key -out server.csr
<span class=c1># generate a self-signed certificate</span>
$ openssl x509 -req -days <span class=m>365</span> -in server.csr -signkey server.key -out server.crt
<span class=c1># remove the encryption on private key (not recommended)</span>
$ openssl rsa -in server.key -out server.key.unlocked
</code></pre></div> <p>To install the keys, change the configuration file (<code>ssl.config</code>) or place them</p> <div class=highlight><pre><span></span><code><span class=c1># On CentOS:</span>
/etc/pki/tls/certs/localhost.crt: Signed Certificate
/etc/pki/tls/private/localhost.key: Private Key
<span class=c1># On OpenSUSE:</span>
/etc/apache2/ssl.crt/server.crt: Signed Certificate
/etc/apache2/ssl.key/server.key: Private Key
<span class=c1># On Ubuntu:</span>
/etc/ssl/certs/ssl-cert-snakeoil.pem: Signed Certificate
/etc/ssl/private/ssl-cert-snakeoil.key: Private Key
</code></pre></div> <h3 id=rewriting-rules-with-mod_rewrite>Rewriting rules with mod_rewrite<a class=headerlink href=#rewriting-rules-with-mod_rewrite title="Permanent link">&para;</a></h3> <p><strong>URL rewriting</strong> is a powerful way to modify the request that an Apache process receives. Modifications can include moved documents, forcing SSL, forcing login, human-readable URIs, and redirecting based on the browser.</p> <p>Rewrite rules can exist in the <code>.htaccess</code> files, the main <code>configuration file</code>, or <code>&lt;Directory&gt;</code> stanzas. The <code>.htaccess</code> files seem the most common, but the main configuration file may be more secure.</p> <p>The mod_rewrite uses <strong>PCRE</strong> (Perl Compatible Regular Expressions). This provides nearly unlimited conditions or filters to include, like:</p> <ul> <li>Time of day</li> <li>Environment variables</li> <li>URLs or query strings</li> <li>HTTP headers</li> <li>External scripts</li> </ul> <p>Use a <a href=http://httpd.apache.org/docs/current/rewrite/rewritemap.html target=_blank>rewrite map</a> for advanced or dynamic rewrite rules, which is useful when rewrite rules are too complex or numerous.. Pre-compiled rewrite maps exist for specific purposes, i.e. <a href=http://wurfl.sourceforge.net/ target=_blank>WURFL</a>.</p> <p>There are many different types of maps:</p> <ul> <li>txt: Flat text</li> <li>dbm: DBM hash (indexed)</li> <li>rnd: Randomized plain text</li> <li>prg: External program</li> </ul> <p>Some rewriting examples</p> <div class=highlight><pre><span></span><code><span class=c1># turn on the rewrite engine</span>
RewriteEngine on
<span class=c1># force a redirect to a new location for a document</span>
RewriteRule ˆ/old.html$ new.html <span class=o>[</span>R<span class=o>]</span>
<span class=c1># rewrite a URI based on the web browser (without a redirect), use:</span>
RewriteCond %<span class=o>{</span>HTTP_USER_AGENT<span class=o>}</span> .*Chrome.*
RewriteRule ˆ/foo.html$ /chrome.html <span class=o>[</span>L<span class=o>]</span>
<span class=c1># create a human-readable URI from a CGI script (the PT or Passthrough flag: without it, the rewrite is treated as a file, not a URI)</span>
RewriteRule ˆ/script/<span class=o>(</span>.*<span class=o>)</span> /cgi-bin/script.cgi?<span class=nv>$1</span> <span class=o>[</span>L,PT<span class=o>]</span>
</code></pre></div> <h3 id=mod_alias>mod_alias<a class=headerlink href=#mod_alias title="Permanent link">&para;</a></h3> <p>The <code>mod_alias</code> maps URIs to filesystem paths outside of normal <code>DocumentRoot</code>. It also provides <code>Alias</code> and <code>Redirect</code> directives, Apache access control considerations, file permission considerations, and SELinux considerations.</p> <p><code>mod_alias</code> is much simpler than <code>mod_rewrite</code>. A redirect directive sends a redirect that is similar to the <code>[R]</code> flag for <code>mod_rewrite</code>. <code>AliasMatch</code> allows use of regular expressions. Example:</p> <div class=highlight><pre><span></span><code><span class=c1># serve the files located at /newdocroot/ under the URI /new/ (the &lt;Directory&gt; stanza for access control modifications)</span>
Alias /new/ /newdocroot/
&lt;Directory /newdocroot/&gt;
    Options Indexes FollowSymLinks
    AllowOverride None
    Require all granted
&lt;/Directory&gt;
<span class=c1># serve the files located at /newdocroot/&lt;SUBDIR&gt; under the URI /new/&lt;SUBDIR&gt; with different permissions for each</span>
AliasMatch <span class=se>\ˆ</span><span class=o>{}</span>/new/<span class=o>(</span>.*<span class=o>)</span>$ /newdocroot/<span class=nv>$1</span>
&lt;Directory /newdocroot/foo/&gt;
    Options Indexes FollowSymLinks
    AllowOverride None
    Require all granted
&lt;/Directory&gt;
&lt;Directory /newdocroot/bar/&gt;
    Options -Indexes FollowSymLinks
    Require all granted
&lt;/Directory&gt;
</code></pre></div> <p>There are two ways to run scripts outside your document root:</p> <ul> <li>Create an <code>Alias</code> and set the handler to <code>cgi-script</code>.</li> <li>Use <code>ScriptAlias</code> (does the above automatically).</li> </ul> <p>Because of the nature of Common Gateway Interface (CGI) scripts, they should not be directly served as plain files and should not be in your document root. Example</p> <div class=highlight><pre><span></span><code>ScriptAlias /newscripts/ /newscripts-docroot/
&lt;Directory /newscripts-docroot/&gt;
    Options Indexes FollowSymLinks
    AllowOverride None
    Require all granted
&lt;/Directory&gt;
</code></pre></div> <h3 id=mod_status-mod_include-mod_perl>mod_status, mod_include, mod_perl<a class=headerlink href=#mod_status-mod_include-mod_perl title="Permanent link">&para;</a></h3> <p><code>mod_status</code> provides an endpoint to show characteristics:</p> <ul> <li>Apache server status</li> <li>Human-readable page</li> <li>Machine-readable page</li> <li>Security considerations with access control and extended status</li> </ul> <p><code>mod_include</code> provides filtering before a response is sent to the client. It is enabled with the <code>+Includes</code> directive. By default, this is enabled only for <code>*.shtml</code> files, but it can be enabled for all <code>*.html</code> files with the <code>XBitHack</code> directive, and execute permission should be set on the file.</p> <p><code>mod_perl</code> is a Perl interpreter embedded in Apache. It can provide full access to the entire Apache API, sharing information between Apache processes. CGI scripts can run unmodified. However, some CPAN (Comprehensive Perl Archive Network) modules are not thread-safe, therefore they do not work with the worker MPM (Multi-Processing Module). Some Perl methods like <code>die()</code> and <code>exit()</code> can cause performance issues.</p> <p>Example:</p> <div class=highlight><pre><span></span><code>&lt;Location /status&gt;
  SetHandler server-status
  Require ip <span class=m>10</span>.100.0.0/24
&lt;/Location&gt;

&lt;Location /dynamic/&gt;
   Options +Includes
   XBitHack on
&lt;/Location&gt;
<span class=c1># An HTML file which had includes would contain:</span>
&lt;!--#set <span class=nv>var</span><span class=o>=</span><span class=s2>&quot;dude&quot;</span> <span class=nv>value</span><span class=o>=</span><span class=s2>&quot;yes&quot;</span> --&gt;
&lt;!--#echo <span class=nv>var</span><span class=o>=</span><span class=s2>&quot;dude&quot;</span> --&gt;
&lt;!--#include <span class=nv>virtual</span><span class=o>=</span><span class=s2>&quot;http://localhost/includes/foo.html&quot;</span> --&gt;

Alias /perl /var/www/perl
&lt;Directory /var/www/perl&gt;
   SetHandler perl-script
   PerlResponseHandler ModPerl::Registry
   PerlOptions +ParseHeaders
   Options +ExecCGI
&lt;/Directory&gt;
</code></pre></div> <h3 id=multi-processing-modules-mpms>Multi-Processing Modules (MPMs)<a class=headerlink href=#multi-processing-modules-mpms title="Permanent link">&para;</a></h3> <p>The <strong>Prefork</strong> MPM is the default MPM, non-threaded, safe for non-thread-safe scripts and libraries. It uses more memory and resources to handle the same number of connections compared to others.</p> <p>The <strong>Worker</strong> MPM is a hybrid multi-process, multi-threaded model. Each sub-process spawns threads which handle the incoming connections and perform better from the lighter threads than processes.</p> <p>The <strong>Event</strong> MPM is based on the Worker MPM but it off-loads some of the request handling to shared processes and further boosts performance.</p> <p>Some Prefork configurations:</p> <ul> <li><code>StartServers</code> - number of child server processes to create on startup</li> <li><code>MinSpareServers</code> - min number of child server processes to keep on hand to serve incoming requests</li> <li><code>MaxSpareServers</code> - max number of child server processes to keep on hand to serve incoming requests</li> <li><code>MaxRequestsPerChild</code> - max number of requests a child server process serves</li> <li><code>MaxClients</code> - max number of simultaneous connections to serve. May also have to increase the <code>ServerLimit</code> directive</li> </ul> <p>Some Worker configurations in addition to the Prefork:</p> <ul> <li>MinSpareThreads - min number of worker threads to keep on hand to serve incoming requests</li> <li>MaxSpareThreads - max number of worker threads to keep on hand to serve incoming requests</li> <li>ThreadsPerChild - number of worker threads in each child server process</li> </ul> <h3 id=load-test>Load Test<a class=headerlink href=#load-test title="Permanent link">&para;</a></h3> <p>The best testing results come from using URIs which match the real-life workflow. Apachebench (<code>ab</code>) is the tool provided as a part of the Apache httpd server package. Httperf (<code>httperf</code>) can use log files as a source of URIs to load test.</p> <h3 id=load-balance>Load Balance<a class=headerlink href=#load-balance title="Permanent link">&para;</a></h3> <p>Apache load balancer requires the modules <code>mod_proxy</code> (along with its complementary modules) and <code>mod_proxy_balancer</code> which have specialized modules for the balancing strategy:</p> <ul> <li><code>mod_libmethod_byrequests</code> (request counting)</li> <li><code>mod_libmethod_traffic</code> (weighted traffic counting)</li> <li><code>mod_libmethod_bybusyness</code> (pending request counting)</li> <li><code>mod_libmethod_heartbeat</code> (heartbeat traffic counting)</li> </ul> <p>A minimal configuration as an example:</p> <div class=highlight><pre><span></span><code>&lt;VirtualHost *:80&gt;
    ProxyRequests off
    ServerName www.somedomain.com
    &lt;Proxy balancer://mycluster&gt;
        BalancerMember ht‌tp://10.176.42.144:80 <span class=c1>#minion1</span>
        BalancerMember ht‌tp://10.176.42.148:80 <span class=c1>#minion2</span>
        BalancerMember ht‌tp://10.176.42.150:80 <span class=c1>#minion3</span>
        Require all granted <span class=c1># all requests are allowed</span>
        ProxySet <span class=nv>lbmethod</span><span class=o>=</span>byrequests <span class=c1># balancer setting, round-robin</span>
    &lt;/Proxy&gt;
    ProxyPass / balancer://mycluster/
&lt;/VirtualHost&gt;
</code></pre></div> <h3 id=cacheing-and-proxy>Cacheing and Proxy<a class=headerlink href=#cacheing-and-proxy title="Permanent link">&para;</a></h3> <p>Apache can act as a <strong>forward</strong> or <strong>reverse proxy</strong> that is managed by <code>mod_proxy</code> and <code>mod_proxy_http</code>. However, there are special-purpose tools which do caching much more efficiently:</p> <ul> <li>Varnish: A RAM and disk-based cache which uses the Linux kernel's swapping mechanism to speed up caching.</li> <li>Squid: A general-purpose caching proxy.</li> </ul> <div class=highlight><pre><span></span><code><span class=c1># enable a reverse proxy to an internal server</span>
&lt;Location /foo&gt;
    ProxyPass ht‌tp://appserver1.example.com/foo
&lt;/Location&gt;
<span class=c1># alternative syntax</span>
ProxyPass /foo ht‌tp://appserver1.example.com/foo
</code></pre></div> <h3 id=c10k-problem-and-speciality-http-servers>C10k Problem and Speciality HTTP Servers<a class=headerlink href=#c10k-problem-and-speciality-http-servers title="Permanent link">&para;</a></h3> <p>The <strong>C10k Problem</strong> describes the issues in making a web server which can scale to ten thousand concurrent connections/requests.</p> <p>Specialty HTTP servers have been developed to deal with different issues.</p> <ul> <li>cherokee - innovative web-based configuration panel, very fast in serving dynamic and static content</li> <li>nginx - has a small resource footprint, scales well from small servers to high performance web servers</li> <li>lighttpd - power some high-profile sites, light-weight and scales well</li> </ul> <h2 id=email-servers>Email Servers<a class=headerlink href=#email-servers title="Permanent link">&para;</a></h2> <p>Email programs and daemons have multiple roles and utilize various protocols.</p> <p><strong>Mail User Agent</strong> (MUA) is the main role of email client for composing and reading emails. It uses Internet Message Access Protocol (IMAP) or Post Office Protocol (POP3).</p> <p><strong>Mail Submission Program</strong> (MSP) is the role of email client responsible for sending mails through the Mail Transfer Agent (MTA) using SMTP.</p> <p><strong>Mail Transfer Agent</strong> (MTA) is the main role of email server, responsible for starting the process of sending the message to the recipient by looking up the recipient and sending the message to their MTA using SMTP.</p> <p><strong>Mail Delivery Agent</strong> (MDA) is the role of email server for receiving and storing email for future retrieval. MTA uses SMTP, Local Mail Transfer Protocl (LMTP) or other protocols to transfer message to MDA.</p> <p><strong>SMTP</strong> is a TCP/IP protocol used as an Internet standard for electronic mail transmission. It uses a plain "English" syntax such as <code>HELO, MAIL, RCPT, DATA, or QUIT</code>. SMTP is easily tested using <code>telnet</code>.</p> <p><strong>POP3</strong> is one of the main protocols used by MUAs to fetch mail. By default, the protocol downloads the messages and deletes them from the server. It is simpler yet less flexible protocol.</p> <p><strong>IMAP</strong> is the other main protocol used by MUA to fetch mail. Messages are managed on the server and left there. Copies are downloaded to the MUA. This protocol is more complex and more flexible than POP3.</p> <h3 id=email-lifecycle>Email lifecycle<a class=headerlink href=#email-lifecycle title="Permanent link">&para;</a></h3> <p>The email life cycle looks like this:</p> <ol> <li>You compose an email using your MUA.</li> <li>Your MUA connects to your outbound MTA via SMTP, and sends the message to be delivered.</li> <li>Your outbound MTA connects to the inbound MTA of the recipient via SMTP, and sends the message along. (Note: This step can happen more than once).</li> <li>Once the message gets to the final destination MTA, it is delivered to the MDA. This can happen over SMTP, LMTP or other protocols.</li> <li>The MDA stores the message (on disk as a file, or in a database, etc).</li> <li>The recipient connects (via IMAP, POP3 or a similar protocol) to their email server, and fetches the message. The IMAP or POP daemon fetches the message out of the storage and sends it to the MUA.</li> <li>The message is then read by the recipient.</li> </ol> <h4 id=postfix>Postfix<a class=headerlink href=#postfix title="Permanent link">&para;</a></h4> <p>Postfix has components that does MTA and MDA. In postfix <code>/etc/postfix/main.cf</code> contains location information for the alias database; <code>/etc/aliases</code> (<code>newaliases</code> command) for system-wide redirection of mail, <code>~/.forward</code> for user-configurable redirection of mail. <code>/etc/aliases</code> generally stores data in a <code>.bdm</code> or hash format, with format <code>name : val1, val2, val3 ...</code></p> <p>The <code>postconf</code> command can be used to customize <code>main.cf</code>. Some usual candidates for customization in <code>main.cf</code>: </p> <ul> <li>The domain name to use for outbound mail (myorigin).</li> <li>The domains to receive mail for (mydestination).</li> <li>The clients to allow relaying of mail (mynetworks).</li> <li>The destinations to relay mail to (relay_domains).</li> <li>The delivery method, indirect or direct (relayhost).</li> <li>Trust hosts for blindly forward email (mynetworkds_style).</li> <li>IP addresses to listen on for incoming connections (inet_interfaces).</li> </ul> <p>Within Postfix there is a process called master that controls all other Postfix processes that are involved in moving mail. The defaults in the <code>/etc/postfix/master.cf</code> file are usually sufficient.</p> <p>SMTP is a clear-text protocol, security is a concern; postfix by default has no SSL/TLS encryption and no spam filtering. Postfix does not provide a <strong>Simple Authentication and Security Layer</strong> (SASL) mechanism itself and relies on proper set up. Postfix daemon support the Cyrus SASL or the Dovecot SASL mechanisms.</p> <div class=highlight><pre><span></span><code><span class=nv>smtpd_sasl_type</span> <span class=o>=</span> dovecot
<span class=nv>smtpd_sasl_path</span> <span class=o>=</span> private/auth
<span class=nv>smtpd_sasl_auth_enable</span> <span class=o>=</span> yes
<span class=nv>broken_sasl_auth_clients</span> <span class=o>=</span> yes
</code></pre></div> <p>Postfix SASL authentication with Dovecot can be enabled over a UNIX Domain Socket and over TCP. To enable UNIX accounts to authenticate over a UNIX Domain Socket, edit the <code>/etc/dovecot/conf.d/10-master.conf</code> file:</p> <div class=highlight><pre><span></span><code>service auth <span class=o>{</span>
   unix_listener auth-userdb <span class=o>{</span> <span class=o>}</span>
   unix_listener /var/spool/postfix/private/auth <span class=o>{</span> <span class=o>}</span>
<span class=o>}</span>
</code></pre></div> <p>When testing plain-text SASL authentication, you will need to submit a base64 encoded username and password, i.e. <code>echo -en "\0user\0password" | base64</code>, then test SMTP auth with <code>AUTH PLAIN &lt;hash_string&gt;</code></p> <p>To enable TLS encryption:</p> <div class=highlight><pre><span></span><code><span class=nv>smtpd_tls_cert_file</span> <span class=o>=</span> /etc/postfix/server.pem
<span class=nv>smtpd_tls_key_file</span> <span class=o>=</span> <span class=nv>$smtpd_tls_cert_file</span>
<span class=nv>smtpd_tls_security_level</span> <span class=o>=</span> may
<span class=nv>smtpd_tls_auth_only</span> <span class=o>=</span> yes
</code></pre></div> <p>Some ways to monitor postfix:</p> <ul> <li>pflogsumm - a Perl script which translates Postfix log files into a human-readable summary.</li> <li>qshape - prints the domains and ages of items in the Postfix queue, useful for determining where emails are getting stuck in queues. The output of the command displays the distribution of the items in the Postfix queues by recipient or sender domain.</li> <li>mailgraph - creates RRD graphics of mail logs and allows monitor trends in your email server.</li> </ul> <p>SpamAssassin can be used as a milter (mail filter) or a standalone MDA. Other tools exist like Sender Policy Framework, DomainKeys.</p> <h4 id=dovecot>Dovecot<a class=headerlink href=#dovecot title="Permanent link">&para;</a></h4> <p>Dovecot is an open-source IMAP/POP3 server. Dovecot is secure, easy to configure and is standards compliant.</p> <p>The <code>doveconf</code> utility parses the configuration file (<code>/etc/dovecot/dovecot.conf, /etc/dovecot/conf.d/</code>) for both the Dovecot daemons and for debugging purposes.</p> <p>The common Dovecot setup binds to a specific IP address, defines the protocols to serve, applies password restrictions, accepts some clients with minor protocol issues, and points to user and password databases:</p> <div class=highlight><pre><span></span><code><span class=nv>listen</span> <span class=o>=</span> <span class=m>10</span>.20.34.111
<span class=nv>protocols</span> <span class=o>=</span> imap pop3 lmtp
<span class=nv>disable_plaintext_auth</span> <span class=o>=</span> yes
imap_client_workarounds pop3_client_workarounds

<span class=c1># SSL/TSL config in /etc/dovecot/conf.d/10-ssl.conf</span>
<span class=nv>ssl</span> <span class=o>=</span> yes
<span class=nv>ssl_cert</span> <span class=o>=</span> &lt; cert-file &gt; <span class=c1># suggested permissions root:root 0444</span>
<span class=nv>ssl_key</span> <span class=o>=</span> &lt; private-key-file &gt; <span class=c1># suggested permissions root:root 0400</span>
</code></pre></div> <p>A working email client is the easiest way to troubleshoot and test an IMAP or POP3 server. The mutt email client works well.</p> <h2 id=file-sharing>File Sharing<a class=headerlink href=#file-sharing title="Permanent link">&para;</a></h2> <p>The <strong>File Transfer Protocol</strong> (FTP) is one of the first protocols of the Internet. Data is sent in plain text. Clients have interactive or non-interactive modes.</p> <p>FTP Active transfer mode let server push data to the client on a random high-numbered port. This method is not compatible with firewalls or NAT networks.</p> <p>FTP Passive transfer mode let client request a passive connection and the server opens a random high-numbered port for data transfer.</p> <h3 id=vsftpd>vsftpd<a class=headerlink href=#vsftpd title="Permanent link">&para;</a></h3> <p>Very Secure FTP Daemon (<code>vsftpd</code>) has enhanced security features than FTP server:</p> <ul> <li>Virtual IPs</li> <li>Virtual users</li> <li>Stand-alone daemon or inetd-ready</li> <li>Per-user configuration</li> <li>Per-source configuration</li> <li>Optional SSL integration</li> </ul> <p>Verify that anonymous access is enabled in <code>vsftpd.conf</code>: <code>anonymous_enable=YES</code>. To allow system users to create authenticated FTP sessions, you should make the following changes to <code>vsftpd.conf</code>:</p> <div class=highlight><pre><span></span><code>local_enable=YES
write_enable=YES
local_umask=022
</code></pre></div> <p><code>vsftpd</code> uses PAM by default for authentication (<code>/etc/pam.d/vsftpd</code>). System security is enforced by the files <code>/etc/vsftpd/ftpusers, /etc/vsftpd/users_list</code>. Account names listed in <code>ftpusers</code> are not allowed to login via FTP.</p> <p>Depending on the value of the <code>userlist_deny</code> setting in vsftpd.conf, the users in <code>/etc/vsftpd/users_list</code> act as either allow only the users in the list, or explicitly deny the listed users.</p> <h3 id=rsync>rsync<a class=headerlink href=#rsync title="Permanent link">&para;</a></h3> <p>The <strong>rsync</strong> protocol was written as a replacement for rcp and uses an advanced algorithm to intelligently transfer files. Only the files or parts of files which have <strong>changed</strong> are copied.</p> <p><code>rsync</code> uses Delta encoding and requires the source and destination to be specified (either or both may be remote). <code>rsync</code> protocol does not have in-transit security. However, rsync can be tunneled over the SSH protocol. </p> <p><code>rsync</code> is mostly used over SSH, but starting the <code>rsync</code> daemon is as easy as <code>rsync --daemon</code>. When running as a daemon, rsync will read the <code>/etc/rsyncd.conf</code> configuration file. Each client that connects to the rsync daemon will force rsync to re-read the configuration.</p> <p>The <code>/etc/rsyncd.conf</code> file defines global options, as well as rsync modules which will be served by the rsync daemon. When running the <code>rsync</code> command, it will use any transparent remote shell. The default shell is ssh, which encrypts the traffic. The rsync protocol can be invoked with the <code>rsync://</code> URI in the command or with <code>rsyncd</code>. i.e. <code>rsync -av root@server:/etc/. /srv/backup/server-backup/etc/.</code> backs up an entire directory.</p> <h3 id=scp-and-sftp>scp and sftp<a class=headerlink href=#scp-and-sftp title="Permanent link">&para;</a></h3> <p><code>scp</code> (Secure Copy) is non-interactive, while <code>sftp</code> (Simple File Transfer Protocol) is interactive way to transfer files and they both use your system or the user ssh client configuration files (<code>~/.ssh/config</code>).</p> <h3 id=webdav>WebDAV<a class=headerlink href=#webdav title="Permanent link">&para;</a></h3> <p><strong>WebDAV</strong> is an extension to HTTP for read/write access to resources and is available on most operating systems. A command-line tool <code>cadaver</code> can be used to manipulate a WebDAV share. </p> <p>The Apache module <code>mod_dav</code> is one method to enable WebDAV and requires a defined lock file, which should be writable by the Apache user: <code>DavLockDB davlockdb</code>. WebDAV can be enabled in either a <code>&lt;Directory&gt;</code> or <code>&lt;Location&gt;</code> stanza. However, it is more secure to create an alias and use the directory options to increase security. Uploads, PUT, POST, and similar methods should not be allowed, except for by an authenticated user.</p> <h3 id=bittorrent>BitTorrent<a class=headerlink href=#bittorrent title="Permanent link">&para;</a></h3> <p><strong>BitTorrent</strong> is a protocol which allows for very efficient transfer of large files or directories using a <strong>distributed peer-to-peer</strong> architecture. A file served over BitTorrent is divided into small chunks and is distributed by anyone who is connected to the same tracker. This allows for much lesser resource use by the server hosting the original content, as the file needs to be downloaded only once.</p> <p>BitTorrent becomes more efficient the more concurrent clients are participating. Tools available are <code>rtorrent</code> as a CLI client and <code>mktorrent</code> as a CLI for creating <code>.torrent</code> files.</p> <h2 id=advanced-networking>Advanced Networking<a class=headerlink href=#advanced-networking title="Permanent link">&para;</a></h2> <h3 id=routing>Routing<a class=headerlink href=#routing title="Permanent link">&para;</a></h3> <p>Routing commands include <code>route</code> and <code>ip route</code>. Dynamic routing protocols include RIP, OSPF, BGP and IS-IS.</p> <p>To create a new run time route, do <code>ip route add 10.1.11.0/24 via 10.30.0.101 dev eth2</code></p> <p>To create a static rule which will survive a reboot, do:</p> <div class=highlight><pre><span></span><code><span class=c1># On CentOS, edit the /etc/sysconfig/network-scripts/route-&lt;INTERFACE&gt; file and add a line like this:</span>
<span class=m>10</span>.1.11.0/24 via <span class=m>10</span>.30.0.101 dev eth2
<span class=c1># On Ubuntu, edit the /etc/network/interfaces file and add a line like this:</span>
ip route add -net <span class=m>10</span>.1.11.0/24 gw <span class=m>10</span>.30.0.101 dev eth2
<span class=c1># On OpenSUSE, edit the /etc/sysconfig/network/ifroute-&lt;INTERFACE&gt; file and add a line like this:</span>
<span class=m>10</span>.1.11.0/24 <span class=m>10</span>.30.0.101 - eth2
<span class=c1># Network Manager systems can use:</span>
nmcli con modify <span class=s2>&quot;connection-name&quot;</span> ipv4.routes <span class=s2>&quot;10.1.11.0/24 10.30.0.101 99&quot;</span>
</code></pre></div> <p>The downside to static routes is inflexibility. Dynamic routing protocols are more efficient at detecting and fixing routing problems quickly. </p> <h3 id=vlan>VLAN<a class=headerlink href=#vlan title="Permanent link">&para;</a></h3> <p>VLANs use functionality in the switches and routers. The most common use for VLANs is to bridge switches together. A VLAN is also a method for securing two or more LANs from each other on the same set of switches.</p> <p>Creating a trunk connection (802.1q is one such protocol between two switches essentially connects the networks together. VLANs can be created on the trunked together switches to then isolate specific ports on each switch to belong to a Virtual LAN. VLANs use optional functionality within the packet to identify which VLANs are being used.</p> <p>When VLANs are enabled, an additional header is added to the packet. This is the 802.1Q or dot1q header. The 802.1Q header contains:</p> <ul> <li> <p><strong>Tag Protocol ID</strong> (TPID), a 16bit identifier to distinguish between a VLAN tagged frame or it indicates the EtherType. The value of x8100 indicates an 802.1Q tagged frame.</p> </li> <li> <p>The next 16bits are the <strong>Tag Control Information</strong> (TCI), comprising of:</p> <ul> <li><strong>Priority Code Point</strong> (PCP), a 3bit field that indicates the 802.1q priority class. See the IEEE P802.1Q webpage for more details.</li> <li><strong>Drop Eligible Indicator</strong> (DEI). This 1bit flag indicates the frame may be dropped when network congestion occurs. The field may be used alone or in conjunction with the PCP. This field used to be the <strong>Canonical Format Indicator</strong> (CFI), and was used for compatibility between Ethernet and Token Ring frames.</li> <li><strong>VLAN Identifier ID</strong> (VID), a 12bit field indicating to which VLAN the frame belongs to.</li> </ul> </li> </ul> <p><img src=https://d36ai2hkxl16us.cloudfront.net/course-uploads/e0df7fbf-a057-42af-8a1f-590912be5460/wcyzmjoqtair-LFS311-V6_vlan-packet.png></p> <h3 id=dhcp-server>DHCP Server<a class=headerlink href=#dhcp-server title="Permanent link">&para;</a></h3> <p>The dhcpd daemon is configured with <code>/etc/dhcp/dhcpd.conf</code> and some options files: <code>/etc/sysconfig/dhcpd</code> (CentOS), <code>/etc/default/isc-dhcp-server</code> (Ubuntu), <code>/etc/sysconfig/dhcpd</code> (OpenSUSE)</p> <p>The dhcp server will only serve out addresses on an interface that it finds a subnet block defined in the <code>/etc/dhcp/dhcpd.conf</code> file. Additional or different daemon command line options may be passed to the daemon at start time by the systems' drop-in files.</p> <p>Global options are settings which should apply to all the hosts in a network. You can also define options on a per-network basis.</p> <p>A sample configuration would be:</p> <div class=highlight><pre><span></span><code>subnet 10.5.5.0 netmask 255.255.255.224 {
  range 10.5.5.26 10.5.5.30;
  option domain-name-servers ns1.internal.example.org;
  option domain-name &quot;internal.example.org&quot;;
  option routers 10.5.5.1;
  option broadcast-address 10.5.5.31;
  default-lease-time 600;
  max-lease-time 7200;
}
</code></pre></div> <h3 id=network-time-protocol>Network Time Protocol<a class=headerlink href=#network-time-protocol title="Permanent link">&para;</a></h3> <p>The security of many encryption systems is highly dependent on proper time. <strong>NTP</strong> time sources are divided up into <strong>strata</strong>.</p> <ul> <li>A strata 0 clock is a special purpose time device (atomic clock, GPS radio, etc).</li> <li>A strata 1 server is any NTP server connected directly to a strata 0 source (over serial or the like).</li> <li>A strata 2 server is any NTP server which references a strata 1 server using NTP.</li> <li>A strata 3 server is any NTP server which references a strata 2 server using NTP.</li> </ul> <p>NTP may function as a client, a server, or a peer:</p> <ul> <li>Client: Acquires time from a server or a peer.</li> <li>Server: Provides time to a client.</li> <li>Peers: Synchronize time between other peers, regardless of the defined servers.</li> </ul> <p>Some NTP applications implementations are <code>ntp</code>, <code>chrony</code>, or <code>systemd-timesyncd</code>.</p> <p>The <code>ntpdc -c peers</code> command can show the time difference between the local system and configured time servers. The <code>timedatectl</code> command is in many distributions and may be used to query and control the system time and date.</p> <p>To configure the <code>ntpd</code> server, allow clients to request time (restrict), set up access for peers, declare the local machine to be a time reference, regulate who can query the time server with <code>ntpq</code> and <code>ntpdc</code> commands and start the NTP daemon.</p> <p>A good NTP server is only as good as its time source. The NTP Pool Project was created to alleviate the load that was crippling the small number of NTP servers. To configure your NTP server to use the NTP pool, edit the /etc/ntp.conf file and add or edit the following settings:</p> <div class=highlight><pre><span></span><code>driftfile /var/lib/ntp/ntp.drift
pool 0.pool.ntp.org
pool 1.pool.ntp.org
pool 2.pool.ntp.org
pool 3.pool.ntp.org
</code></pre></div> </article> </div> </div> </main> <footer class=md-footer> <div class=md-footer-nav> <nav class="md-footer-nav__inner md-grid" aria-label=Footer> <a href=../Linux_Foundation_System_Admin/ class="md-footer-nav__link md-footer-nav__link--prev" rel=prev> <div class="md-footer-nav__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer-nav__title> <div class=md-ellipsis> <span class=md-footer-nav__direction> Previous </span> Linux System Administration </div> </div> </a> <a href=../../Commands/Freq-Used-Shell-Cmds/ class="md-footer-nav__link md-footer-nav__link--next" rel=next> <div class=md-footer-nav__title> <div class=md-ellipsis> <span class=md-footer-nav__direction> Next </span> Freq Used Shell Cmds </div> </div> <div class="md-footer-nav__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <script src=../../../assets/javascripts/vendor.53cc9318.min.js></script> <script src=../../../assets/javascripts/bundle.e9c9f54f.min.js></script><script id=__lang type=application/json>{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script> <script>
        app = initialize({
          base: "../../..",
          features: ['navigation.tabs', 'navigation.instant'],
          search: Object.assign({
            worker: "../../../assets/javascripts/worker/search.9c0e82ba.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script> </body> </html>