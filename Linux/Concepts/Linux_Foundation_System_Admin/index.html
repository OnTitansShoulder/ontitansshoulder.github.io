<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="We are all standing on the shoulders of the giants..."><meta name=author content="Zhongkai Liu"><link rel="shortcut icon" href=../../../assets/favicon.ico><meta name=generator content="mkdocs-1.1.2, mkdocs-material-6.2.6"><title>Linux System Adminstration - Ontitansshoulder</title><link rel=stylesheet href=../../../assets/stylesheets/main.cb6bc1d0.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.39b8e14a.min.css><meta name=theme-color content=#4051b5><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style><link rel=stylesheet href=../../../css/extra.css></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#linux-filesystem-tree-layout class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid" aria-label=Header> <a href=../../.. title=Ontitansshoulder class="md-header-nav__button md-logo" aria-label=Ontitansshoulder> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg> </a> <label class="md-header-nav__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header-nav__title data-md-component=header-title> <div class=md-header-nav__ellipsis> <div class=md-header-nav__topic> <span class=md-ellipsis> Ontitansshoulder </span> </div> <div class=md-header-nav__topic> <span class=md-ellipsis> Linux System Adminstration </span> </div> </div> </div> <label class="md-header-nav__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query data-md-state=active required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <button type=reset class="md-search__icon md-icon" aria-label=Clear data-md-component=search-reset tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class="md-tabs__link md-tabs__link--active"> Notes </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title=Ontitansshoulder class="md-nav__button md-logo" aria-label=Ontitansshoulder> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg> </a> Ontitansshoulder </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1 type=checkbox id=nav-1 checked> <label class=md-nav__link for=nav-1> Notes <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Notes data-md-level=1> <label class=md-nav__title for=nav-1> <span class="md-nav__icon md-icon"></span> Notes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> Welcome </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-2 type=checkbox id=nav-1-2> <label class=md-nav__link for=nav-1-2> Foundamentals <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Foundamentals data-md-level=2> <label class=md-nav__title for=nav-1-2> <span class="md-nav__icon md-icon"></span> Foundamentals </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Foundamental/Data_Structures_and_Algos/ class=md-nav__link> Data Structures and Algos </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-3 type=checkbox id=nav-1-3 checked> <label class=md-nav__link for=nav-1-3> Linux <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Linux data-md-level=2> <label class=md-nav__title for=nav-1-3> <span class="md-nav__icon md-icon"></span> Linux </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-3-1 type=checkbox id=nav-1-3-1 checked> <label class=md-nav__link for=nav-1-3-1> Concepts <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Concepts data-md-level=3> <label class=md-nav__title for=nav-1-3-1> <span class="md-nav__icon md-icon"></span> Concepts </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Linux_Foundation/ class=md-nav__link> Linux Foundation </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Linux System Administration <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Linux System Administration </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#linux-filesystem-tree-layout class=md-nav__link> Linux Filesystem Tree Layout </a> <nav class=md-nav aria-label="Linux Filesystem Tree Layout"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#bin class=md-nav__link> /bin </a> </li> <li class=md-nav__item> <a href=#boot class=md-nav__link> /boot </a> </li> <li class=md-nav__item> <a href=#dev class=md-nav__link> /dev </a> </li> <li class=md-nav__item> <a href=#etc class=md-nav__link> /etc </a> </li> <li class=md-nav__item> <a href=#opt class=md-nav__link> /opt </a> </li> <li class=md-nav__item> <a href=#proc class=md-nav__link> /proc </a> </li> <li class=md-nav__item> <a href=#sys class=md-nav__link> /sys </a> </li> <li class=md-nav__item> <a href=#sbin class=md-nav__link> /sbin </a> </li> <li class=md-nav__item> <a href=#usr class=md-nav__link> /usr </a> </li> <li class=md-nav__item> <a href=#var class=md-nav__link> /var </a> </li> <li class=md-nav__item> <a href=#run class=md-nav__link> /run </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#processes class=md-nav__link> Processes </a> <nav class=md-nav aria-label=Processes> <ul class=md-nav__list> <li class=md-nav__item> <a href=#definition class=md-nav__link> Definition </a> </li> <li class=md-nav__item> <a href=#process-attributes class=md-nav__link> Process Attributes </a> <nav class=md-nav aria-label="Process Attributes"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#control-process-with-ulimit class=md-nav__link> Control process with ulimit </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#creating-processes class=md-nav__link> Creating Processes </a> </li> <li class=md-nav__item> <a href=#process-states class=md-nav__link> Process States </a> </li> <li class=md-nav__item> <a href=#execution-modes class=md-nav__link> Execution Modes </a> <nav class=md-nav aria-label="Execution Modes"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#user-mode class=md-nav__link> User Mode </a> </li> <li class=md-nav__item> <a href=#system-kernel-mode class=md-nav__link> System (Kernel) Mode </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#daemons class=md-nav__link> Daemons </a> </li> <li class=md-nav__item> <a href=#nice-value-set-priorities class=md-nav__link> nice value set priorities </a> </li> <li class=md-nav__item> <a href=#static-and-shared-libraries class=md-nav__link> Static and Shared Libraries </a> </li> <li class=md-nav__item> <a href=#signals class=md-nav__link> Signals </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#package-management-systems class=md-nav__link> Package Management Systems </a> <nav class=md-nav aria-label="Package Management Systems"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#package-types class=md-nav__link> Package Types </a> </li> <li class=md-nav__item> <a href=#packaing-tool-levels class=md-nav__link> Packaing Tool Levels </a> </li> <li class=md-nav__item> <a href=#package-sources class=md-nav__link> Package Sources </a> </li> <li class=md-nav__item> <a href=#source-control-management-system class=md-nav__link> Source control Management System </a> <nav class=md-nav aria-label="Source control Management System"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#git class=md-nav__link> Git </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#rpm class=md-nav__link> RPM </a> <nav class=md-nav aria-label=RPM> <ul class=md-nav__list> <li class=md-nav__item> <a href=#queries class=md-nav__link> Queries </a> </li> <li class=md-nav__item> <a href=#verifying-packages class=md-nav__link> Verifying Packages </a> </li> <li class=md-nav__item> <a href=#installing-package class=md-nav__link> Installing package </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#dpkg class=md-nav__link> DPKG </a> <nav class=md-nav aria-label=DPKG> <ul class=md-nav__list> <li class=md-nav__item> <a href=#queries_1 class=md-nav__link> Queries </a> </li> <li class=md-nav__item> <a href=#installing-package_1 class=md-nav__link> Installing package </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#dnf-and-yum class=md-nav__link> DNF and YUM </a> <nav class=md-nav aria-label="DNF and YUM"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#queries_2 class=md-nav__link> Queries </a> </li> <li class=md-nav__item> <a href=#installing-package_2 class=md-nav__link> Installing package </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#apt class=md-nav__link> APT </a> <nav class=md-nav aria-label=APT> <ul class=md-nav__list> <li class=md-nav__item> <a href=#queries_3 class=md-nav__link> Queries </a> </li> <li class=md-nav__item> <a href=#installing-package_3 class=md-nav__link> Installing package </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#linux-system-monitoring class=md-nav__link> Linux System Monitoring </a> <nav class=md-nav aria-label="Linux System Monitoring"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#sar class=md-nav__link> sar </a> </li> <li class=md-nav__item> <a href=#log-files class=md-nav__link> Log files </a> </li> <li class=md-nav__item> <a href=#stress-and-stress-ng class=md-nav__link> stress and stress-ng </a> </li> <li class=md-nav__item> <a href=#process-monitoring class=md-nav__link> Process Monitoring </a> <nav class=md-nav aria-label="Process Monitoring"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#ps class=md-nav__link> ps </a> </li> <li class=md-nav__item> <a href=#pstree class=md-nav__link> pstree </a> </li> <li class=md-nav__item> <a href=#top class=md-nav__link> top </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#memory-montioring class=md-nav__link> Memory Montioring </a> <nav class=md-nav aria-label="Memory Montioring"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#vmstat class=md-nav__link> vmstat </a> </li> <li class=md-nav__item> <a href=#oom class=md-nav__link> OOM </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#io-monitoring class=md-nav__link> IO Monitoring </a> <nav class=md-nav aria-label="IO Monitoring"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#iostat class=md-nav__link> iostat </a> </li> <li class=md-nav__item> <a href=#iotop class=md-nav__link> iotop </a> </li> <li class=md-nav__item> <a href=#ionice class=md-nav__link> ionice </a> </li> <li class=md-nav__item> <a href=#benchmarking class=md-nav__link> Benchmarking </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#io-scheduling class=md-nav__link> I/O Scheduling </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#filesystems-and-vfs class=md-nav__link> Filesystems and VFS </a> <nav class=md-nav aria-label="Filesystems and VFS"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#inodes class=md-nav__link> inodes </a> <nav class=md-nav aria-label=inodes> <ul class=md-nav__list> <li class=md-nav__item> <a href=#hardsoft-links class=md-nav__link> Hard/soft links </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#vfs class=md-nav__link> VFS </a> <nav class=md-nav aria-label=VFS> <ul class=md-nav__list> <li class=md-nav__item> <a href=#journaling-filesystems class=md-nav__link> Journaling Filesystems </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#disk-partitioning class=md-nav__link> Disk Partitioning </a> <nav class=md-nav aria-label="Disk Partitioning"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#common-disk-types class=md-nav__link> common disk types </a> </li> <li class=md-nav__item> <a href=#disk-drives class=md-nav__link> Disk drives </a> </li> <li class=md-nav__item> <a href=#partition-organization class=md-nav__link> Partition Organization </a> </li> <li class=md-nav__item> <a href=#mbr-parition-table class=md-nav__link> MBR Parition Table </a> </li> <li class=md-nav__item> <a href=#gpt-partition-table class=md-nav__link> GPT Partition table </a> </li> <li class=md-nav__item> <a href=#devices-nodes class=md-nav__link> Devices Nodes </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#filesystem-features class=md-nav__link> Filesystem Features </a> <nav class=md-nav aria-label="Filesystem Features"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#file-attributes class=md-nav__link> File Attributes </a> </li> <li class=md-nav__item> <a href=#mkfs class=md-nav__link> mkfs </a> </li> <li class=md-nav__item> <a href=#fsck class=md-nav__link> fsck </a> </li> <li class=md-nav__item> <a href=#etcfstab class=md-nav__link> /etc/fstab </a> </li> <li class=md-nav__item> <a href=#check-filesystem-usage class=md-nav__link> check filesystem usage </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#swap class=md-nav__link> swap </a> <nav class=md-nav aria-label=swap> <ul class=md-nav__list> <li class=md-nav__item> <a href=#quotas class=md-nav__link> Quotas </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#filesystem-types class=md-nav__link> filesystem types </a> <nav class=md-nav aria-label="filesystem types"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#ext4 class=md-nav__link> ext4 </a> </li> <li class=md-nav__item> <a href=#xfs class=md-nav__link> xfs </a> </li> <li class=md-nav__item> <a href=#btrfs class=md-nav__link> btrfs </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#disk-encryption class=md-nav__link> disk encryption </a> </li> <li class=md-nav__item> <a href=#lvm class=md-nav__link> LVM </a> <nav class=md-nav aria-label=LVM> <ul class=md-nav__list> <li class=md-nav__item> <a href=#volume-and-volume-groups class=md-nav__link> Volume and Volume Groups </a> </li> <li class=md-nav__item> <a href=#manipulate-lv class=md-nav__link> Manipulate LV </a> </li> <li class=md-nav__item> <a href=#lvm-snapshots class=md-nav__link> LVM Snapshots </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#raid class=md-nav__link> RAID </a> <nav class=md-nav aria-label=RAID> <ul class=md-nav__list> <li class=md-nav__item> <a href=#raid-levels class=md-nav__link> RAID Levels </a> </li> <li class=md-nav__item> <a href=#software-raid class=md-nav__link> Software RAID </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#kernel-services class=md-nav__link> Kernel Services </a> <nav class=md-nav aria-label="Kernel Services"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#kernel-command-line class=md-nav__link> Kernel Command Line </a> <nav class=md-nav aria-label="Kernel Command Line"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#sysctl class=md-nav__link> sysctl </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#kernel-modules class=md-nav__link> Kernel Modules </a> <nav class=md-nav aria-label="Kernel Modules"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#modprobe class=md-nav__link> modprobe </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#devices-and-udev class=md-nav__link> Devices and udev </a> <nav class=md-nav aria-label="Devices and udev"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#udev-rules class=md-nav__link> udev rules </a> </li> <li class=md-nav__item> <a href=#device-nodes class=md-nav__link> Device Nodes </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#virtualization class=md-nav__link> Virtualization </a> <nav class=md-nav aria-label=Virtualization> <ul class=md-nav__list> <li class=md-nav__item> <a href=#emulation class=md-nav__link> Emulation </a> </li> <li class=md-nav__item> <a href=#hypervisors class=md-nav__link> Hypervisors </a> </li> <li class=md-nav__item> <a href=#libvirt class=md-nav__link> libvirt </a> </li> <li class=md-nav__item> <a href=#kvm class=md-nav__link> KVM </a> </li> <li class=md-nav__item> <a href=#containers class=md-nav__link> Containers </a> <nav class=md-nav aria-label=Containers> <ul class=md-nav__list> <li class=md-nav__item> <a href=#docker class=md-nav__link> Docker </a> </li> <li class=md-nav__item> <a href=#podman class=md-nav__link> Podman </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#account-management class=md-nav__link> Account Management </a> <nav class=md-nav aria-label="Account Management"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#user-accounts class=md-nav__link> User Accounts </a> <nav class=md-nav aria-label="User Accounts"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#sudoers class=md-nav__link> Sudoers </a> </li> <li class=md-nav__item> <a href=#account-restriction class=md-nav__link> Account Restriction </a> </li> <li class=md-nav__item> <a href=#ssh class=md-nav__link> ssh </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#group-accounts class=md-nav__link> Group Accounts </a> <nav class=md-nav aria-label="Group Accounts"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#group-management class=md-nav__link> Group Management </a> </li> <li class=md-nav__item> <a href=#user-private-groups class=md-nav__link> User Private Groups </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#file-permissions-and-ownership class=md-nav__link> File permissions and Ownership </a> <nav class=md-nav aria-label="File permissions and Ownership"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#manage-permissions-and-ownership class=md-nav__link> Manage permissions and ownership </a> </li> <li class=md-nav__item> <a href=#umask class=md-nav__link> umask </a> </li> <li class=md-nav__item> <a href=#filesystem-acls class=md-nav__link> Filesystem ACLs </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#pluggable-authentication-modules-pam class=md-nav__link> Pluggable Authentication Modules (PAM) </a> <nav class=md-nav aria-label="Pluggable Authentication Modules (PAM)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#pam-rules class=md-nav__link> PAM Rules </a> </li> <li class=md-nav__item> <a href=#ldap-authentication class=md-nav__link> LDAP Authentication </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#network class=md-nav__link> Network </a> <nav class=md-nav aria-label=Network> <ul class=md-nav__list> <li class=md-nav__item> <a href=#network-addresses class=md-nav__link> Network Addresses </a> </li> <li class=md-nav__item> <a href=#ipv4-address-types class=md-nav__link> IPv4 Address Types </a> <nav class=md-nav aria-label="IPv4 Address Types"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#reserved-ipv4-addresses class=md-nav__link> Reserved IPv4 Addresses </a> </li> <li class=md-nav__item> <a href=#ipv4-address-classes class=md-nav__link> IPv4 Address Classes </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#ipv6-address-types class=md-nav__link> IPv6 Address Types </a> </li> <li class=md-nav__item> <a href=#netmasks class=md-nav__link> Netmasks </a> </li> <li class=md-nav__item> <a href=#hostname class=md-nav__link> hostname </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#network-devices-and-configs class=md-nav__link> Network Devices and Configs </a> <nav class=md-nav aria-label="Network Devices and Configs"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#network-devices class=md-nav__link> network devices </a> </li> <li class=md-nav__item> <a href=#ip class=md-nav__link> ip </a> </li> <li class=md-nav__item> <a href=#ifconfig class=md-nav__link> ifconfig </a> </li> <li class=md-nav__item> <a href=#pnidn class=md-nav__link> PNIDN </a> </li> <li class=md-nav__item> <a href=#nic-config-files class=md-nav__link> NIC Config Files </a> </li> <li class=md-nav__item> <a href=#network-manager class=md-nav__link> Network Manager </a> </li> <li class=md-nav__item> <a href=#routing class=md-nav__link> Routing </a> <nav class=md-nav aria-label=Routing> <ul class=md-nav__list> <li class=md-nav__item> <a href=#static-routes class=md-nav__link> Static Routes </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#name-resolution class=md-nav__link> Name Resolution </a> <nav class=md-nav aria-label="Name Resolution"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#etchosts class=md-nav__link> /etc/hosts </a> </li> <li class=md-nav__item> <a href=#dns class=md-nav__link> DNS </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#network-diagnostics class=md-nav__link> Network Diagnostics </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#firewall class=md-nav__link> Firewall </a> <nav class=md-nav aria-label=Firewall> <ul class=md-nav__list> <li class=md-nav__item> <a href=#firewall-configurations class=md-nav__link> Firewall Configurations </a> <nav class=md-nav aria-label="Firewall Configurations"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#firewalld class=md-nav__link> firewalld </a> </li> <li class=md-nav__item> <a href=#zones class=md-nav__link> zones </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#system-startup-and-shutdown class=md-nav__link> System Startup and Shutdown </a> <nav class=md-nav aria-label="System Startup and Shutdown"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#grub class=md-nav__link> GRUB </a> </li> <li class=md-nav__item> <a href=#configuration-files-in-etc class=md-nav__link> Configuration Files in /etc </a> <nav class=md-nav aria-label="Configuration Files in /etc"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#etcsysconfig class=md-nav__link> /etc/sysconfig </a> </li> <li class=md-nav__item> <a href=#etcdefault class=md-nav__link> /etc/default </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#shutdown class=md-nav__link> shutdown </a> </li> <li class=md-nav__item> <a href=#sbininit class=md-nav__link> /sbin/init </a> </li> <li class=md-nav__item> <a href=#systemd class=md-nav__link> systemd </a> <nav class=md-nav aria-label=systemd> <ul class=md-nav__list> <li class=md-nav__item> <a href=#systemctl class=md-nav__link> systemctl </a> </li> <li class=md-nav__item> <a href=#service-file class=md-nav__link> .service file </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#backup-and-recovery class=md-nav__link> Backup and Recovery </a> <nav class=md-nav aria-label="Backup and Recovery"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#backup-utilities class=md-nav__link> Backup utilities </a> <nav class=md-nav aria-label="Backup utilities"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#dd class=md-nav__link> dd </a> </li> <li class=md-nav__item> <a href=#rsync class=md-nav__link> rsync </a> </li> <li class=md-nav__item> <a href=#cpio class=md-nav__link> cpio </a> </li> <li class=md-nav__item> <a href=#backup-programs class=md-nav__link> Backup programs </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#linux-security-modules class=md-nav__link> Linux Security Modules </a> <nav class=md-nav aria-label="Linux Security Modules"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#selinux class=md-nav__link> SELinux </a> <nav class=md-nav aria-label=SELinux> <ul class=md-nav__list> <li class=md-nav__item> <a href=#getenforce-setenforce class=md-nav__link> getenforce, setenforce </a> </li> <li class=md-nav__item> <a href=#policies class=md-nav__link> Policies </a> </li> <li class=md-nav__item> <a href=#contexts class=md-nav__link> Contexts </a> </li> <li class=md-nav__item> <a href=#monitoring-access class=md-nav__link> Monitoring Access </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#apparmor class=md-nav__link> AppArmor </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#local-system-security class=md-nav__link> Local System Security </a> <nav class=md-nav aria-label="Local System Security"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#risk-analysis class=md-nav__link> Risk Analysis </a> </li> <li class=md-nav__item> <a href=#patch-system-updates class=md-nav__link> Patch system updates </a> </li> <li class=md-nav__item> <a href=#hardware-accessibility class=md-nav__link> Hardware Accessibility </a> </li> <li class=md-nav__item> <a href=#secure-mount-filesystem class=md-nav__link> Secure Mount Filesystem </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#troubleshooting class=md-nav__link> Troubleshooting </a> <nav class=md-nav aria-label=Troubleshooting> <ul class=md-nav__list> <li class=md-nav__item> <a href=#system-rescue class=md-nav__link> System Rescue </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../Linux_Foundation_Network_Admin/ class=md-nav__link> Linux Network Administration </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-3-2 type=checkbox id=nav-1-3-2> <label class=md-nav__link for=nav-1-3-2> Practical References <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Practical References" data-md-level=3> <label class=md-nav__title for=nav-1-3-2> <span class="md-nav__icon md-icon"></span> Practical References </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Commands/Freq-Used-Shell-Cmds/ class=md-nav__link> Freq Used Shell Cmds </a> </li> <li class=md-nav__item> <a href=../../Commands/Networking-Shell-Cmds/ class=md-nav__link> Freq Used Network Cmds </a> </li> <li class=md-nav__item> <a href=../../Commands/Text-Manipulating-Cmds/ class=md-nav__link> Text Manipulating Cmds </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-3-3 type=checkbox id=nav-1-3-3> <label class=md-nav__link for=nav-1-3-3> Tricks <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Tricks data-md-level=3> <label class=md-nav__title for=nav-1-3-3> <span class="md-nav__icon md-icon"></span> Tricks </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../References/Freq-Tasks/ class=md-nav__link> Freq Linux Tasks </a> </li> <li class=md-nav__item> <a href=../../References/Terminal-Tricks/ class=md-nav__link> Linux Terminal Tricks </a> </li> <li class=md-nav__item> <a href=../../References/Vim-Tricks/ class=md-nav__link> Vim Tricks </a> </li> <li class=md-nav__item> <a href=../../References/Account-Administration/ class=md-nav__link> Manage Accounts & Groups </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-4 type=checkbox id=nav-1-4> <label class=md-nav__link for=nav-1-4> Cloud <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Cloud data-md-level=2> <label class=md-nav__title for=nav-1-4> <span class="md-nav__icon md-icon"></span> Cloud </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Cloud-and-Containers/Architecture/Cloud-App-Architecture/ class=md-nav__link> Cloud App Architecture </a> </li> <li class=md-nav__item> <a href=../../../Cloud-and-Containers/Docker/Docker/ class=md-nav__link> Docker and Containers </a> </li> <li class=md-nav__item> <a href=../../../Cloud-and-Containers/Docker/Docker-Practical/ class=md-nav__link> Docker Practical </a> </li> <li class=md-nav__item> <a href=../../../Cloud-and-Containers/k8s/K8s-Knowledge/ class=md-nav__link> K8s Knowledge </a> </li> <li class=md-nav__item> <a href=../../../Cloud-and-Containers/k8s/service_mesh/ class=md-nav__link> Service Mesh </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-5 type=checkbox id=nav-1-5> <label class=md-nav__link for=nav-1-5> Monitoring <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Monitoring data-md-level=2> <label class=md-nav__title for=nav-1-5> <span class="md-nav__icon md-icon"></span> Monitoring </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-5-1 type=checkbox id=nav-1-5-1> <label class=md-nav__link for=nav-1-5-1> Splunk <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Splunk data-md-level=3> <label class=md-nav__title for=nav-1-5-1> <span class="md-nav__icon md-icon"></span> Splunk </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Dev-Tools-Reference/Splunk/Splunk-References/ class=md-nav__link> Splunk Knowledge </a> </li> <li class=md-nav__item> <a href=../../../Dev-Tools-Reference/Splunk/Splunk-Dashboarding/ class=md-nav__link> Splunk Dashboarding </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-6 type=checkbox id=nav-1-6> <label class=md-nav__link for=nav-1-6> Programming Langs <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Programming Langs" data-md-level=2> <label class=md-nav__title for=nav-1-6> <span class="md-nav__icon md-icon"></span> Programming Langs </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-6-1 type=checkbox id=nav-1-6-1> <label class=md-nav__link for=nav-1-6-1> Golang <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Golang data-md-level=3> <label class=md-nav__title for=nav-1-6-1> <span class="md-nav__icon md-icon"></span> Golang </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Programming-Lang-Reference/Golang/Golang-Specs/ class=md-nav__link> Golang Language Reference </a> </li> <li class=md-nav__item> <a href=../../../Programming-Lang-Reference/Golang/Best-Practices/ class=md-nav__link> Effective Go </a> </li> <li class=md-nav__item> <a href=../../../Programming-Lang-Reference/Golang/Freq-Used-Libs/ class=md-nav__link> Go libraries and examples </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-6-2 type=checkbox id=nav-1-6-2> <label class=md-nav__link for=nav-1-6-2> Java <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Java data-md-level=3> <label class=md-nav__title for=nav-1-6-2> <span class="md-nav__icon md-icon"></span> Java </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Programming-Lang-Reference/Java/Style-Guide/ class=md-nav__link> Style Guide </a> </li> <li class=md-nav__item> <a href=../../../Programming-Lang-Reference/Java/Best-Practices/ class=md-nav__link> Effective Java </a> </li> <li class=md-nav__item> <a href=../../../Programming-Lang-Reference/Java/Design-Patterns/ class=md-nav__link> Java Design Patterns </a> </li> <li class=md-nav__item> <a href=../../../Programming-Lang-Reference/Java/Testing-Design-Patterns/ class=md-nav__link> Testing Design Patterns </a> </li> <li class=md-nav__item> <a href=../../../Programming-Lang-Reference/Java/Java_Std_Lib_Cheatsheet/ class=md-nav__link> Java Std Lib Cheatsheet </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-6-3 type=checkbox id=nav-1-6-3> <label class=md-nav__link for=nav-1-6-3> C++ <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=C++ data-md-level=3> <label class=md-nav__title for=nav-1-6-3> <span class="md-nav__icon md-icon"></span> C++ </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Programming-Lang-Reference/CPP/CPlusPlus_Lang_Specs/ class=md-nav__link> C++ Language Reference </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-6-4 type=checkbox id=nav-1-6-4> <label class=md-nav__link for=nav-1-6-4> Perl <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Perl data-md-level=3> <label class=md-nav__title for=nav-1-6-4> <span class="md-nav__icon md-icon"></span> Perl </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Programming-Lang-Reference/Perl/Perl-Lang-Specs/ class=md-nav__link> Perl Language Reference </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-6-5 type=checkbox id=nav-1-6-5> <label class=md-nav__link for=nav-1-6-5> Shell <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Shell data-md-level=3> <label class=md-nav__title for=nav-1-6-5> <span class="md-nav__icon md-icon"></span> Shell </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Programming-Lang-Reference/Shell/Shell-Scripting/ class=md-nav__link> Shell Scripting </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../Programming-Lang-Reference/Github-Markdown/ class=md-nav__link> Github Markdown Guide </a> </li> <li class=md-nav__item> <a href=../../../Programming-Lang-Reference/Regex-Specs/ class=md-nav__link> Regex Cheatsheet </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-7 type=checkbox id=nav-1-7> <label class=md-nav__link for=nav-1-7> Reading Notes <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Reading Notes" data-md-level=2> <label class=md-nav__title for=nav-1-7> <span class="md-nav__icon md-icon"></span> Reading Notes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Reading-Notes/How-Netflix-Works/ class=md-nav__link> How Netflix Works </a> </li> <li class=md-nav__item> <a href=../../../Reading-Notes/System-Design-Concepts/ class=md-nav__link> System Design Guide </a> </li> <li class=md-nav__item> <a href=../../../Reading-Notes/Why-Latency-Matters/ class=md-nav__link> Why Latency Matters </a> </li> <li class=md-nav__item> <a href=../../../Reading-Notes/DevOps_SRE/ class=md-nav__link> Intro to DevOps and SRE </a> </li> <li class=md-nav__item> <a href=../../../Reading-Notes/Leading-without-formal-authority/ class=md-nav__link> Leading Without Formal Authority </a> </li> <li class=md-nav__item> <a href=../../../Reading-Notes/Google-SRE-Book/ class=md-nav__link> Google SRE Book </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../Good-Reads/ class=md-nav__link> Good Reads </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#linux-filesystem-tree-layout class=md-nav__link> Linux Filesystem Tree Layout </a> <nav class=md-nav aria-label="Linux Filesystem Tree Layout"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#bin class=md-nav__link> /bin </a> </li> <li class=md-nav__item> <a href=#boot class=md-nav__link> /boot </a> </li> <li class=md-nav__item> <a href=#dev class=md-nav__link> /dev </a> </li> <li class=md-nav__item> <a href=#etc class=md-nav__link> /etc </a> </li> <li class=md-nav__item> <a href=#opt class=md-nav__link> /opt </a> </li> <li class=md-nav__item> <a href=#proc class=md-nav__link> /proc </a> </li> <li class=md-nav__item> <a href=#sys class=md-nav__link> /sys </a> </li> <li class=md-nav__item> <a href=#sbin class=md-nav__link> /sbin </a> </li> <li class=md-nav__item> <a href=#usr class=md-nav__link> /usr </a> </li> <li class=md-nav__item> <a href=#var class=md-nav__link> /var </a> </li> <li class=md-nav__item> <a href=#run class=md-nav__link> /run </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#processes class=md-nav__link> Processes </a> <nav class=md-nav aria-label=Processes> <ul class=md-nav__list> <li class=md-nav__item> <a href=#definition class=md-nav__link> Definition </a> </li> <li class=md-nav__item> <a href=#process-attributes class=md-nav__link> Process Attributes </a> <nav class=md-nav aria-label="Process Attributes"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#control-process-with-ulimit class=md-nav__link> Control process with ulimit </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#creating-processes class=md-nav__link> Creating Processes </a> </li> <li class=md-nav__item> <a href=#process-states class=md-nav__link> Process States </a> </li> <li class=md-nav__item> <a href=#execution-modes class=md-nav__link> Execution Modes </a> <nav class=md-nav aria-label="Execution Modes"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#user-mode class=md-nav__link> User Mode </a> </li> <li class=md-nav__item> <a href=#system-kernel-mode class=md-nav__link> System (Kernel) Mode </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#daemons class=md-nav__link> Daemons </a> </li> <li class=md-nav__item> <a href=#nice-value-set-priorities class=md-nav__link> nice value set priorities </a> </li> <li class=md-nav__item> <a href=#static-and-shared-libraries class=md-nav__link> Static and Shared Libraries </a> </li> <li class=md-nav__item> <a href=#signals class=md-nav__link> Signals </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#package-management-systems class=md-nav__link> Package Management Systems </a> <nav class=md-nav aria-label="Package Management Systems"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#package-types class=md-nav__link> Package Types </a> </li> <li class=md-nav__item> <a href=#packaing-tool-levels class=md-nav__link> Packaing Tool Levels </a> </li> <li class=md-nav__item> <a href=#package-sources class=md-nav__link> Package Sources </a> </li> <li class=md-nav__item> <a href=#source-control-management-system class=md-nav__link> Source control Management System </a> <nav class=md-nav aria-label="Source control Management System"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#git class=md-nav__link> Git </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#rpm class=md-nav__link> RPM </a> <nav class=md-nav aria-label=RPM> <ul class=md-nav__list> <li class=md-nav__item> <a href=#queries class=md-nav__link> Queries </a> </li> <li class=md-nav__item> <a href=#verifying-packages class=md-nav__link> Verifying Packages </a> </li> <li class=md-nav__item> <a href=#installing-package class=md-nav__link> Installing package </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#dpkg class=md-nav__link> DPKG </a> <nav class=md-nav aria-label=DPKG> <ul class=md-nav__list> <li class=md-nav__item> <a href=#queries_1 class=md-nav__link> Queries </a> </li> <li class=md-nav__item> <a href=#installing-package_1 class=md-nav__link> Installing package </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#dnf-and-yum class=md-nav__link> DNF and YUM </a> <nav class=md-nav aria-label="DNF and YUM"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#queries_2 class=md-nav__link> Queries </a> </li> <li class=md-nav__item> <a href=#installing-package_2 class=md-nav__link> Installing package </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#apt class=md-nav__link> APT </a> <nav class=md-nav aria-label=APT> <ul class=md-nav__list> <li class=md-nav__item> <a href=#queries_3 class=md-nav__link> Queries </a> </li> <li class=md-nav__item> <a href=#installing-package_3 class=md-nav__link> Installing package </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#linux-system-monitoring class=md-nav__link> Linux System Monitoring </a> <nav class=md-nav aria-label="Linux System Monitoring"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#sar class=md-nav__link> sar </a> </li> <li class=md-nav__item> <a href=#log-files class=md-nav__link> Log files </a> </li> <li class=md-nav__item> <a href=#stress-and-stress-ng class=md-nav__link> stress and stress-ng </a> </li> <li class=md-nav__item> <a href=#process-monitoring class=md-nav__link> Process Monitoring </a> <nav class=md-nav aria-label="Process Monitoring"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#ps class=md-nav__link> ps </a> </li> <li class=md-nav__item> <a href=#pstree class=md-nav__link> pstree </a> </li> <li class=md-nav__item> <a href=#top class=md-nav__link> top </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#memory-montioring class=md-nav__link> Memory Montioring </a> <nav class=md-nav aria-label="Memory Montioring"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#vmstat class=md-nav__link> vmstat </a> </li> <li class=md-nav__item> <a href=#oom class=md-nav__link> OOM </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#io-monitoring class=md-nav__link> IO Monitoring </a> <nav class=md-nav aria-label="IO Monitoring"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#iostat class=md-nav__link> iostat </a> </li> <li class=md-nav__item> <a href=#iotop class=md-nav__link> iotop </a> </li> <li class=md-nav__item> <a href=#ionice class=md-nav__link> ionice </a> </li> <li class=md-nav__item> <a href=#benchmarking class=md-nav__link> Benchmarking </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#io-scheduling class=md-nav__link> I/O Scheduling </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#filesystems-and-vfs class=md-nav__link> Filesystems and VFS </a> <nav class=md-nav aria-label="Filesystems and VFS"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#inodes class=md-nav__link> inodes </a> <nav class=md-nav aria-label=inodes> <ul class=md-nav__list> <li class=md-nav__item> <a href=#hardsoft-links class=md-nav__link> Hard/soft links </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#vfs class=md-nav__link> VFS </a> <nav class=md-nav aria-label=VFS> <ul class=md-nav__list> <li class=md-nav__item> <a href=#journaling-filesystems class=md-nav__link> Journaling Filesystems </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#disk-partitioning class=md-nav__link> Disk Partitioning </a> <nav class=md-nav aria-label="Disk Partitioning"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#common-disk-types class=md-nav__link> common disk types </a> </li> <li class=md-nav__item> <a href=#disk-drives class=md-nav__link> Disk drives </a> </li> <li class=md-nav__item> <a href=#partition-organization class=md-nav__link> Partition Organization </a> </li> <li class=md-nav__item> <a href=#mbr-parition-table class=md-nav__link> MBR Parition Table </a> </li> <li class=md-nav__item> <a href=#gpt-partition-table class=md-nav__link> GPT Partition table </a> </li> <li class=md-nav__item> <a href=#devices-nodes class=md-nav__link> Devices Nodes </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#filesystem-features class=md-nav__link> Filesystem Features </a> <nav class=md-nav aria-label="Filesystem Features"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#file-attributes class=md-nav__link> File Attributes </a> </li> <li class=md-nav__item> <a href=#mkfs class=md-nav__link> mkfs </a> </li> <li class=md-nav__item> <a href=#fsck class=md-nav__link> fsck </a> </li> <li class=md-nav__item> <a href=#etcfstab class=md-nav__link> /etc/fstab </a> </li> <li class=md-nav__item> <a href=#check-filesystem-usage class=md-nav__link> check filesystem usage </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#swap class=md-nav__link> swap </a> <nav class=md-nav aria-label=swap> <ul class=md-nav__list> <li class=md-nav__item> <a href=#quotas class=md-nav__link> Quotas </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#filesystem-types class=md-nav__link> filesystem types </a> <nav class=md-nav aria-label="filesystem types"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#ext4 class=md-nav__link> ext4 </a> </li> <li class=md-nav__item> <a href=#xfs class=md-nav__link> xfs </a> </li> <li class=md-nav__item> <a href=#btrfs class=md-nav__link> btrfs </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#disk-encryption class=md-nav__link> disk encryption </a> </li> <li class=md-nav__item> <a href=#lvm class=md-nav__link> LVM </a> <nav class=md-nav aria-label=LVM> <ul class=md-nav__list> <li class=md-nav__item> <a href=#volume-and-volume-groups class=md-nav__link> Volume and Volume Groups </a> </li> <li class=md-nav__item> <a href=#manipulate-lv class=md-nav__link> Manipulate LV </a> </li> <li class=md-nav__item> <a href=#lvm-snapshots class=md-nav__link> LVM Snapshots </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#raid class=md-nav__link> RAID </a> <nav class=md-nav aria-label=RAID> <ul class=md-nav__list> <li class=md-nav__item> <a href=#raid-levels class=md-nav__link> RAID Levels </a> </li> <li class=md-nav__item> <a href=#software-raid class=md-nav__link> Software RAID </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#kernel-services class=md-nav__link> Kernel Services </a> <nav class=md-nav aria-label="Kernel Services"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#kernel-command-line class=md-nav__link> Kernel Command Line </a> <nav class=md-nav aria-label="Kernel Command Line"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#sysctl class=md-nav__link> sysctl </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#kernel-modules class=md-nav__link> Kernel Modules </a> <nav class=md-nav aria-label="Kernel Modules"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#modprobe class=md-nav__link> modprobe </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#devices-and-udev class=md-nav__link> Devices and udev </a> <nav class=md-nav aria-label="Devices and udev"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#udev-rules class=md-nav__link> udev rules </a> </li> <li class=md-nav__item> <a href=#device-nodes class=md-nav__link> Device Nodes </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#virtualization class=md-nav__link> Virtualization </a> <nav class=md-nav aria-label=Virtualization> <ul class=md-nav__list> <li class=md-nav__item> <a href=#emulation class=md-nav__link> Emulation </a> </li> <li class=md-nav__item> <a href=#hypervisors class=md-nav__link> Hypervisors </a> </li> <li class=md-nav__item> <a href=#libvirt class=md-nav__link> libvirt </a> </li> <li class=md-nav__item> <a href=#kvm class=md-nav__link> KVM </a> </li> <li class=md-nav__item> <a href=#containers class=md-nav__link> Containers </a> <nav class=md-nav aria-label=Containers> <ul class=md-nav__list> <li class=md-nav__item> <a href=#docker class=md-nav__link> Docker </a> </li> <li class=md-nav__item> <a href=#podman class=md-nav__link> Podman </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#account-management class=md-nav__link> Account Management </a> <nav class=md-nav aria-label="Account Management"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#user-accounts class=md-nav__link> User Accounts </a> <nav class=md-nav aria-label="User Accounts"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#sudoers class=md-nav__link> Sudoers </a> </li> <li class=md-nav__item> <a href=#account-restriction class=md-nav__link> Account Restriction </a> </li> <li class=md-nav__item> <a href=#ssh class=md-nav__link> ssh </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#group-accounts class=md-nav__link> Group Accounts </a> <nav class=md-nav aria-label="Group Accounts"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#group-management class=md-nav__link> Group Management </a> </li> <li class=md-nav__item> <a href=#user-private-groups class=md-nav__link> User Private Groups </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#file-permissions-and-ownership class=md-nav__link> File permissions and Ownership </a> <nav class=md-nav aria-label="File permissions and Ownership"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#manage-permissions-and-ownership class=md-nav__link> Manage permissions and ownership </a> </li> <li class=md-nav__item> <a href=#umask class=md-nav__link> umask </a> </li> <li class=md-nav__item> <a href=#filesystem-acls class=md-nav__link> Filesystem ACLs </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#pluggable-authentication-modules-pam class=md-nav__link> Pluggable Authentication Modules (PAM) </a> <nav class=md-nav aria-label="Pluggable Authentication Modules (PAM)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#pam-rules class=md-nav__link> PAM Rules </a> </li> <li class=md-nav__item> <a href=#ldap-authentication class=md-nav__link> LDAP Authentication </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#network class=md-nav__link> Network </a> <nav class=md-nav aria-label=Network> <ul class=md-nav__list> <li class=md-nav__item> <a href=#network-addresses class=md-nav__link> Network Addresses </a> </li> <li class=md-nav__item> <a href=#ipv4-address-types class=md-nav__link> IPv4 Address Types </a> <nav class=md-nav aria-label="IPv4 Address Types"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#reserved-ipv4-addresses class=md-nav__link> Reserved IPv4 Addresses </a> </li> <li class=md-nav__item> <a href=#ipv4-address-classes class=md-nav__link> IPv4 Address Classes </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#ipv6-address-types class=md-nav__link> IPv6 Address Types </a> </li> <li class=md-nav__item> <a href=#netmasks class=md-nav__link> Netmasks </a> </li> <li class=md-nav__item> <a href=#hostname class=md-nav__link> hostname </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#network-devices-and-configs class=md-nav__link> Network Devices and Configs </a> <nav class=md-nav aria-label="Network Devices and Configs"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#network-devices class=md-nav__link> network devices </a> </li> <li class=md-nav__item> <a href=#ip class=md-nav__link> ip </a> </li> <li class=md-nav__item> <a href=#ifconfig class=md-nav__link> ifconfig </a> </li> <li class=md-nav__item> <a href=#pnidn class=md-nav__link> PNIDN </a> </li> <li class=md-nav__item> <a href=#nic-config-files class=md-nav__link> NIC Config Files </a> </li> <li class=md-nav__item> <a href=#network-manager class=md-nav__link> Network Manager </a> </li> <li class=md-nav__item> <a href=#routing class=md-nav__link> Routing </a> <nav class=md-nav aria-label=Routing> <ul class=md-nav__list> <li class=md-nav__item> <a href=#static-routes class=md-nav__link> Static Routes </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#name-resolution class=md-nav__link> Name Resolution </a> <nav class=md-nav aria-label="Name Resolution"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#etchosts class=md-nav__link> /etc/hosts </a> </li> <li class=md-nav__item> <a href=#dns class=md-nav__link> DNS </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#network-diagnostics class=md-nav__link> Network Diagnostics </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#firewall class=md-nav__link> Firewall </a> <nav class=md-nav aria-label=Firewall> <ul class=md-nav__list> <li class=md-nav__item> <a href=#firewall-configurations class=md-nav__link> Firewall Configurations </a> <nav class=md-nav aria-label="Firewall Configurations"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#firewalld class=md-nav__link> firewalld </a> </li> <li class=md-nav__item> <a href=#zones class=md-nav__link> zones </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#system-startup-and-shutdown class=md-nav__link> System Startup and Shutdown </a> <nav class=md-nav aria-label="System Startup and Shutdown"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#grub class=md-nav__link> GRUB </a> </li> <li class=md-nav__item> <a href=#configuration-files-in-etc class=md-nav__link> Configuration Files in /etc </a> <nav class=md-nav aria-label="Configuration Files in /etc"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#etcsysconfig class=md-nav__link> /etc/sysconfig </a> </li> <li class=md-nav__item> <a href=#etcdefault class=md-nav__link> /etc/default </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#shutdown class=md-nav__link> shutdown </a> </li> <li class=md-nav__item> <a href=#sbininit class=md-nav__link> /sbin/init </a> </li> <li class=md-nav__item> <a href=#systemd class=md-nav__link> systemd </a> <nav class=md-nav aria-label=systemd> <ul class=md-nav__list> <li class=md-nav__item> <a href=#systemctl class=md-nav__link> systemctl </a> </li> <li class=md-nav__item> <a href=#service-file class=md-nav__link> .service file </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#backup-and-recovery class=md-nav__link> Backup and Recovery </a> <nav class=md-nav aria-label="Backup and Recovery"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#backup-utilities class=md-nav__link> Backup utilities </a> <nav class=md-nav aria-label="Backup utilities"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#dd class=md-nav__link> dd </a> </li> <li class=md-nav__item> <a href=#rsync class=md-nav__link> rsync </a> </li> <li class=md-nav__item> <a href=#cpio class=md-nav__link> cpio </a> </li> <li class=md-nav__item> <a href=#backup-programs class=md-nav__link> Backup programs </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#linux-security-modules class=md-nav__link> Linux Security Modules </a> <nav class=md-nav aria-label="Linux Security Modules"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#selinux class=md-nav__link> SELinux </a> <nav class=md-nav aria-label=SELinux> <ul class=md-nav__list> <li class=md-nav__item> <a href=#getenforce-setenforce class=md-nav__link> getenforce, setenforce </a> </li> <li class=md-nav__item> <a href=#policies class=md-nav__link> Policies </a> </li> <li class=md-nav__item> <a href=#contexts class=md-nav__link> Contexts </a> </li> <li class=md-nav__item> <a href=#monitoring-access class=md-nav__link> Monitoring Access </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#apparmor class=md-nav__link> AppArmor </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#local-system-security class=md-nav__link> Local System Security </a> <nav class=md-nav aria-label="Local System Security"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#risk-analysis class=md-nav__link> Risk Analysis </a> </li> <li class=md-nav__item> <a href=#patch-system-updates class=md-nav__link> Patch system updates </a> </li> <li class=md-nav__item> <a href=#hardware-accessibility class=md-nav__link> Hardware Accessibility </a> </li> <li class=md-nav__item> <a href=#secure-mount-filesystem class=md-nav__link> Secure Mount Filesystem </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#troubleshooting class=md-nav__link> Troubleshooting </a> <nav class=md-nav aria-label=Troubleshooting> <ul class=md-nav__list> <li class=md-nav__item> <a href=#system-rescue class=md-nav__link> System Rescue </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <h1>Linux System Administration</h1> <p>This set of notes were taken from the Linux Foundation Course: <a href=https://training.linuxfoundation.org/training/essentials-of-linux-system-administration/ target=_blank>Essentials of Linux System Administration (LFS201)</a>.</p> <h2 id=linux-filesystem-tree-layout>Linux Filesystem Tree Layout<a class=headerlink href=#linux-filesystem-tree-layout title="Permanent link">&para;</a></h2> <p>Linux's One Big Filesystem - diagrammed as an inverted tree with root directory <code>/</code> at top of tree. The large logical filesystem may have many distinct filesystems mounted at various points appear as subdirectories.</p> <p>Data Distinctions</p> <ul> <li>Sharable - data can be shared between hosts</li> <li>Non-sharable - data that must be specific to a particular host</li> <li>Static - data such as binaries, libraries, documentation, that does not change without system admin's actions</li> <li>Variable - data that change without a system admin's help</li> </ul> <p>The Filesystem Hierarchy Standard (FHS) document specifies the main directories that need to be present on a Linux host.</p> <h3 id=bin>/bin<a class=headerlink href=#bin title="Permanent link">&para;</a></h3> <p>Contains executable programs and scripts needed by both system administrators and unprivileged users, which are required when no other filesystems have yet been mounted (single user or recovery mode).</p> <p>Required programs which must exist in <code>/bin/</code> include:</p> <div class=highlight><pre><span></span><code>cat, chgrp, chmod, chown, cp, date, dd, df, dmesg, echo, false, hostname, kill, ln, login, ls, mkdir, mknod, more, mount, mv, ps, pwd, rm, rmdir, sed, sh, stty, su, sync, true, umount and uname
</code></pre></div> <h3 id=boot>/boot<a class=headerlink href=#boot title="Permanent link">&para;</a></h3> <p>Essential files for booting the system. Stores data used before the kernel begins executing user-mode programs</p> <ul> <li>vmlinz - the compressed Linux kernel</li> <li>initramfs or initrd - initial RAM filesystem, mounted before the real root fs is available</li> <li>config - configure the kernel compilation</li> <li>System.map - Kernel symbol table, used for debugging</li> </ul> <h3 id=dev>/dev<a class=headerlink href=#dev title="Permanent link">&para;</a></h3> <p>Contains special device files (also known as device nodes) which represent devices built into or connected to the system. Such device files represent character (byte-stream) and block I/O devices.</p> <p>Network devices do not have device nodes in Linux, and are instead referenced by name, such as eth1 or wlan0.</p> <p>All modern Linux distributions use the udev system, which creates nodes in <code>/dev</code> only as needed when devices are found. On ancient systems (or embedded devices, it can be created by MAKEDEV or mknod at install or at any other time, as needed.</p> <h3 id=etc>/etc<a class=headerlink href=#etc title="Permanent link">&para;</a></h3> <p>Contains machine-local configuration files and some startup scripts.</p> <p>Files and directories which may be found in this directory include:</p> <div class=highlight><pre><span></span><code>csh.login, exports, fstab, ftpusers, gateways, gettydefs, group, host.conf, hosts.allow, hosts.deny, hosts,equiv, hosts.lpd, inetd.conf, inittab, issue, ld.so.conf, motd, mtab, mtools.conf, networks, passwd, printcap, profile, protocols, resolv.conf, rpc, securetty, services, shells, syslog.conf
</code></pre></div> <ul> <li><code>/etc/skel</code> - Contains skeleton files used to populate newly created home directories.</li> <li><code>/etc/systemd</code> - Contains or points to configuration scripts for starting, stopping system services when using systemd.</li> <li><code>/etc/init.d</code> - Contains startup and shut down scripts when using System V initialization.</li> <li><code>/etc/default/</code> - Contains configurations for many default actions, like cron, useradd</li> </ul> <h3 id=opt>/opt<a class=headerlink href=#opt title="Permanent link">&para;</a></h3> <p>This directory is designed for software packages that wish to keep all or most of their files in one isolated place, rather than scatter them all over the system in directories shared by other software.</p> <p>For example, if dolphy_app were the name of a package which resided under /opt, then all of its files should reside in directories under /opt/dolphy_app, including /opt/dolphy_app/bin for binaries and /opt/dolphy_app/man for any man pages.</p> <p>This can make both installing and uninstalling software relatively easy, as everything is in one convenient isolated location in a predictable and structured manner.</p> <p>The directories <code>/opt/bin, /opt/doc, /opt/include, /opt/info, /opt/lib, and /opt/man</code> are reserved for local system administrator use. Packages may provide files which are linked or copied to these reserved directories, but the packages must also be able to function without the programs being in these special directories. Most systems do not populate these directories.</p> <h3 id=proc>/proc<a class=headerlink href=#proc title="Permanent link">&para;</a></h3> <p>Mount point for a pseudo-filesystem, where all information resides only in memory. The kernel exposes some important data structures through /proc entries</p> <p>Important pseudo-files, including <code>/proc/interrupts, /proc/meminfo, /proc/mounts, and /proc/partitions</code>, provide an up-to-the-moment glimpse of the system's hardware.</p> <p>Others, like <code>/proc/filesystems</code> and the <code>/proc/sys/</code> directory, provide system configuration information and interfaces. The process directories contain information about each running process on the system.</p> <h3 id=sys>/sys<a class=headerlink href=#sys title="Permanent link">&para;</a></h3> <p>Mount point for the sysfs pseudo-filesystem where all information resides only in memory. It contains information about devices and drivers, kernel modules, system configuration structures, etc.</p> <p>sysfs is used both to gather information about the system, and modify its behavior while running. Almost all pseudo-files in /sys contain only one line, or value.</p> <h3 id=sbin>/sbin<a class=headerlink href=#sbin title="Permanent link">&para;</a></h3> <p>Contains binaries essential for booting, restoring, recovering, and/or repairing in addition to those binaries in the <code>/bin</code> directory.</p> <p>The following programs should be included in this directory (if their subsystems are installed):</p> <div class=highlight><pre><span></span><code>fdisk, fsck, getty, halt, ifconfig, init, mkfs, mkswap, reboot, route, swapon, swapoff, update
</code></pre></div> <h3 id=usr>/usr<a class=headerlink href=#usr title="Permanent link">&para;</a></h3> <p>Can be thought of as a secondary hierarchy used for files which are not needed for system booting.</p> <p>This directory is typically read-only data. It contains binaries which are not needed in single user mode.</p> <h3 id=var>/var<a class=headerlink href=#var title="Permanent link">&para;</a></h3> <p>Contains variable (or volatile) data files that change frequently during system operation. These include:</p> <ul> <li>Log files</li> <li>Spool directories and files</li> <li>Administrative data files</li> <li>Transient and temporary files, such as cache contents.</li> </ul> <p>For security reasons, it is often considered a good idea to mount /var as a separate filesystem. Furthermore, if the directory gets filled up, it should not lock up the system.</p> <h3 id=run>/run<a class=headerlink href=#run title="Permanent link">&para;</a></h3> <p>The purpose of <code>/run</code> is to store transient files: those that contain runtime information, which may need to be written early in system startup, and which do not need to be preserved when rebooting.</p> <p>Generally, <code>/run</code> is implemented as an empty mount point, with a tmpfs ram disk (like <code>/dev/shm</code>) mounted there at runtime. Thus, this is a pseudo-filesystem existing only in memory.</p> <p>Some existing locations, such as <code>/var/run</code> and <code>/var/lock</code>, will be now just symbolic links to directories under /run.</p> <h2 id=processes>Processes<a class=headerlink href=#processes title="Permanent link">&para;</a></h2> <h3 id=definition>Definition<a class=headerlink href=#definition title="Permanent link">&para;</a></h3> <p>A program is a set of instructions, along with any internal or external data used while carrying the instructions out.</p> <p>People often distinguish between programs, which are compiled into a binary executable form; and scripts, which need to be run by an interpreter such as bash, Python or Perl.</p> <p>A process is an instance of a program in execution. Every process has a <strong>pid</strong> (Process ID), a <strong>ppid</strong> (Parent Process ID), and a <strong>pgid</strong> (Process Group ID). Every process has program code, data, variables, file descriptors, and an environment.</p> <p>For historical reasons, the largest PID has been limited to a 16-bit number, or <strong>32768</strong>. It is possible to alter this value by changing <code>/proc/sys/kernel/pid_max</code>. Eventually when process id reaches the max, it will start again at <code>PID = 300</code>.</p> <p>A program may be composed of multiple simultaneous threads (multithreading), each of which is considered as its own process.</p> <h3 id=process-attributes>Process Attributes<a class=headerlink href=#process-attributes title="Permanent link">&para;</a></h3> <p>At any given moment, the process may take a snapshot of itself by trapping the state of its CPU registers, where it is executing in the program, what is in the process' memory, and other information. This is the context (state) of the process, which is critical to the kernel's ability to do <strong>context switching</strong>.</p> <p>Every process has permissions based on which user has called it to execute. It may also have permissions based on who owns its program file.</p> <p>Programs which are marked with an "s" execute bit have a different "effective" user id than their "real" user id. These programs are referred to as <strong>setuid programs</strong>. They run with the user-id of the user who <strong>owns</strong> the program, where a non-setuid program runs with the permissions of the user who <strong>starts</strong> it.</p> <p>Note that <strong>setuid programs owned by root can be a security problem</strong>. Also Note that setuid bit only works on <strong>binary executables</strong>, not on scripts, as a security measure.</p> <p>Every process has resources such as allocated memory, file handles, etc. When a process is started, it is isolated in its own user space to protect it from other processes.</p> <p>Processes do not have direct access to hardware. Hardware is managed by the kernel, so a process must use system calls to indirectly access hardware. System calls are the fundamental interface between an application and the kernel.</p> <h4 id=control-process-with-ulimit>Control process with ulimit<a class=headerlink href=#control-process-with-ulimit title="Permanent link">&para;</a></h4> <p><code>ulimit</code> is a built-in bash command that displays or resets a number of <strong>resource limits</strong> associated with processes running under a shell. The changes only affect the <strong>current shell</strong>. To make changes that are effective for all logged-in users, you need to modify <code>/etc/security/limits.conf</code></p> <p>A system administrator may need to change some of these values in either direction:</p> <ul> <li>To restrict capabilities so an individual user and/or process cannot exhaust system resources, such as memory, cpu time or the maximum number of processes on the system.</li> <li>To expand capabilities so a process does not run into resource limits; for example, a server handling many clients may find that the default of 1024 open files makes its work impossible to perform.</li> </ul> <h3 id=creating-processes>Creating Processes<a class=headerlink href=#creating-processes title="Permanent link">&para;</a></h3> <p>An average Linux system is always creating new processes. This is often called <strong>forking</strong>; the original parent process <strong>keeps running</strong>, while the new child process starts.</p> <p>Often, rather than just a fork, one follows it with an <strong>exec</strong>, where the parent process terminates, and the child process <strong>inherits the process ID of the parent</strong>.</p> <p>Take sshd daemon as an example: it is started when the init process executes the sshd init script, then the daemon process listens for ssh requests from remote users.When a request is received, sshd creates a new copy of itself to service the request. Each remote user gets their own copy of the sshd daemon running to service their remote login. The sshd process will start the login program to validate the remote user. If the authentication succeeds, the login process will fork off a shell (say bash) to interpret the user commands, and so on.</p> <p>systemd-based systems run a special process named kthreadd with pid=2 whose job is to <strong>adopt orphaned children</strong>, who will then show ppid=2.</p> <p>What happens when a user executes a command in a command shell interpreter, such as bash?</p> <ul> <li>A new process is created (forked from the user's login shell).</li> <li>A wait system call puts the parent shell process to sleep.</li> <li>The command is loaded onto the child process's space via the exec system call. In other words, the code for the command replaces the bash program in the child process's memory space.</li> <li>The command completes executing, and the child process dies via the exit system call.</li> <li>The parent shell is re-awakened by the death of the child process and proceeds to issue a new shell prompt.</li> <li>The parent shell then waits for the next command request from the user, at which time the cycle will be repeated.</li> </ul> <p>If a command is issued for <strong>background</strong> processing (by adding an ampersand <code>&amp;</code> at the end of the command line), the parent shell skips the wait request and is free to issue a new shell prompt immediately, allowing the background process to execute in <strong>parallel</strong>. Otherwise, for foreground requests, the shell waits until the child process has completed or is stopped via a signal.</p> <p>Use <code>jobs -l</code> to view background processes. Use <code>kill -15 %&lt;job_number&gt;</code> to send a SIG_TERM to that process. Use <code>fg %&lt;job_number</code> to bring a background process to the foreground. Use <code>bg %&lt;job_number&gt;</code> after <code>CTRL+Z</code> to resume a stopped process. </p> <p>Some shell commands (such as echo and kill) are built into the shell itself, and do not involve loading of program files. For these commands, neither a fork nor an exec is issued for the execution.</p> <h3 id=process-states>Process States<a class=headerlink href=#process-states title="Permanent link">&para;</a></h3> <p>Processes can be in one of several possible states. The scheduler manages all of the processes. The process state is reported by the process listing.</p> <ul> <li>Running - process is executing on a CPU or sitting in the run queue waiting for a new time slice</li> <li>Sleeping / Waiting - process is waiting on a request (usually I/O)</li> <li>Stopped - process has been suspended, commonly when the program's memory, CPU registers, or other attributes are being examined, after which can be resumed.</li> <li>Zombie / Defunct- process terminates and no other process or parent process requests for its exit state.<ul> <li>if the parent of a process dies, it is adopted by init (PID=1) or kthreadd (PID=2)</li> </ul> </li> </ul> <h3 id=execution-modes>Execution Modes<a class=headerlink href=#execution-modes title="Permanent link">&para;</a></h3> <p>A process may be executing in either user mode or system mode (kernel mode). What instructions can be executed depends on the mode and is enforced at the hardware, not software, level.</p> <p>The mode is not a state of the system; it is a state of the processor, as in a multi-core or multi-CPU system each unit can be in its own individual state.</p> <h4 id=user-mode>User Mode<a class=headerlink href=#user-mode title="Permanent link">&para;</a></h4> <p>Each process executing in user mode has its <strong>own memory space</strong>, parts of which may be shared with other processes; except for the shared memory segments, a user process is not able to read or write into or from the memory space of any other process.</p> <p>Even a process run by the root user or as a setuid program runs in user mode, except when jumping into a system call, and has only limited ability to access hardware.</p> <h4 id=system-kernel-mode>System (Kernel) Mode<a class=headerlink href=#system-kernel-mode title="Permanent link">&para;</a></h4> <p>CPU has full access to <strong>all hardware on the system</strong>, including peripherals, memory, disks, etc. If an application needs access to these resources, it must issue a system call, which causes a context switch from user mode to kernel mode. This procedure must be followed when reading and writing from files, creating a new process, etc.</p> <p>Application code never runs in kernel mode, only the system call itself which is kernel code. When the system call is complete, a return value is produced and the process returns to user mode with the inverse context switch.</p> <h3 id=daemons>Daemons<a class=headerlink href=#daemons title="Permanent link">&para;</a></h3> <p>A daemon process is a background process whose sole purpose is to provide some specific service to users of the system.</p> <ul> <li>They can be quite efficient because they only operate when needed.</li> <li>Many daemons are started at boot time.</li> <li>Daemon names often (but not always) end with d, e.g. httpd and systemd-udevd.</li> <li>Daemons may respond to external events (systemd-udevd) or elapsed time (crond).</li> <li>Daemons generally have no controlling terminal and no standard input/output - devices.</li> <li>Daemons sometimes provide better security control.</li> <li>Some examples include xinetd, httpd, lpd, and vsftpd.</li> </ul> <h3 id=nice-value-set-priorities>nice value set priorities<a class=headerlink href=#nice-value-set-priorities title="Permanent link">&para;</a></h3> <p>Process priority can be controlled through the <code>nice</code> and <code>renice</code> commands. <code>renice</code> is used to raise or lower the nice value of an already running process. Since the early days of UNIX, the idea has been that a nice process lowers its priority to yield to others. Thus, the higher the niceness is, the lower the priority.</p> <p>The niceness value can range from -20 (the highest priority) to +19 (the lowest priority).</p> <p>Note that increasing the niceness of a process does not mean it won't run; it may even get all the CPU time if there is nothing else with which to compete.</p> <p>By default, only a superuser can decrease the niceness. After a non-privileged user has increased the nice value, only a superuser can lower it back. It is possible to give normal users the ability to decrease their niceness within a predetermined range, by editing <code>/etc/security/limits.conf</code>.</p> <h3 id=static-and-shared-libraries>Static and Shared Libraries<a class=headerlink href=#static-and-shared-libraries title="Permanent link">&para;</a></h3> <p><strong>static library</strong> - The code for the library functions is inserted in the program at compile time, and does not change thereafter, even if the library is updated.</p> <p><strong>shared library</strong> - The code for the library functions is loaded into the program at run time, and if the library is changed later, the running program runs with the new library modifications.</p> <p>Using shared libraries is more efficient because they can be used by many applications at once; memory usage, executable sizes, and application load time are reduced.</p> <p>Shared Libraries are also called <strong>Dynamic Link Libraries</strong> (DLLs). Under Linux, shared libraries are (and must be) carefully versioned to avoid DLL Hell.</p> <p><code>ldd</code> can be used to ascertain what shared libraries an executable requires. It shows the .so name of the library and what file it actually points to.</p> <p><code>ldconfig</code> is generally run at boot time (but can be run anytime), and uses <code>/etc/ld.so.conf</code>, which lists the directories that will be searched for shared libraries. ldconfig must be run as root, and shared libraries should only be stored in system directories when they are stable and useful. The linker also first search any directories specified in the environment variable <code>LD_LIBRARY_PATH</code>, a colon separated list of directories.</p> <h3 id=signals>Signals<a class=headerlink href=#signals title="Permanent link">&para;</a></h3> <p>Signals are one of the oldest methods of <strong>Inter-Process Communication</strong> (IPC) and are used to notify processes about <strong>asynchronous events</strong> (or exceptions).</p> <p>Signals can only be sent between processes owned by the same user or from a process owned by the superuser to any process.</p> <p>When a process receives a signal, what it does will depend on the way the program is written, or just respond according to system defaults. SIGKILL(#9) and SIGSTOP(#19) cannot be handled, and will always terminate the program.</p> <p>Use <code>kill -l</code> to view list of signals. <code>man 7 signal</code> will give further documentation.</p> <p>Generally, signals are used to handle two things:</p> <ul> <li>Exceptions detected by hardware (such as an illegal memory reference)</li> <li>Exceptions generated by the environment (such as the premature death of a process from the user's terminal)</li> </ul> <p>Since a process cannot send a signal directly to another process, it must ask the kernel to send the signal. We use <code>kill</code> to send signals (by either number or name) to a process. <code>killall</code> kills all processes with a given name. <code>pkill</code> is similar to kill but uses name instead of pid.</p> <p>Note that POSIX says one should use signal names, not numbers, which are allowed to be completely implementation dependent.</p> <div class=highlight><pre><span></span><code>$ <span class=nb>kill</span> <span class=m>1234</span>
$ <span class=nb>kill</span> -9 <span class=m>1234</span>
$ <span class=nb>kill</span> -SIGTERM <span class=m>1234</span>

$ killall bash
$ killall -9 bash
$ killall -SIGKILL bash

$ pkill -HUP rsyslogd
</code></pre></div> <table> <thead> <tr> <th>Signal</th> <th>Value</th> <th>Default</th> <th>Action</th> <th>POSIX?</th> <th>Meaning</th> </tr> </thead> <tbody> <tr> <td>SIGHUP</td> <td>1</td> <td>Terminate</td> <td>Yes</td> <td>Hangup detected on controlling terminal or death of controlling process</td> <td></td> </tr> <tr> <td>SIGINT</td> <td>2</td> <td>Terminate</td> <td>Yes</td> <td>Interrupt from keyboard</td> <td></td> </tr> <tr> <td>SIGQUIT</td> <td>3</td> <td>Core dump</td> <td>Yes</td> <td>Quit from keyboard</td> <td></td> </tr> <tr> <td>SIGILL</td> <td>4</td> <td>Core dump</td> <td>Yes</td> <td>Illegal instruction</td> <td></td> </tr> <tr> <td>SIGTRAP</td> <td>5</td> <td>Core dump</td> <td>No</td> <td>Trace/breakpoint trap for debugging</td> <td></td> </tr> <tr> <td>SIGABTR SIGIOT</td> <td>6</td> <td>Core dump</td> <td>Yes</td> <td>Abnormal termination</td> <td></td> </tr> <tr> <td>SIGBUS</td> <td>7</td> <td>Core dump</td> <td>Yes</td> <td>Bus error</td> <td></td> </tr> <tr> <td>SIGFPE</td> <td>8</td> <td>Core dump</td> <td>Yes</td> <td>Floating point exception</td> <td></td> </tr> <tr> <td>SIGKILL</td> <td>9</td> <td>Terminate</td> <td>Yes</td> <td>Kill signal (cannot be caught or ignored)</td> <td></td> </tr> <tr> <td>SIGUSR1</td> <td>10</td> <td>Terminate</td> <td>Yes</td> <td>User-defined signal 1</td> <td></td> </tr> <tr> <td>SIGSEGV</td> <td>11</td> <td>Core dump</td> <td>Yes</td> <td>Invalid memory reference</td> <td></td> </tr> <tr> <td>SIGUSR2</td> <td>12</td> <td>Terminate</td> <td>Yes</td> <td>User-defined signal 2</td> <td></td> </tr> <tr> <td>SIGPIPE</td> <td>13</td> <td>Terminate</td> <td>Yes</td> <td>Broken pipe: write to pipe with no readers</td> <td></td> </tr> <tr> <td>SIGALRM</td> <td>14</td> <td>Terminate</td> <td>Yes</td> <td>Timer signal from alarm</td> <td></td> </tr> <tr> <td>SIGTERM</td> <td>15</td> <td>Terminate</td> <td>Yes</td> <td>Process termination</td> <td></td> </tr> <tr> <td>SIGSTKFLT</td> <td>16</td> <td>Terminate</td> <td>No</td> <td>Stack fault on math co-processor</td> <td></td> </tr> <tr> <td>SIGCHLD</td> <td>17</td> <td>Ignore</td> <td>Yes</td> <td>Child stopped or terminated</td> <td></td> </tr> <tr> <td>SIGCONT</td> <td>18</td> <td>Continue</td> <td>Yes</td> <td>Continue if stopped</td> <td></td> </tr> <tr> <td>SIGSTOP</td> <td>19</td> <td>Stop</td> <td>Yes</td> <td>Stop process (can not be caught or ignored)</td> <td></td> </tr> <tr> <td>SIGTSTP</td> <td>20</td> <td>Stop</td> <td>Yes</td> <td>Stop types at tty</td> <td></td> </tr> <tr> <td>SIGTTIN</td> <td>21</td> <td>Stop</td> <td>Yes</td> <td>Background process requires tty input</td> <td></td> </tr> <tr> <td>SIGTTOU</td> <td>22</td> <td>Stop</td> <td>Yes</td> <td>Background process requires tty output</td> <td></td> </tr> <tr> <td>SIGURG</td> <td>23</td> <td>Ignore</td> <td>No</td> <td>Urgent condition on socket (4.2 BSD)</td> <td></td> </tr> <tr> <td>SIGXCPU</td> <td>24</td> <td>Core dump</td> <td>Yes</td> <td>CPU time limit exceeded (4.2 BSD)</td> <td></td> </tr> <tr> <td>SIGXFSZ</td> <td>25</td> <td>Core dump</td> <td>Yes</td> <td>File size limit exceeded (4.2 BSD)</td> <td></td> </tr> <tr> <td>SIGVTALRM</td> <td>26</td> <td>Terminate</td> <td>No</td> <td>Virtual alarm clock (4.2 BSD)</td> <td></td> </tr> <tr> <td>SIGPROF</td> <td>27</td> <td>Terminate</td> <td>No</td> <td>Profile alarm clock (4.2 BSD)</td> <td></td> </tr> <tr> <td>SIGWINCH</td> <td>28</td> <td>Ignore</td> <td>No</td> <td>Window resize signal (4.3 BSD, Sun)</td> <td></td> </tr> <tr> <td>SIGIO SIGPOLL</td> <td>29</td> <td>Terminate</td> <td>No I/O now possible (4.2 BSD) (System V)</td> <td></td> <td></td> </tr> <tr> <td>SIGPWR</td> <td>30</td> <td>Terminate</td> <td>No</td> <td>Power Failure (System V)</td> <td></td> </tr> <tr> <td>SIGSYS SIGUNUSED</td> <td>31</td> <td>Terminate</td> <td>No Bad System Called. Unused signal</td> <td></td> <td></td> </tr> </tbody> </table> <h2 id=package-management-systems>Package Management Systems<a class=headerlink href=#package-management-systems title="Permanent link">&para;</a></h2> <p>Use of Packages and Package Management System helps keep track of files and metadata in an automated, predictable and reliable way, so that system administrators can automate the process of installing, upgrading, configuring and removing software packages and scale to thousands of systems without requiring manual work on each individual system.</p> <ul> <li>Automation: No need for manual installs and upgrades.</li> <li>Scalability: Install packages on one system, or 10,000 systems.</li> <li>Repeatability and predictability.</li> <li>Security and auditing.</li> </ul> <p>A given package may contain executable files, data files, documentation, installation scripts and configuration files. Also included are metadata attributes such as version numbers, checksums, vendor information, dependencies, descriptions, etc.</p> <p>Upon installation, all that information is stored locally into an internal database, which can be conveniently queried for version status and update information.</p> <h3 id=package-types>Package Types<a class=headerlink href=#package-types title="Permanent link">&para;</a></h3> <p><strong>Binary Packages</strong> Binary packages contain files ready for deployment, including executable files and libraries. These are architecture dependent.</p> <p><strong>Source Packages</strong> Source packages are used to generate binary packages; you should always be able to rebuild a binary package from the source package. One source package can be used for multiple architectures.</p> <p><strong>Architecture-independent</strong> Architecture-independent packages contain files and scripts that run under script interpreters, as well as documentation and configuration files.</p> <p><strong>Meta-packages</strong> Meta-packages are groups of associated packages that collect everything needed to install a relatively large subsystem, such as a desktop environment, or an office suite, etc.</p> <h3 id=packaing-tool-levels>Packaing Tool Levels<a class=headerlink href=#packaing-tool-levels title="Permanent link">&para;</a></h3> <p><strong>Low Level Utilities</strong> This simply installs or removes a single package, or a list of packages, each one of which is individually and specifically named. Dependencies are not fully handled, only warned about or produce an error:</p> <ul> <li>If another package needs to be installed, first installation will fail.</li> <li>If the package is needed by another package, removal will fail.</li> </ul> <p>The rpm and dpkg utilities play this role for the packaging systems that use them.</p> <p><strong>High Level Utilities</strong> If another package or group of packages needs to be installed before software can be installed, such needs will be satisfied. If removing a package interferes with another installed package, the administrator will be given the choice of either aborting, or removing all affected software.</p> <p>The <code>dnf</code> and <code>zypper</code> utilities (and the older <code>yum</code>) take care of the dependency resolution for <code>rpm</code> systems, and <code>apt-get</code> and <code>apt-cache</code> and other utilities take care of it for <code>dpkg</code> systems.</p> <h3 id=package-sources>Package Sources<a class=headerlink href=#package-sources title="Permanent link">&para;</a></h3> <p>Every distribution has one or more package repositories where system utilities go to obtain software and to update with new versions. It is the job of the distribution to make sure all packages in the repositories play well with each other.</p> <p>There are always other external repositories which can be added to the standard distribution-supported list. i.e. <strong>EPEL</strong> (Extra Packages for Enterprise Linux) fit well with RHEL since their source is Fedora and the maintainers are close to Red Hat.</p> <p>Building your own package allows you to control exactly what goes in the software and exactly how it is installed.</p> <ul> <li>Creating needed symbolic links</li> <li>Creating directories as needed</li> <li>Setting permissions</li> <li>Anything that can be scripted.</li> </ul> <h3 id=source-control-management-system>Source control Management System<a class=headerlink href=#source-control-management-system title="Permanent link">&para;</a></h3> <h4 id=git>Git<a class=headerlink href=#git title="Permanent link">&para;</a></h4> <p>Git has two important data structures: an <strong>object database</strong> and a <strong>directory cache</strong>.</p> <p>The object database contains objects of three varieties:</p> <ul> <li>Blobs: Chunks of binary data containing file contents</li> <li>Trees: Sets of blobs including file names and attributes, giving the directory structure</li> <li>Commits: Changesets describing tree snapshots.</li> </ul> <p>The directory cache captures the state of the directory tree.</p> <h3 id=rpm>RPM<a class=headerlink href=#rpm title="Permanent link">&para;</a></h3> <p>RPM stood for Redhat Package Manager. All files related to a specific task or a subsystem are packaged into a single file, which also contains information about how and where to install and uninstall the files.</p> <p>RPM allows builders to keep the changes necessary for building on Linux separate from the original source. This capability facilitates incorporating new versions of the code, because build-related changes are all in one place. It also facilitates building versions of Linux for different architectures.</p> <p>rpm does not retrieve packages over the network unless given a specific URL to draw from. It installs from the local machine using absolute or relative paths.</p> <p>The standard <strong>naming convention</strong> for a binary RPM package is:</p> <div class=highlight><pre><span></span><code>&lt;name&gt;-&lt;version&gt;-&lt;release&gt;.&lt;distro&gt;.&lt;architecture&gt;.rpm
sed-4.5-2.e18.x86_64.rpm
</code></pre></div> <p><code>/var/lib/rpm</code> is the default system directory which holds RPM database files in the form of Berkeley DB hash files. The database files should not be manually modified; updates should be done only through the use of the rpm program. One can use <code>--dbpath</code> to specify another location for database, and <code>--rebuilddb</code> to rebuild the database indices from the installed package headers.</p> <p>Helper programs and scripts used by RPM reside in <code>/usr/lib/rpm</code>. You can create an <code>rpmrc</code> file to specify default settings for rpm. By default, rpm looks for it in:</p> <ol> <li>/usr/lib/rpm/rpmrc</li> <li>/etc/rpmrc</li> <li>~/.rpmrc</li> <li>specified by <code>--rcfile</code></li> </ol> <h4 id=queries>Queries<a class=headerlink href=#queries title="Permanent link">&para;</a></h4> <p>Run rpm inquiries with the <code>-q</code> option, which can be combined with numerous other query options:</p> <ul> <li>-f: allows you to determine which package a file came from</li> <li>-l: lists the contents of a specific package</li> <li>-a: all the packages installed on the system</li> <li>-i: information about the package</li> <li>-p: run the query against a package file instead of the package database</li> <li>--requires: return a list of prerequisites for a package</li> <li>--whatprovides: show what installed package provides a particular requisite package</li> </ul> <p>i.e. to list files within a package, do <code>rpm -qilp &lt;package_rpm&gt;</code></p> <h4 id=verifying-packages>Verifying Packages<a class=headerlink href=#verifying-packages title="Permanent link">&para;</a></h4> <p>Run rpm verify inquiries with the <code>-V</code> option to verify whether the files from a particular package are consistent with the system’s RPM database.</p> <p>In the output (you only see output if there is a problem) each of the characters denotes the result of a comparison of attribute(s) of the file to the value of those attribute(s) recorded in the database. A single ”.” (period) means the test passed, while a single ”?” (question mark) indicates the test could not be performed (e.g. file permissions prevent reading). Otherwise, the character denotes the failure of the corresponding <code>--verify</code> test.</p> <ul> <li>S: filesize differs</li> <li>M: mode differs (permissions and file type)</li> <li>5: MD5 sum differs</li> <li>D: device major/minor number mismatch</li> <li>L: readLink path mismatch</li> <li>U: user ownership differs</li> <li>G: group ownership differs</li> <li>T: mTime differs </li> </ul> <h4 id=installing-package>Installing package<a class=headerlink href=#installing-package title="Permanent link">&para;</a></h4> <p>The command to install a package <code>sudo rpm -ivh &lt;package_name&gt;...</code>, or <code>sudo rpm -Uvh &lt;package_name&gt;...</code> for upgrading if package is already installed. <code>sudo rpm -U --oldpackage &lt;package_name&gt;...</code> for downgrading.</p> <p>Tasks performed during installation:</p> <ul> <li>Performs dependency checks</li> <li>Performs conflict checks</li> <li>Executes commands required before installation</li> <li>Deals intelligently with configuration files<ul> <li>if doing an update, config files from original installation will be kept with <code>.rpmsave</code> extension</li> </ul> </li> <li>Unpacks files from packages and installs them with correct attributes</li> <li>Executes commands required after installation</li> <li>Updates the system RPM database</li> </ul> <p>The <code>-e &lt;package_name&gt;</code> option causes rpm to uninstall (erase) a package. It would fail with an error message if the package you are attempting to uninstall is required by other packages on the system. A successful uninstall produces no output. <code>--test</code> option can be used for a dry-run. <code>-vv</code> is for more verbose information.</p> <p>Command <code>sudo rpm -Fvh &lt;package_name&gt;...</code> will attempt to freshen the packages, only when the older versions of the packages were installed, then upgrade will happen. Good for applying lots of patches at once.</p> <p>When upgrading Linux kernel, it is recommended to use <code>-i</code> instead of <code>-U</code> which will remove the older kernel and it is irreversible.</p> <h3 id=dpkg>DPKG<a class=headerlink href=#dpkg title="Permanent link">&para;</a></h3> <p>DPKG (Debian Package) is the packaging system used to install, remove, and manage software packages under Debian Linux and other distributions derived from it.</p> <p>Package files have a <code>.deb</code> suffix and the DPKG database resides in the <code>/var/lib/dpkg</code> directory.</p> <p>The standard <strong>naming convention</strong> for a binary package is:</p> <div class=highlight><pre><span></span><code>&lt;name&gt;_&lt;version&gt;-&lt;revision_number&gt;_&lt;architecture&gt;.deb
logrotate_3.14.0-4ubuntu3_amd64.deb
</code></pre></div> <p>For historical reasons, the 64-bit x86 platform is called amd64 rather than x86_64</p> <p>In the Debian packaging system, a source package consists of at least three files:</p> <ul> <li>An upstream tarball, ending with .tar.gz. This is the unmodified source as it comes from the package maintainers.</li> <li>A description file, ending with .dsc, containing the package name and other metadata, such as architecture and dependencies.</li> <li>A second tarball that contains any patches to the upstream source, and additional files created for the package, and ends with a name .debian.tar.gz or .diff.gz, depending on distribution.</li> </ul> <h4 id=queries_1>Queries<a class=headerlink href=#queries_1 title="Permanent link">&para;</a></h4> <ul> <li>-l: List all packages installed</li> <li>-L: List files installed in the wget package</li> <li>-s: Show information about an installed package</li> <li>-I: Show information about a package file</li> <li>-c: List files in a package file</li> <li>-S: Show what package owns /etc/init/networking.conf</li> <li>-V: Verify the installed package's integrity</li> </ul> <h4 id=installing-package_1>Installing package<a class=headerlink href=#installing-package_1 title="Permanent link">&para;</a></h4> <p>The command to install or upgrade a package <code>sudo dpkg -i package.deb</code>. To remove all of an installed package except for its configurtion files, use <code>sudo dpkg -r package</code>. To complete remove a package include the configuration files, use <code>sudo dpkg -P package</code>.</p> <h3 id=dnf-and-yum>DNF and YUM<a class=headerlink href=#dnf-and-yum title="Permanent link">&para;</a></h3> <p>The higher-level package management systems (such as <code>dnf, yum, apt and zypper</code>) work with databases of available software and incorporate the tools needed to find, install, update, and uninstall software in a highly intelligent fashion.</p> <ul> <li>Use both local and remote repositories as a source to install and update binary, as well as source software packages.</li> <li>Automate the install, upgrade, and removal of software packages.</li> <li>Resolve dependencies automatically.</li> <li>Save time in search and download packages comparing to doing so manually.</li> </ul> <p>Configuration files are located in <code>/etc/yum.repos.d</code> directory and have a <code>.repo</code> extension. You can toggle use of a particular repo on or off by changing the value of enabled, or using the <code>--disablerepo somerepo</code> and <code>--enablerepo somerepo</code> options.</p> <div class=highlight><pre><span></span><code>[repo-name]
    name=Description of the repository
    baseurl=ht‌tp://somesystem.com/path/to/repo
    enabled=1
    gpgcheck=1
</code></pre></div> <p><code>dnf</code> replaced yum during the RHEL/CentOS 7 to 8 transition. <code>dnf</code> is backwards compatible - almost all common yum commands still work.</p> <h4 id=queries_2>Queries<a class=headerlink href=#queries_2 title="Permanent link">&para;</a></h4> <ul> <li>dnf info package-name: Displays information about a package</li> <li>dnf list [installed | updates | available ]: Lists packages installed, available, or updates</li> <li>dnf search [keyword]: Find package by name or information in its metadata</li> <li>dnf grouplist: Shows information about package groups installed, available and updates</li> <li>dnf groupinfo packagegroup: Shows information about a package group</li> <li>dnf provides /path/to/file: Shows the owner of the package for file</li> </ul> <h4 id=installing-package_2>Installing package<a class=headerlink href=#installing-package_2 title="Permanent link">&para;</a></h4> <ul> <li>sudo dnf install package: Installs a package from a repository; also resolves and installs dependencies</li> <li>sudo dnf localinstall package-file: Installs a package from a local rpm file</li> <li>sudo dnf groupinstall 'group-name': Installs a specific software group from a repository; also resolves and installs dependencies for each package in the group</li> <li>sudo dnf remove package: Removes a package from the system</li> <li>sudo dnf update [package]: Updates a package from a repository (if no package listed, updates all packages)</li> </ul> <p>During installation (or update), if a package has a configuration file which is updated, it will rename the old configuration file with a .rpmsave extension. If the old configuration file will still work with the new software, it will name the new configuration file with a .rpmnew extension.</p> <p>some other useful actions to perform: - sudo dnf list "dnf-plugin*": Lists additional dnf plugins - sudo dnf repolist: Shows a list of enabled repositories - sudo dnf shell: Provides an interactive shell in which to run multiple dnf commands (the second form executes the commands in file.txt) - sudo dnf install --downloadonly package: Downloads the packages for you (it stores them in the /var/cache/dnf directory) - sudo dnf history: Views the history of dnf commands on the system, and with the correction options, even undoes or redoes previous commands - sudo dnf clean [packages|metadata|expire-cache|rpmdb|plugins|all]: Cleans up locally stored files and metadata under /var/cache/dnf. This saves space and does house cleaning of obsolete data</p> <p>Similar to <code>dnf</code>, <code>zypper</code> is the command line tool for installing and managing .rpm packages in SUSE Linux and openSUSE.</p> <h3 id=apt>APT<a class=headerlink href=#apt title="Permanent link">&para;</a></h3> <p>For use on Debian-based systems, the APT (Advanced Packaging Tool) set of programs provides a higher level of intelligent services for using the underlying dpkg program, and plays the same role as dnf on Red Hat-based systems.</p> <p>The main utilities are <strong>apt-get</strong> and <strong>apt-cache</strong>. It can automatically resolve dependencies when installing, updating and removing packages. It accesses external software repositories, synchronizing with them and retrieving and installing software as needed. The APT system works with Debian packages whose files have a .deb extension.</p> <p>Read more about it from <a href=https://www.debian.org/distrib/packages target=_blank>Debian packages webpage</a> and the <a href=https://packages.ubuntu.com/ target=_blank>Ubuntu packages webpage</a></p> <h4 id=queries_3>Queries<a class=headerlink href=#queries_3 title="Permanent link">&para;</a></h4> <p>Queries are done using the apt-cache or apt-file utilities. You may have to install apt-file first, and update its database, as in:</p> <div class=highlight><pre><span></span><code>$ sudo apt-get install apt-file
$ sudo apt-file update
</code></pre></div> <ul> <li>apt-cache search apache2: Searches the repository for a package named apache2</li> <li>apt-cache show apache2: Displays basic information about the apache2 package</li> <li>apt-cache showpkg apache2: Displays detailed information about the apache2 package</li> <li>apt-cache depends apache2: Lists all dependent packages for apache2</li> <li>apt-file search apache2.conf: Searches the repository for a file named apache2.conf</li> <li>apt-file list apache2: Lists all files in the apache2 package</li> </ul> <h4 id=installing-package_3>Installing package<a class=headerlink href=#installing-package_3 title="Permanent link">&para;</a></h4> <p>Used to install new packages or update a package which is already installed: </p> <ul> <li>sudo apt-get install [package]: Used to install new packages or update a package which is already installed</li> <li>sudo apt-get remove [package]: Used to remove a package from the system (this does not remove the configuration files)</li> <li>sudo apt-get --purge remove [package]: Used to remove a package and its configuration files from a system</li> <li>sudo apt-get update: Used to synchronize the package index files with their sources. The indexes of available packages are fetched from the location(s) specified in /etc/apt/sources.list</li> <li>sudo apt-get upgrade: Apply all available updates to packages already installed</li> <li>sudo apt-get autoremove: Gets rid of any packages not needed anymore, such as older Linux kernel versions</li> <li>sudo apt-get clean: Cleans out cache files and any archived package files that have been installed</li> </ul> <h2 id=linux-system-monitoring>Linux System Monitoring<a class=headerlink href=#linux-system-monitoring title="Permanent link">&para;</a></h2> <p>Linux distributions come with many standard performance and profiling tools which make use of mounted pseudo-filesystems, especially <code>/proc</code> and secondarily <code>/sys</code>.</p> <p>Some frequently used utilities:</p> <div class=tabbed-set data-tabs=1:4><input checked=checked id=__tabbed_1_1 name=__tabbed_1 type=radio><label for=__tabbed_1_1>Process and Load Monitoring</label><div class=tabbed-content> <table> <thead> <tr> <th>Utility</th> <th>Purpose</th> <th>Package</th> </tr> </thead> <tbody> <tr> <td>top</td> <td>Process activity, dynamically updated</td> <td>procps</td> </tr> <tr> <td>uptime</td> <td>How long the system is running and the average load</td> <td>procps</td> </tr> <tr> <td>ps</td> <td>Detailed information about processes</td> <td>procps</td> </tr> <tr> <td>pstree</td> <td>A tree of processes and their connections</td> <td>psmisc (or pstree)</td> </tr> <tr> <td>mpstat</td> <td>Multiple processor usage</td> <td>sysstat</td> </tr> <tr> <td>iostat</td> <td>CPU utilization and I/O statistics</td> <td>sysstat</td> </tr> <tr> <td>sar</td> <td>Display and collect information about system activity</td> <td>sysstat</td> </tr> <tr> <td>numastat</td> <td>Information about NUMA (Non-Uniform Memory Architecture)</td> <td>numactl</td> </tr> <tr> <td>strace</td> <td>Information about all system calls a process makes</td> <td>strace</td> </tr> </tbody> </table> </div> <input id=__tabbed_1_2 name=__tabbed_1 type=radio><label for=__tabbed_1_2>Memory Monitoring</label><div class=tabbed-content> <table> <thead> <tr> <th>Utility</th> <th>Purpose</th> <th>Package</th> </tr> </thead> <tbody> <tr> <td>free</td> <td>Brief summary of memory usage</td> <td>procps</td> </tr> <tr> <td>vmstat</td> <td>Detailed virtual memory statistics and block I/O, dynamically updated</td> <td>procps</td> </tr> <tr> <td>pmap</td> <td>Process memory map</td> <td>procps</td> </tr> </tbody> </table> </div> <input id=__tabbed_1_3 name=__tabbed_1 type=radio><label for=__tabbed_1_3>I/O Monitoring</label><div class=tabbed-content> <table> <thead> <tr> <th>Utility</th> <th>Purpose</th> <th>Package</th> </tr> </thead> <tbody> <tr> <td>iostat</td> <td>CPU utilization and I/O statistics</td> <td>sysstat</td> </tr> <tr> <td>sar</td> <td>Display and collect information about system activity</td> <td>sysstat</td> </tr> <tr> <td>vmstat</td> <td>Detailed virtual memory statistics and block I/O, dynamically updated</td> <td>procps</td> </tr> </tbody> </table> </div> <input id=__tabbed_1_4 name=__tabbed_1 type=radio><label for=__tabbed_1_4>Network Monitoring</label><div class=tabbed-content> <table> <thead> <tr> <th>Utility</th> <th>Purpose</th> <th>Package</th> </tr> </thead> <tbody> <tr> <td>netstat</td> <td>detailed networking statistics</td> <td>netstat</td> </tr> <tr> <td>iptraf</td> <td>Gather information on network interfaces</td> <td>iptraf</td> </tr> <tr> <td>tcpdump</td> <td>Detailed analysis of network packets and traffic</td> <td>tcpdump</td> </tr> <tr> <td>wireshark</td> <td>Detailed network traffic analysis</td> <td>wireshark</td> </tr> </tbody> </table> </div> </div> <h3 id=sar>sar<a class=headerlink href=#sar title="Permanent link">&para;</a></h3> <p><code>sar</code> stands for the Systems Activity Reporter. It is an all-purpose tool for gathering system activity and performance data and creating reports that are readable by humans.</p> <p><code>sar</code> backend is <code>sadc</code> (system activity data collector), which is usually cron-based <code>/etc/cron.d/sysstat</code> and accumulates the statistics (logs in <code>/var/log/sa</code>).</p> <table> <thead> <tr> <th>Option</th> <th>Meaning</th> </tr> </thead> <tbody> <tr> <td>-A</td> <td>Almost all information</td> </tr> <tr> <td>-b</td> <td>I/O and transfer rate statistics (similar to iostat)</td> </tr> <tr> <td>-B</td> <td>Paging statistics including page faults</td> </tr> <tr> <td>-d</td> <td>Block device activity (similar to iostat -x)</td> </tr> <tr> <td>-n</td> <td>Network statistics</td> </tr> <tr> <td>-P</td> <td>Per CPU statistics (as in sar -P ALL 3)</td> </tr> <tr> <td>-q</td> <td>Queue lengths (run queue, processes and threads)</td> </tr> <tr> <td>-r</td> <td>Memory utilization statistics</td> </tr> <tr> <td>-S</td> <td>Swap utilization statistics</td> </tr> <tr> <td>-u</td> <td>CPU utilization (default)</td> </tr> <tr> <td>-v</td> <td>Statistics about inodes and files and file handles</td> </tr> <tr> <td>-w</td> <td>Context switching statistics</td> </tr> <tr> <td>-W</td> <td>Swapping statistics, pages in and out per second</td> </tr> <tr> <td>-f</td> <td>Extract information from specified file, created by the -o option</td> </tr> <tr> <td>-o</td> <td>Save readings in the file specified, to be read in later with the -f option</td> </tr> </tbody> </table> <h3 id=log-files>Log files<a class=headerlink href=#log-files title="Permanent link">&para;</a></h3> <p>System log files are under <code>/var/log</code>, controlled by the syslogd (usually rsyslogd on modern systems) daemon.</p> <p>Important system messages are located at <code>/var/log/messages</code> for RHEL and <code>/var/log/syslog</code> for Debian. <code>boot.log</code> holds system boot messages, and <code>secure</code> holds security-related messages.</p> <p>You can view new messages continuously as new lines appear with <code>sudo tail -f /var/log/messages</code> or view kernel-related messages with <code>dmesg -w</code>.</p> <p><code>logrotate</code> program is run periodically and keeps four previous copies (by default) of the log files (optionally compressed) and is controlled by <code>/etc/logrotate.conf</code>.</p> <h3 id=stress-and-stress-ng>stress and stress-ng<a class=headerlink href=#stress-and-stress-ng title="Permanent link">&para;</a></h3> <p><code>stress</code> is a C language program written by Amos Waterland and is designed to place a configurable amount of stress by generating various kinds of workloads on the system.</p> <p>Install stress-ng (enhanced version of stress):</p> <div class=highlight><pre><span></span><code>$ git clone git://kernel.ubuntu.com/cking/stress-ng.git
$ cd stress-ng
$ make
$ sudo make install

# fork 8 CPU-intensive processes via sqrt() calculation
# fork 4 IO-intensive processes via sync()
# fork 6 mem-intensive processes via malloc() and each allocate 256MB by default (override with --vm-bytes 128M)
# run stress test for 20 seconds
$ stress-ng -c 8 -i 4 -m 6 -t 20s
</code></pre></div> <h3 id=process-monitoring>Process Monitoring<a class=headerlink href=#process-monitoring title="Permanent link">&para;</a></h3> <h4 id=ps>ps<a class=headerlink href=#ps title="Permanent link">&para;</a></h4> <p><code>ps</code> displays characteristics and statistics associated with processes, all of which are garnered from the /proc directory associated with the process.</p> <p><code>ps</code> has existed in all UNIX-like operating system variants and the options rule is a little different:</p> <ul> <li>UNIX options, which must be preceded by -, and which may be grouped.</li> <li>BSD options, which must not be preceded by -, and which may be grouped.</li> <li>GNU long options, each of which must be preceded by --.</li> </ul> <p>Some common choices of options are:</p> <div class=highlight><pre><span></span><code>$ ps aux <span class=c1># show all processes</span>
$ ps -elf <span class=c1># show process and parent process id, nice value</span>
$ ps -eL <span class=c1># show shorter summary about pid and commands</span>
$ ps -C <span class=s2>&quot;bash&quot;</span> <span class=c1># show process using that command</span>
$ ps -o pid,user,uid,priority,cputime,pmem,size,command <span class=c1># costomize the outputs</span>
</code></pre></div> <h4 id=pstree>pstree<a class=headerlink href=#pstree title="Permanent link">&para;</a></h4> <p><code>pstree</code> gives a visual description of the process ancestry and multi-threaded applications.</p> <p>i.e. <code>pstree -aAp 2408</code> checks process tree of process with PID 2408, which shows the child processes spawned by that process. Another way to see that is doing <code>ls -l /proc/2408/task</code></p> <p>Use <code>-p</code> to show process IDs, use <code>-H [pid]</code> to highlight <code>[pid]</code> and its ancestors.</p> <h4 id=top>top<a class=headerlink href=#top title="Permanent link">&para;</a></h4> <p><code>top</code> is used to display processes with highest CPU usage. Processes are initially sorted by CPU usage.</p> <p>If not run in secure mode (top s) user can signal processes:</p> <ul> <li>Press the k key</li> <li>Give a PID when prompted</li> <li>Give a signal number when prompted </li> </ul> <h3 id=memory-montioring>Memory Montioring<a class=headerlink href=#memory-montioring title="Permanent link">&para;</a></h3> <p>One can use <code>free -m</code> to see a brief summary of memory usage: total, used, free, shared, buff/cached, available.</p> <p>The pseudofile <code>/proc/meminfo</code> contains a wealth of information about how memory is being used.</p> <p>The <code>/proc/sys/vm</code> directory contains many tunable knobs to control the Virtual Memory system, which can be changed either by directly writing to the entry, or using the <code>sysctl</code> utility.</p> <p>The primary (inter-related) tasks are: </p> <ul> <li>Controlling flushing parameters; i.e., how many pages are allowed to be dirty and how often they are flushed out to disk.</li> <li>Controlling swap behavior; i.e., how much pages that reflect file contents are allowed to remain in memory, as opposed to those that need to be swapped out as they have no other backing store. </li> <li>Controlling how much memory overcommission is allowed, since many programs never need the full amount of memory they request, particularly because of copy on write (COW) techniques.</li> </ul> <p>The usual best practice is to adjust one thing at a time and look for effects.</p> <h4 id=vmstat>vmstat<a class=headerlink href=#vmstat title="Permanent link">&para;</a></h4> <p><code>vmstat</code> is a multi-purpose tool that displays information about memory, paging, I/O, processor activity and processes. i.e. <code>vmstat [options] [delay] [count]</code></p> <p>If delay is given in seconds, the report is repeated at that interval count times; if count is not given, vmstat will keep reporting statistics forever until killed by a signal.</p> <p>If the option<code>-S m</code> is given, memory statistics will be in MB instead of KB.</p> <p>With the <code>-a</code> option, vmstat displays information about active and inactive memory, where active memory pages are those which have been recently used; they may be clean (disk contents are up to date) or dirty (need to be flushed to disk eventually).</p> <p>With the <code>-d</code> option to get a table of disk statistics. Use <code>-p partition</code> to view statistics for a particular partition only.</p> <h4 id=oom>OOM<a class=headerlink href=#oom title="Permanent link">&para;</a></h4> <p>One way to deal with memory pressure would be to permit memory allocations to succeed as long as free memory is available and then fail when all memory is exhausted.</p> <p>Alternatively, use <strong>swap</strong> space on disk as "secondary memory" to push some of the resident memory out when under memory pressure.</p> <p>Linux also permits the system to <strong>overcommit</strong> memory (only for user processes, not kernel processes), so that it can grant memory requests that exceed the size of RAM plus swap.</p> <p>Every time a child process is forked, it receives a copy of the entire memory space of the parent. Linux uses the <strong>COW</strong> (copy on write) technique, unless one of the child processes modifies its memory space, no actual copy needs be made. However, the kernel has to assume that the copy might need to be done.</p> <p>You can modify overcommission by setting the value of /proc/sys/vm/overcommit_memory:</p> <ul> <li>0: (default) Permit overcommission, but refuse obvious overcommits, and give root users somewhat more memory allocation than normal users.</li> <li>1: All memory requests are allowed to overcommit.</li> <li>2: Turn off overcommission. Memory requests will fail when the total memory commit reaches the size of the swap space plus a configurable percentage (50 by default) of RAM. This factor is modified changing /proc/sys/vm/overcommit_ratio.</li> </ul> <p>If available memory is exhausted, Linux invokes the <strong>OOM-killer</strong> (Out Of Memory) to decide which process(es) should be exterminated to open up some memory. A value called the <strong>badness</strong> is computed (which can be read from <code>/proc/[pid]/oom_score</code>) for each process on the system and the order of the killing. <code>oom_score_adj</code> can be directly adjusted to override the badness score of a process.</p> <h3 id=io-monitoring>IO Monitoring<a class=headerlink href=#io-monitoring title="Permanent link">&para;</a></h3> <p>Disk performance problems can be strongly coupled to other factors, such as insufficient memory or inadequate network hardware and tuning. Both real-time monitoring and tracing are necessary tools for locating and mitigating disk bottlenecks.</p> <p>A system can be considered as I/O-bound when the CPU is found sitting idle waiting for I/O to complete, or the network is waiting to clear buffers.</p> <p>What appears to be insufficient memory can result from too slow I/O; if memory buffers that are being used for reading and writing fill up, it may appear that memory is the problem, when the real problem is that buffers are not filling up or emptying out fast enough.</p> <p>Network transfers may also be waiting for I/O to complete and cause network throughput to suffer.</p> <h4 id=iostat>iostat<a class=headerlink href=#iostat title="Permanent link">&para;</a></h4> <p><code>iostat</code> is the basic workhorse utility for monitoring I/O device activity on the system. i.e. <code>iostat [OPTIONS] [devices] [interval] [count]</code></p> <p>IO statistics given (broken out by disk partition and logical partitions if LVM is used):</p> <ul> <li>tps (I/O transactions per second; logical requests can be merged into one actual request)</li> <li>blocks read and written per unit time, where the blocks are generally sectors of 512 bytes</li> <li>total blocks read and written</li> </ul> <p>With <code>-k</code> shows results in KB instead of blocks; with <code>-m</code> shows in MB. With <code>-N</code> or <code>-d</code> shows the device name. With <code>-x</code> shows some extended statistics.</p> <h4 id=iotop>iotop<a class=headerlink href=#iotop title="Permanent link">&para;</a></h4> <p><code>iotop</code> displays a table of current I/O usage and updates periodically.</p> <p>The <code>be</code> and <code>rt</code> entries in the <code>PRIO</code> field stand for best effort and real time.</p> <h4 id=ionice>ionice<a class=headerlink href=#ionice title="Permanent link">&para;</a></h4> <p><code>ionice</code> utility lets you set both the I/O scheduling class and priority for a given process. i.e. <code>ionice [-c class] [-n priority] [-p pid ] [COMMAND [ARGS] ]</code></p> <p>If a pid is given with the <code>-p</code> argument results apply to the requested process, otherwise it is the process that will be started by COMMAND with possible arguments.</p> <p>The -c parameter specifies the I/O scheduling class:</p> <ul> <li>0 - default</li> <li>1 - real time, get first access to the disk, can starve other processes; the priority defines how big a time slice each process gets</li> <li>2 - best effort, programs serviced in round-robin fashion, according to priority settings (default)</li> <li>3 - idle - no access to disk I/O unless no other program has asked for it for a defined period</li> </ul> <p>The Best Effort and Real Time classes take the <code>-n</code> argument which gives the priority, which can range from 0 to 7, with 0 being the highest priority.</p> <h4 id=benchmarking>Benchmarking<a class=headerlink href=#benchmarking title="Permanent link">&para;</a></h4> <p><code>bonnie++</code> is a widely available benchmarking program that tests and measures the performance of drives and filesystems.</p> <p>Results can be read from the terminal window or directed to a file, and also to a csv format. Companion programs, <code>bon_csv2html</code> and <code>bon_csv2txt</code>, can be used convert to html and plain text output formats.</p> <p><code>fs_mark</code> benchmark gives a low level bashing to file systems, using heavily asynchronous I/O across multiple directories and drives.</p> <h3 id=io-scheduling>I/O Scheduling<a class=headerlink href=#io-scheduling title="Permanent link">&para;</a></h3> <p>The I/O scheduler provides the interface between the generic block layer and low-level physical device drivers.</p> <p>The I/O scheduling layer prioritize and order the requests from VM and VFS before they are given to the block devices.</p> <p>Any I/O scheduling algorithm has to satisfy certain requirements:</p> <ul> <li>Hardware access times should be minimized; i.e., requests should be ordered according to physical location on the disk. This leads to an elevator scheme where requests are inserted in the pending queue in physical order.</li> <li>Requests should be merged to the extent possible to get as big a contiguous region as possible, which also minimizes disk access time.</li> <li>Requests should be satisfied with as low a latency as is feasible; indeed, in some cases, determinism (in the sense of deadlines) may be important.</li> <li>Write operations can usually wait to migrate from caches to disk without stalling processes. Read operations, however, almost always require a process to wait for completion before proceeding further. Favoring reads over writes leads to better parallelism and system responsiveness.</li> <li>Processes should share the I/O bandwidth in a fair, or at least consciously prioritized fashion; even if it means some overall performance slowdown of the I/O layer, process throughput should not suffer inordinately.</li> </ul> <p>At least one of the I/O scheduling algorithms must be compiled into the kernel. The scheduler for each device can be selected or viewed at run time. i.e. <code>/sys/block/sda/queue/scheduler</code> and scheduler-specific tunables can be found in <code>/sys/block/sda/queue/iosched</code>.</p> <h2 id=filesystems-and-vfs>Filesystems and VFS<a class=headerlink href=#filesystems-and-vfs title="Permanent link">&para;</a></h2> <p>A UNIX-like filesystem uses a <strong>tree</strong> hierarchy. Multiple filesystems can be merged together into a single tree structure. Linux uses a <strong>virtual filesystem layer</strong> (VFS) to communicate with the filesystem software.</p> <p>Local filesystems generally reside within a disk partition which can be a physical partition on a disk, or a logical partition controlled by a <strong>Logical Volume Manager</strong> (LVM).</p> <p>Filesystems can also be of a network nature and their true physical embodiment completely hidden to the local system across the network.</p> <h3 id=inodes>inodes<a class=headerlink href=#inodes title="Permanent link">&para;</a></h3> <p>An inode is a data structure on disk that describes and stores <strong>file attributes</strong> such as name, location, file attributes (permissions, ownership, size, etc.), access &amp; modify times and others.</p> <p>Filenames are not stored in the inode; they are stored in the <strong>directory</strong> that contains the files.</p> <h4 id=hardsoft-links>Hard/soft links<a class=headerlink href=#hardsoft-links title="Permanent link">&para;</a></h4> <p>A directory file is a particular type of file that is used to associate file names and inodes. Two ways to associate (or link) a file name with an inode:</p> <ul> <li>Hard links point to an inode.​ All hard linked files have to be on the same filesystem. Changing the content of a hard linked file in one place may change it in other places.</li> <li>Soft (or symbolic) links point to a file name which has an associated inode. Soft linked files may be on different filesystems. If the target does not yet exist or is not yet mounting, it can be dangling.</li> <li>A nice article explaning the differences between hard and soft links: https://linuxgazette.net/105/pitcher.html</li> </ul> <p>When two or more directory entries to point to the same inode (hard links), a file can be known by multiple names, each of which has its own place in the directory structure.</p> <p>When a process refers to a pathname, the kernel searches directories to find the corresponding inode number. After the name has been converted to an inode number, the inode is loaded into memory and is used by subsequent requests.</p> <h3 id=vfs>VFS<a class=headerlink href=#vfs title="Permanent link">&para;</a></h3> <p>When an application needs to access a file, it interacts with the VFS abstraction layer, which then translates all the I/O system calls (reading, writing, etc.) into specific code relevant to the particular actual filesystem.</p> <p>Neither the specific actual filesystem or physical media and hardware on which it resides need be considered by applications.</p> <p>Network filesystems (such as NFS) can also be handled transparently. This permits Linux to work with more filesystem varieties than any other operating system.</p> <p>Commonly used filesystems include <code>ext4, xfs, btrfs, squashfs, nfs and vfat</code>.</p> <p>A list of currently supported filesystems is at <code>/proc/filesystems</code>. The ones with nodev are special filesystems which do not reside on storage.</p> <h4 id=journaling-filesystems>Journaling Filesystems<a class=headerlink href=#journaling-filesystems title="Permanent link">&para;</a></h4> <p>Journaling filesystems recover from system crashes or ungraceful shutdowns with little or no corruption, and do so very rapidly.</p> <p>In a journaling filesystem, operations are grouped into <strong>transactions</strong>. A transaction must be completed without error, atomically; otherwise, the filesystem is not changed. A log file is maintained of transactions. When an error occurs, usually only the <strong>last</strong> transaction needs to be examined.</p> <h3 id=disk-partitioning>Disk Partitioning<a class=headerlink href=#disk-partitioning title="Permanent link">&para;</a></h3> <p>Reasons for doing disk partitions:</p> <ul> <li>Separation of user and application data from operating system files</li> <li>Sharing between operating systems and/or machines</li> <li>Security enhancement by imposing different quotas and permissions for different system parts</li> <li>Size concerns; keeping variable and volatile storage isolated from stable</li> <li>Performance enhancement of putting most frequently used data on faster storage media</li> <li>Swap space can be isolated from data and also used for hibernation storage.</li> </ul> <p>A common partition layout contains a <code>/boot</code> partition, a partition for the root filesystem <code>/</code>, a swap partition, and a partition for the <code>/home</code> directory tree.</p> <p>It is more difficult to resize a partition after installing the OS.</p> <h4 id=common-disk-types>common disk types<a class=headerlink href=#common-disk-types title="Permanent link">&para;</a></h4> <ul> <li>SATA (Serial Advanced Technology Attachment) - SATA disks were designed to replace the old IDE (Integrated Drive Electronics) drives. They offer a smaller cable size (7 pins), native hot swapping, and faster and more efficient data transfer. They are seen as SCSI devices.</li> <li>SCSI (Small Computer Systems Interface) - SCSI disks range from narrow (8 bit bus) to wide (16 bit bus), with a transfer rate from about 5 MB per second (narrow, standard SCSI) to about 160 MB per second (Ultra-Wide SCSI-3). SCSI has numerous versions such as Fast, Wide, and Ultra, Ultrawide.</li> <li>SAS (Serial Attached SCSI) - SAS uses a newer point-to-point protocol, has a better performance than SATA disks and is better suited for servers. Learn more <a href=https://www.hp.com/us-en/shop/tech-takes/sas-vs-sata target=_blank>SAS vs SATA</a></li> <li>USB (Universal Serial Bus) - These include flash drives and floppies. And are seen as SCSI devices.</li> <li>SSD (Solid State Drives) - Modern SSD drives have come down in price, have no moving parts, use less power than drives with rotational media, and have faster transfer speeds. Internal SSDs are even installed with the same form factor and in the same enclosures as conventional drives. SSDs still cost a bit more, but price is decreasing. It is common to have both SSDs and rotational drives in the same machines, with frequently accessed and performance critical data transfers taking place on the SSDs.</li> </ul> <h4 id=disk-drives>Disk drives<a class=headerlink href=#disk-drives title="Permanent link">&para;</a></h4> <p>Rotational disks are composed of one or more <strong>platters</strong> and each platter is read by one or more <strong>heads</strong>. Heads read a circular track off a platter as the disk spins. Circular tracks are divided into data blocks called sectors. A cylinder is a group which consists of the same track on all platters.</p> <p>The physical structural image has become less and less relevant as internal electronics on the drive actually obscure much of it.</p> <p>Use <code>sudo fdisk -l /dev/sdc</code> to list the partition table without entering interactive mode.</p> <p><strong><code>fdisk</code></strong> is a menu-driven partition table editor and included in any Linux installation. It is the most standard and one of the most flexible of the partition table editors. As with any other partition table editor, make sure that you either write down the current partition table settings or make a copy of the current settings before making changes.</p> <p>No actual changes are made until you write the partition table to the disk by entering w. It is therefore important to verify your partition table is correct (with p) before writing to disk with w. If something is wrong, you can jump out safely with q. After the edit is made, either reboot or use <code>sudo partprobe -s</code> to make the change taking in effect.</p> <p><code>parted</code> is the GNU tool that create, remove, resize, and move partitions (including certain filesystems).</p> <p><code>cat /proc/partitions</code> to examine what partitions the operating system is currently aware of.</p> <h4 id=partition-organization>Partition Organization<a class=headerlink href=#partition-organization title="Permanent link">&para;</a></h4> <p>Disks are divided into partitions. A partition is a physically contiguous region on the disk. Two partition schemes:</p> <ul> <li>MBR (Master Boot Record)</li> <li>GPT (GUID Partition Table)</li> </ul> <p><strong>MBR</strong> dates back to the early days of MSDOS. When using MBR, a disk may have up to <em>four</em> <strong>primary partitions</strong>. <em>One</em> (and only one) of the primary partitions can be designated as an <strong>extended partition</strong>, which can be subdivided further into <strong>logical partitions</strong> with 15 total partitions possible.</p> <p>GPT is on all modern systems and is based on <strong>UEFI</strong> (Unified Extensible Firmware Interface). By default, it may have up to <em>128</em> primary partitions. When using the GPT scheme, there is no need for extended partitions. Partitions can be up to <em>233 TB</em> in size (with MBR, the limit is just <em>2TB</em>).</p> <h4 id=mbr-parition-table>MBR Parition Table<a class=headerlink href=#mbr-parition-table title="Permanent link">&para;</a></h4> <p>The <strong>disk partition table</strong> is contained within the disk's Master Boot Record (MBR), and is the <strong>64 bytes</strong> following the 446 byte boot record. One partition on a disk may be marked active. When the system boots, that partition is where the MBR looks for items to load.</p> <p>The structure of the MBR is defined by an operating system-independent convention. The <strong>first 446 bytes</strong> are reserved for the program code. They typically hold part of a <strong>boot loader program</strong>.</p> <p>There are <strong>2 more bytes</strong> at the end of the MBR known as the <strong>magic number, signature word, or end of sector marker</strong>, which always have the value <strong>0x55AA</strong>.</p> <p>Each entry in the partition table is <strong>16 bytes long</strong> and contains information:</p> <ul> <li>Active bit</li> <li>Beginning address in cylinder/head/sectors (CHS) format</li> <li>Partition type code, indicating: xfs, LVM, ntfs, ext4, swap, etc.</li> <li>Ending address in CHS</li> <li>Start sector, counting linearly from 0</li> <li>Number of sectors in partition.</li> </ul> <p>Linux only uses the last two fields for addressing, using the <strong>linear block addressing</strong> (LBA) method.</p> <p>For MBR systems, <code>dd</code> can be used for converting and copying files. However, be careful using <code>dd</code>: a simple typing error or misused option could destroy your entire disk.</p> <p>The following command will backup the MBR (along with the partition table): <code>$ dd if=/dev/sda of=mbrbackup bs=512 count=1</code></p> <p>The MBR can be restored using the following command: <code>$ sudo dd if=mbrbackup of=/dev/sda bs=512 count=1</code></p> <h4 id=gpt-partition-table>GPT Partition table<a class=headerlink href=#gpt-partition-table title="Permanent link">&para;</a></h4> <p>Modern hardware comes with GPT support; MBR support will gradually fade away. The Protective MBR is for backwards compatibility, so UEFI systems can be booted the old way.</p> <p>There are <strong>two copies</strong> of the GPT header, at the beginning and at the end of the disk, describing metadata:</p> <ul> <li>List of usable blocks on disk</li> <li>Number of partitions</li> <li>Size of partition entries. Each partition entry has a minimum size of <strong>128 bytes</strong>.</li> </ul> <p>The <code>blkid</code> utility shows information about partitions. i.e. <code>sudo blkid /dev/sda8</code></p> <p><code>blkid</code> is a utility to locate block devices and report on their attributes, such as type of contents, tokens, LABEL or UUID</p> <p><code>lsblk</code> presents block device information in a tree format</p> <h4 id=devices-nodes>Devices Nodes<a class=headerlink href=#devices-nodes title="Permanent link">&para;</a></h4> <p>The Linux kernel interacts at a low level with disks through device nodes normally found in the <code>/dev</code> directory.</p> <p>Device nodes for SCSI and SATA disks follow a simple <code>xxy[z]</code> naming convention, where xx is the device type (usually sd), y is the letter for the drive number (a, b, c, etc.), and z is the partition number.</p> <p>sd means SCSI or SATA disk. Back in the days where IDE disks could be found, they would have been <code>/dev/hda3, /dev/hdb</code></p> <h3 id=filesystem-features>Filesystem Features<a class=headerlink href=#filesystem-features title="Permanent link">&para;</a></h3> <h4 id=file-attributes>File Attributes<a class=headerlink href=#file-attributes title="Permanent link">&para;</a></h4> <p><strong>Extended Attributes</strong> associate metadata not interpreted directly by the filesystem with files: <code>user, trusted, security, and system</code></p> <p>The system namespace is used for <strong>Access Control Lists</strong> (ACLs), and the security namespace is used by SELinux.</p> <p>Flag values are stored in the file inode and may be modified and set only by the root user. They are viewed with <code>lsattr filename</code> and set with <code>chattr [+|-|=mode] filename</code>.</p> <p>Flags that can be set:</p> <ul> <li>i: immutable - A file with the <strong>immutable</strong> attribute cannot be modified (not even by root). It cannot be deleted or renamed. No hard link can be created to it, and no data can be written to the file. Only the superuser can set or clear this attribute.</li> <li>a: append-only - A file with the <strong>append-only</strong> attribute set can only be opened in append mode for writing. Only the superuser can set or clear this attribute.</li> <li>d: no-dump - A file with the <strong>no-dump</strong> attribute set is ignored when the dump program is run. This is useful for swap and cache files that you don't want to waste time backing up.</li> <li>A: no atime update - A file with the <strong>no-atime-update</strong> attribute set will not modify its atime (access time) record when the file is accessed but not modified. This can increase the performance on some systems because it reduces the amount of disk I/O; say some files that are being accessed very frequently.</li> </ul> <h4 id=mkfs>mkfs<a class=headerlink href=#mkfs title="Permanent link">&para;</a></h4> <p><code>mkfs</code> is a utility for formatting (making) a filesystem on a partition. See the fs programs with <code>ls -lhF /sbin/mkfs*</code>. General usage: <code>mkfs [-t fstype] [options] [device-file]</code></p> <p>Each filesystem type has its own particular formatting options and its own mkfs program, and can be learned from its man page.</p> <h4 id=fsck>fsck<a class=headerlink href=#fsck title="Permanent link">&para;</a></h4> <p><code>fsck</code> a utility designed to check for errors and may fix if found any. Like <code>mkfs</code>, it also have many variations for different filesystem types, view with <code>ls -lhF /sbin/fsck*</code>. General usage: <code>fsck [-t fstype] [options] [device-file]</code></p> <p>Usually, you do not need to specify the filesystem type, as fsck can figure it out by examining the superblocks at the start of the partition.</p> <p>You can control whether any errors found should be fixed one by one manually with the -r option, or automatically, as best possible, by using the -a option.</p> <p><code>fsck</code> is run automatically after a set number of mounts or a set interval since the last time it was run or after an abnormal shutdown. It should only be run on unmounted filesystems. You can force a check of all mounted filesystems at boot by doing: <code>sudo touch /forcefsck</code> then reboot.</p> <h4 id=etcfstab>/etc/fstab<a class=headerlink href=#etcfstab title="Permanent link">&para;</a></h4> <p>During system initialization, the command <code>mount -a</code> is executed in order to mount all filesystems listed in <code>/etc/fstab</code>. <code>/etc/fstab</code> is used to define mountable file systems and devices on startup. This may include both local and remote network-mounted filesystems, such as <strong>NFS</strong> and <strong>samba</strong> filesystems.</p> <p>Each record in the <code>/etc/fstab</code> file contains white space separated files of information about a filesystem to be mounted:</p> <ul> <li>Device file name (such as <code>/dev/sda1</code>), label, or UUID</li> <li>Mount point for the filesystem (where in the tree structure is it to be inserted)</li> <li>Filesystem type</li> <li>A comma-separated list of options</li> <li>dump frequency used by the dump -w command, or a zero which is ignored by dump</li> <li>fsck pass number or a zero - meaning do not fsck this partition</li> </ul> <p>Linux systems have long had the ability to mount a filesystem only when it is needed, which is done through <strong><code>autofs</code></strong>.</p> <p>While <code>autofs</code> is very flexible and well understood, <code>systemd</code>-based systems (including all enterprise Linux distributions) come with <code>automount</code> facilities built into the <code>systemd</code> framework.</p> <h4 id=check-filesystem-usage>check filesystem usage<a class=headerlink href=#check-filesystem-usage title="Permanent link">&para;</a></h4> <p><code>df</code> (disk free) is used to look at filesystem usage. The option <code>-h</code> shows human-readable format, <code>-T</code> shows filesystem type, and <code>-i</code> shoes inode information.</p> <p><code>du</code> (disk usage) is used to look at both disk capacity and usage. The option <code>-a</code> lists all files in addition to directories. <code>find . -maxdepth 1 -type d -exec du -shx {} \; | sort -hr</code> shows directory size total and sort in decending order.</p> <h3 id=swap>swap<a class=headerlink href=#swap title="Permanent link">&para;</a></h3> <p>Linux employs a virtual memory system which overcommits functions in two ways such that:</p> <ol> <li>programs do not actually use all the memory they are given permission to use</li> <li>when under memory pressure, less active memory regions may be <strong>swapped out</strong> to disk, to be recalled only when needed again</li> </ol> <p>Swapping is usually done to one or more dedicated partitions or files; Linux permits multiple swap areas. Each area has a priority, and lower priority areas are not used until higher priority areas are filled.</p> <p>In most situations, the recommended swap size is the total RAM on the system. Current swap in use can be found under <code>/proc/swaps</code>. Its usage can be viewed with <code>free -m</code></p> <p>Commands involved with swap are</p> <ul> <li><code>mkswap</code>: format a swap paritition or file</li> <li><code>swapon</code>: activate a swap partition or file</li> <li><code>swapoff</code>: deactivate a swap partition or file</li> </ul> <p>At any given time, most memory is in use for caching file contents to prevent actually going to the disk any more than necessary and are never swapped out since it is pointless; instead, dirty pages are flushed out to disk.</p> <p>Linux memory used by the <strong>kernel</strong> itself is never swapped out.</p> <h4 id=quotas>Quotas<a class=headerlink href=#quotas title="Permanent link">&para;</a></h4> <p>Disk quotas allow administrators to control the maximum space particular users (or groups) are allowed. Commands involved with quota:</p> <ul> <li><code>quotacheck</code>: generates and updates quota accounting files<ul> <li>use option <code>-u</code> for user files and <code>-g</code> for group files</li> <li>pass in the filesystem to update, otherwise use <code>-a</code> to apply/update all filesystems in <code>/etc/fstab</code></li> <li>generally only run after quota is initially turned on, or <code>fsck</code> reports errors in a filesystem</li> </ul> </li> <li><code>quotaon</code>: enables quota accounting</li> <li><code>quotaoff</code>: disables quota accounting</li> <li><code>edquota</code>: edit user or group quotas<ul> <li>use option <code>-u</code> for edit user quota and <code>-g</code> for group</li> <li>use option <code>-p</code> to copy quota value from a user/group to another</li> <li>use option <code>-t</code> to set grace periods</li> </ul> </li> <li><code>quota</code> reports usage and limits</li> </ul> <p>Quotas may be enabled or disabled on a per-filesystem basis. Quota operations require the existence of the files <code>aquota.user</code> and <code>aquota.group</code> in the root directory of the filesystem using quotas. Linux supports the use of quotas based on user and group IDs.</p> <p>Quotas for users and groups may be set for disk blocks and/or inodes. In addition, soft and hard limits may be set, as well as grace periods: Soft limits may be exceeded for a grace period. Hard limits may never be exceeded.</p> <p>Steps to set up quota: first make sure you have mounted the filesystem with the user and/or group quota mount options <code>usrquota grpquota</code> in <code>/etc/fstab</code>. Then run <code>quotacheck</code> on the filesystem to set it up. Then enable quota and use <code>edquota</code> to set limits. For example:</p> <div class=highlight><pre><span></span><code><span class=c1># add in /etc/fstab (assume /home is on a dedicated partition)</span>
/dev/sda5 /home ext4 defaults,usrquota <span class=m>1</span> <span class=m>2</span>

<span class=c1># test with the following commands:</span>
$ sudo mount -o remount /home
$ sudo quotacheck -vu /home
$ sudo quotaon -vu /home
$ sudo edquota someusername
</code></pre></div> <h3 id=filesystem-types>filesystem types<a class=headerlink href=#filesystem-types title="Permanent link">&para;</a></h3> <h4 id=ext4>ext4<a class=headerlink href=#ext4 title="Permanent link">&para;</a></h4> <p>The ext4 filesystem can support volumes up to <code>1 EB</code> and file sizes up to <code>16 TB</code>. Until very recently, ext4 was the most frequent default choice of Linux distributions, due to its excellent combination of performance, integrity, and stability.</p> <p>An <strong>extent</strong> is a group of contiguous blocks. Use of extents can improve large file performance and reduce <strong>fragmentation</strong>. Extents replace the older block mapping mechanism from ext3.</p> <p>ext4 is backwards compatible with ext3 and ext2. It can <strong>pre-allocate</strong> disk space for a file. The allocated space is usually guaranteed and <strong>contiguous</strong>. It also uses a performance technique called <strong>allocate-on-flush</strong> (delays block allocation until it writes data to disk). ext4 breaks the 32,000 subdirectory limit of ext3.</p> <p>ext4 uses <strong>checksums</strong> for the journal which improves reliability. This can also safely avoid a disk I/O wait during journalling. ext4 provides timestamps measured in nanoseconds.</p> <p>The <strong>superblock</strong> is stored in block 0 of the disk, and contains global information about the ext4 filesystem:</p> <ul> <li>Mount count and maximum mount count (every time the disk is successfully mounted, mount count is incremented; the filesystem is checked every maximum-mount-counts or every 180 days whichever comes first)</li> <li>Block size (block size can be set through the mkfs command)​</li> <li>Blocks per group</li> <li>Free block count</li> <li>Free inode count</li> <li>Operating System ID</li> </ul> <p>All fields in ext4 are written to disk in <strong>little-endian</strong> order, except the journal.</p> <p>An ext4 filesystem is split into a set of <strong>block groups</strong>. The block allocator tries to keep each file’s blocks within the same block group to reduce seek times. The default block size is 4 KB, which would create a block group of 128 MB.</p> <p>For <strong>block group 0</strong>, the first <em>1024 bytes</em> are unused (to allow for boot sectors, etc), and the superblock will start at the first block after block group 0, then followed by the <strong>group descriptors</strong> and a number of <strong>GDT</strong> (Group Descriptor Table) blocks. These are followed by the data block bitmap, the inode bitmap, the inode table, and the data blocks.</p> <p>In blocks view, they are like</p> <div class=highlight><pre><span></span><code>Super Block | Group Descriptors | Data Block Bitmap | Inode Bitmap | Inode Table (n blocks) | Data Blocks (n blocks)
</code></pre></div> <p>The first and second blocks are <strong>the same</strong> in <strong>every block group</strong>, and comprise the Superblock and the Group Descriptors. Under normal circumstances, only those in the first block group are used by the kernel; the duplicate copies are only referenced when the filesystem is being checked. If everything is OK, the kernel merely copies them over from the first block group. If there is a problem with the master copies, it goes to the next and so on until a healthy one is found and the filesystem structure is rebuilt. This <strong>redundancy</strong> makes it very difficult to thoroughly fry an ext2/3/4 filesystem.</p> <p>As an optimization, today not all block groups have a copy of the superblock and group descriptors. To view which block holds backups use <code>dumpe2fs</code>.</p> <p>Use the <code>dumpe2fs</code> program to get information about a particular partition, such as limits, capabilities, flags, and other attributes.</p> <p><code>tune2fs</code> can be used to change filesystem parameters. Use <code>-l</code> to list the contents of the superblock (same as global information from <code>dumpe2fs</code>).</p> <h4 id=xfs>xfs<a class=headerlink href=#xfs title="Permanent link">&para;</a></h4> <p>The xfs filesystem was engineered to deal with large data sets for SGI systems, as well as handle parallel I/O tasks very effectively.</p> <p>xfs can handle up to 16 EB (exabytes) for the total filesystem and up to 8 EB for an individual file and implements methods for high performance:</p> <ul> <li>Allowing DMA (Direct Memory Access) I/O</li> <li>Guaranteeing an I/O rate</li> <li>Adjusting stripe size to match underlying RAID or LVM storage devices.</li> </ul> <p>xfs also journals quota information for fast recovery on uncleanly unmounted filesystem. xfs maintenance can be done online, for defragmenting, resizing (enlarge), and dumping/restoring</p> <p>Backup and restore can be done with <code>xfsdump</code> and <code>xfsrestore</code> utilites. xfs also supports per-directory quotas, use <code>xfs_quota</code> command. Check out more xfs-related utilities with <code>man -k xfs</code></p> <h4 id=btrfs>btrfs<a class=headerlink href=#btrfs title="Permanent link">&para;</a></h4> <p>btrfs stands for B-tree filesystem, which is intended to address the lack of pooling, snapshots, checksums, and integral multi-device spanning in other Linux filesystems such as ext4.</p> <p>One of the main features is the ability to take frequent snapshots of entire filesystems, or sub-volumes of entire filesystems in virtually no time. Because btrfs makes extensive use of COW techniques (Copy on Write), such a snapshot does not involve any more initial space for data blocks or any I/O activity except for some metadata updating.</p> <p>One can easily revert to the state described by earlier snapshots and even induce the kernel to reboot off an earlier root filesystem snapshot.</p> <p>btrfs maintains its own internal framework for adding or removing new partitions and/or physical media to existing filesystems, much as LVM (Logical Volume Management) does.</p> <h3 id=disk-encryption>disk encryption<a class=headerlink href=#disk-encryption title="Permanent link">&para;</a></h3> <p>Filesystems may be encrypted to protect them from both prying eyes and attempts to corrupt the data they contain. Encryption can be chosen at installation or incorporated later.</p> <p>It is straightforward to create and format encrypted partitions at a later time, but you cannot encrypt an already existing partition in place without a data copying operation.</p> <p>Modern Linux distributions provide block device level encryption mainly through the use of <strong>LUKS</strong> (Linux Unified Key Setup).</p> <p>LUKS is built on top of <code>cryptsetup</code> to encrypt filesystems. The general form of a command is: <code>cryptsetup [OPTION...] &lt;action&gt; &lt;action-specific&gt;</code></p> <p>Examine <code>/proc/crypto</code> to see the encryption methods your system supports, and choose one to encrypt a filesystem. Example:</p> <div class=highlight><pre><span></span><code><span class=c1># encrypt a partition using LUKS</span>
<span class=c1># (a passphrase will be prompted to enter)</span>
sudo cryptsetup luksFormat --cipher aes /dev/sdc12
<span class=c1># make the volume available (create unencrypted passthrough device)</span>
sudo cryptsetup --verbose luksOpen /dev/sdc12 SECRET
<span class=c1># format the partition</span>
sudo mkfs.ext4 /dev/mapper/SECRET
<span class=c1># mount it</span>
sudo mount /dev/mapper/SECRET /mnt
<span class=c1># unmount it</span>
sudo umount /mnt
<span class=c1># remove the volume association</span>
sudo cryptsetup --verbose luksClose SECRET
</code></pre></div> <p>To mount an encrypted filesystem at boot time, first ensure it has an entry in <code>/etc/fstab</code>, then additionally add an entry to <code>/etc/crypttab</code> (which will prompt for passphrase on boot time). Read more with <code>man crypttab</code>.</p> <h3 id=lvm>LVM<a class=headerlink href=#lvm title="Permanent link">&para;</a></h3> <p><strong>LVM</strong> (Logical Volume Management) breaks up one virtual partition into multiple chunks, each of which can be on different partitions and/or disks.</p> <p>Logical volumes are created by putting all the devices into a large <strong>pool of disk space</strong> (the <strong>volume group</strong>), and then allocating space from the pool to create a <strong>logical volume</strong>. Additional devices can be added to the logical volume at any time.</p> <p>Logical volumes have features similar to RAID devices. They can actually be built on top of a RAID device. This would give the logical volume the redundancy of a RAID device with the scalability of LVM.</p> <p>LVM makes it easy to change the size of the logical partitions and filesystems, to add more storage space, rearrange things, etc. Use of logical volumes is a mechanism for creating filesystems which can span more than one physical disk.</p> <p>LVM does create a definite additional performance cost that comes from the overhead of the LVM layer. However, even on non-RAID systems, if you use striping (splitting of data to more than one disk), you can achieve some parallelization improvements.</p> <h4 id=volume-and-volume-groups>Volume and Volume Groups<a class=headerlink href=#volume-and-volume-groups title="Permanent link">&para;</a></h4> <p>Partitions are converted to physical volumes and multiple physical volumes are grouped into volume groups; there can be more than one volume group on the system.</p> <p>Space in the volume group is divided into extents; these are 4 MB in size by default.</p> <p>Logical volumes are allocated from volume groups:</p> <ul> <li>Can be defined by the size or number of extents</li> <li>Filesystems are built on logical volumes</li> <li>Can be named anything.</li> </ul> <p>The hierarchy in layers: <code>Physical Drives -&gt; Parititions -&gt; Physical Volumes -&gt; Volume Groups -&gt; Logical Volumes -&gt; File Systems</code></p> <p>Commands to manipulate physical volumes:</p> <ul> <li><code>pvcreate</code>: Converts a partition to a physical volume.</li> <li><code>pvdisplay</code>: Shows the physical volumes being used.</li> <li><code>pvmove</code>: Moves the data from one physical volume within the volume group to others; this might be required if a disk or partition is being removed for some reason. It would then be followed by:</li> <li><code>pvremove</code>: Remove a partition from a physical volume.</li> </ul> <p>Commands to manipulate volume groups:</p> <ul> <li><code>vgcreate</code>: Creates volume groups.</li> <li><code>vgextend</code>: Adds to volume groups.</li> <li><code>vgreduce</code>: Shrinks volume groups.</li> </ul> <p>use <code>man lvm</code> to view more utilities related. There are a number of utilities that manipulate logical volumes, and a short list can be viewed with <code>ls -lF /sbin/lv*</code></p> <p>Commands to manipulate logical volumes:</p> <ul> <li><code>lvcreate</code> allocates logical volumes from within volume groups. The size can be specified either in bytes or number of extents (remember, they are 4 MB by default). Names can be anything desired.</li> <li><code>lvdisplay</code> reports on available logical volumes.</li> <li><code>lvresize</code> expands or shrinks a logical volume.<ul> <li>Some variations: <code>lvextend</code>, <code>lvreduce</code>, <code>resize2fs</code></li> </ul> </li> </ul> <h4 id=manipulate-lv>Manipulate LV<a class=headerlink href=#manipulate-lv title="Permanent link">&para;</a></h4> <p>Steps involved in setting up and using a new logical volume, as an example:</p> <div class=highlight><pre><span></span><code><span class=c1># Create partitions on disk drives.</span>
sudo fdisk /dev/sdb
<span class=c1># Create physical volumes from the partitions.</span>
sudo pvcreate /dev/sdb1
sudo pvcreate /dev/sdc1
<span class=c1># Create the volume group named &#39;vg&#39;.</span>
sudo vgcreate -s 16M vg /dev/sdb1
sudo vgextend vg /dev/sdc1
<span class=c1># Allocate logical volumes from the volume group.</span>
sudo lvcreate -L 50G -n mylvm vg
<span class=c1># Format the logical volumes.</span>
sudo mkfs -t ext4 /dev/vg/mylvm
<span class=c1># Mount the logical volumes (also update /etc/fstab as needed).</span>
sudo mkdir /mylvm
sudo mount /dev/vg/mylvm /mylvm
<span class=c1># Persistent mount on reboot, add to /etc/fstab</span>
/dev/vg/mylvm /mylvm ext4 defaults <span class=m>1</span> <span class=m>2</span>
</code></pre></div> <p>Resizing a logical volume is quick and easy compare to doing so with a physical paritition that already contains a filesystem. </p> <p>Extents for a logical volume can be added or subtracted from the logical volume, and they can come from <strong>anywhere</strong> in the volume group; they need not be from physically contiguous sections of the disk.</p> <p>When expanding a logical volume with a filesystem, you must <strong>first expand the volume</strong>, and then expand the <strong>filesystem</strong>.​ When shrinking a logical volume with a filesystem, you must first <strong>shrink the filesystem</strong>, and then shrink the <strong>volume</strong>. This is done using <code>lvresize</code>.</p> <p>As an example of shrinking: <code>sudo lvresize -r -L 20 GB /dev/VG/mylvm</code>. The <code>-r</code> option causes resizing of the filesystem at the same time as the volume size is changed. The filesystem cannot be mounted when being shrunk.</p> <p><code>sudo lvresize -r -L +100M /dev/vg/mylvm</code> to grow a logical volume, while the plus sign (+) indicates adding space. Note that you need NOT <strong>unmount</strong> the filesystem to grow it.</p> <h4 id=lvm-snapshots>LVM Snapshots<a class=headerlink href=#lvm-snapshots title="Permanent link">&para;</a></h4> <p>LVM <strong>snapshots</strong> create an exact copy of an existing logical volume. They are useful for backups, application testing, and deploying VMs (Virtual Machines). The original state of the snapshot is kept as the block map.</p> <p>Snapshots only use space for storing deltas:</p> <ul> <li>When the original logical volume changes, original data blocks are copied to the snapshot.</li> <li>If data is added to snapshot, it is stored only there.</li> </ul> <p>Use <code>-s</code> option with <code>lvcreate</code> to create snapshots, i.e. <code>lvcreate -l 128 -s -n mysnap /dev/vg/mylvm</code></p> <h3 id=raid>RAID<a class=headerlink href=#raid title="Permanent link">&para;</a></h3> <p><strong>RAID</strong> (Redundant Array of Independent Disks) spreads I/O over multiple disks. This can really increase performance in modern disk controller interfaces, such as SCSI, which can perform the work in parallel efficiently.</p> <p>RAID can be implemented either in software or in hardware. One disadvantage of using hardware RAID is that if the disk controller fails, it must be replaced by a compatible controller, which may not be easy to obtain. When using software RAID, the same disks can be attached to and work with any disk controller.</p> <p>Three essential features of RAID:</p> <ul> <li>mirroring: writing the same data to more than one disk</li> <li>striping: splitting of data to more than one disk</li> <li>parity: extra data is stored to allow problem detection and repair, yielding fault tolerance.</li> </ul> <p>RAID devices are typically created by combining partitions from several disks together to create filesystems which are larger than any one drive. Striping provides better performance by spreading the information over multiple devices so simultaneous writes are possible. Mirroring writes the same information to multiple drives, giving better redundancy.</p> <p><code>mdadm</code> is used to create and manage RAID devices, with the array name, <code>/dev/mdX</code>.</p> <h4 id=raid-levels>RAID Levels<a class=headerlink href=#raid-levels title="Permanent link">&para;</a></h4> <p>As a general rule, adding more disks improves performance.</p> <ul> <li>RAID 0 - only striping available</li> <li>RAID 1 - only mirroring</li> <li>RAID 5 - uses a rotating parity stripe, at least three disks required. Can endure one disk failure without loss of data</li> <li>RAID 6 - striped disks with dual parity, at least four disks required, and can handle two disk failures</li> <li>RAID 10 - mirrored and striped data set, at least four disks required</li> </ul> <h4 id=software-raid>Software RAID<a class=headerlink href=#software-raid title="Permanent link">&para;</a></h4> <p>The essential steps in configuring a software RAID device are:</p> <ul> <li>Create partitions on each disk (type fd in fdisk)</li> <li>Create RAID device with mdadm</li> <li>Format RAID device</li> <li>Add device to <code>/etc/fstab</code></li> <li>Mount RAID device</li> <li>Capture RAID details to ensure persistence</li> <li>Examine <code>/proc/mdstat</code> to see the RAID status</li> </ul> <p>as an example:</p> <div class=highlight><pre><span></span><code>$ sudo fdisk /dev/sdb
$ sudo fdisk /dev/sdc
$ sudo mdadm --create /dev/md0 --level<span class=o>=</span><span class=m>1</span> --raid-disks<span class=o>=</span><span class=m>2</span> /dev/sdbX /dev/sdcX
$ sudo mkfs.ext4 /dev/md0
$ sudo bash -c <span class=s2>&quot;mdadm --detail --scan &gt;&gt; /etc/mdadm.conf&quot;</span>
$ sudo mkdir /myraid
$ sudo mount /dev/md0 /myraid
$ sudo cat &gt;&gt; /etc/fstab <span class=s>&lt;&lt;EOF</span>
<span class=s>/dev/md0 /myraid ext4 defaults 0 2</span>
<span class=s>EOF</span>
</code></pre></div> <p>Use <code>mdadm -S /dev/md0</code> to stop the RAID device. Use <code>mdadm --detail /dev/mdX</code> to show the current status of a RAID device. You can also use mdmonitor, which requires configuring <code>/etc/mdadm.conf</code></p> <p>To help ensure any reduction in that redundancy is fixed as quick as possible, a hot spare can be used. To create a hot spare when creating the RAID aray, use <code>-x &lt;number_of_spares&gt;</code>, i.e. <code>sudo mdadm --create /dev/md0 -l 5 -n3 -x 1 /dev/sda8 /dev/sda9 /dev/sda10 /dev/sdb2</code></p> <p>To restore the tested drive, or a new drive in a legitimate failure situation, first remove the "faulty" member, then add the "new" member, use <code>--add --remove</code>, i.e. <code>mdadm --remove /dev/md0 /dev/sdb2; mdadm --add /dev/md0 /dev/sde2</code></p> <h2 id=kernel-services>Kernel Services<a class=headerlink href=#kernel-services title="Permanent link">&para;</a></h2> <p>Narrowly defined, Linux is only the kernel of the operating system, which includes many other components, such as libraries and applications that interact with the kernel.</p> <p>The kernel is the essential central component that connects the hardware to the software and manages system resources, such as memory and CPU time allocation among competing applications and services. It handles all connected devices using device drivers, and makes the devices available for operating system use.</p> <p>A system running only a kernel has rather limited functionality. It will be found only in dedicated and focused embedded devices.</p> <p>The main responsibilities of the kernel include:</p> <ul> <li>System initialization and boot up</li> <li>Process scheduling</li> <li>Memory management</li> <li>Controlling access to hardware</li> <li>I/O (Input/Output) between applications and storage devices</li> <li>Implementation of local and network filesystems</li> <li>Security control, both locally (such as filesystem permissions) and over the network</li> <li>Networking control</li> </ul> <h3 id=kernel-command-line>Kernel Command Line<a class=headerlink href=#kernel-command-line title="Permanent link">&para;</a></h3> <p>Various parameters are passed to the system at boot on the kernel command line, typically placed on the <code>linux</code> line in the GRUB config file, such as <code>/boot/grub</code>, or in a place like <code>/boot/efi/EFI/centos/grub.cfg</code> (however, RHEL/CentOS 8 saves in <code>/boot/grub2/grubenv</code>), which may look like</p> <div class=highlight><pre><span></span><code>linux boot/vmlinuz-4.19.0 root=UUID=7ef4e747-afae-90b4-9be8be8d0258 ro quiet crashkernel=384M-:128M

linuxefi /boot/vmlinuz-5.2.9 root=UUID=77461ee7-c34a-4c5f-b0bc-29f4feecc743 ro crashkernel=auto rhgb quiet

linux16 /boot/vmlinuz-3.19.1.0 root=UUID=178d0092-4154-4688-af24-cda272265e08 ro vconsole.keymap=us crashkernel=auto vconsole.font=latarcyrheb-sun16 rhgb quiet LANG=en_US.UTF-8
</code></pre></div> <p>Everything after the <code>vmlinuz</code> file specified is an option. Any options not understood by the kernel will be passed to <code>init</code> (pid = 1). The complete list of kernel boot parameters can be found at its <a href=https://www.kernel.org/doc/Documentation/ target=_blank>documentation</a> or using <code>man bootparam</code>.</p> <p>Use <code>cat /proc/cmdline</code> to see what command line a system was booted with.</p> <h4 id=sysctl>sysctl<a class=headerlink href=#sysctl title="Permanent link">&para;</a></h4> <p><code>sysctl</code> interface can be used to read and tune kernel parameters at run time. View kernel parameters with <code>sysctl -a</code>; each value corresponds to a particular pseudofile residing under <code>/proc/sys</code>, with directory slashes being replaced by dots.</p> <p>To apply a change at runtime:</p> <div class=highlight><pre><span></span><code>$ sudo sh -c <span class=s1>&#39;echo 1 &gt; /proc/sys/net/ipv4/ip_forward&#39;</span> <span class=c1># or execute as root user</span>
$ sudo sysctl net.ipv4.ip_forward<span class=o>=</span><span class=m>1</span>
</code></pre></div> <p>If settings are placed in <code>/etc/sysctl.conf</code> (see <code>man sysctl.conf</code> for details), settings can be fixed at boot time (and reloaded at run time with <code>sysctl -p</code>)</p> <p>Vendors put their settings in files in the <code>/usr/lib/sysctl.d/</code> directory. These can be added to or supplanted by files placed in <code>/etc/sysctl.d</code></p> <h3 id=kernel-modules>Kernel Modules<a class=headerlink href=#kernel-modules title="Permanent link">&para;</a></h3> <p>The Linux kernel makes extensive use of <strong>modules</strong>, which contain important software that can be dynamically loaded and unloaded as needed after the system starts.</p> <p>This flexibility also aids in development of new features as system reboots are almost never needed to test during development and debugging.</p> <h4 id=modprobe>modprobe<a class=headerlink href=#modprobe title="Permanent link">&para;</a></h4> <p>There are a number of utility programs that are used with kernel modules:</p> <ul> <li><code>lsmod</code> - List loaded modules.</li> <li><code>insmod</code> - Directly load modules.</li> <li><code>rmmod</code> - Directly remove modules.</li> <li><code>modprobe</code> - Load or unload modules, using a pre-built module database with dependency and location information, which does dependency modules check and loads/unloads automatically.<ul> <li>i.e. <code>modprobe e1000e</code>, <code>modprobe -r e1000e</code></li> </ul> </li> <li><code>depmod</code> - Rebuild the module dependency database.</li> <li><code>modinfo</code> - Display information about a module.</li> </ul> <p><code>modprobe</code> requires a module dependency database be updated. Use depmod to generate or update the file <code>/lib/modules/$(uname -r)/modules.dep</code></p> <p>All files in the <code>/etc/modprobe.d</code> subdirectory tree which end with the <code>.conf</code> extension are scanned when modules are loaded and unloaded using modprobe. These config files control some parameters when loading with <code>modprobe</code>. You can also disable specific modules to avoid them being loaded.</p> <p>The format of files in<code>/etc/modprobe.d</code> is simple: one command per line, with blank lines and lines starting with <code>#</code> ignored; a backslash at the end of a line causes it to continue on the next line.</p> <p>Some rules for <code>modprobe</code> to keep in mind:</p> <ul> <li>It is impossible to unload a module being used by one or more other modules</li> <li>It is impossible to unload a module that is being used by one or more processes</li> <li>When a module is loaded with modprobe, the system will automatically load any other modules that need to be loaded first</li> <li>When a module is unloaded with modprobe -r, the system will automatically unload any other modules being used by the module (if not used by other modules)</li> </ul> <p>Much information about modules can also be seen in the <code>/sys/module/&lt;module_name&gt;</code> pseudo-filesystem directory tree, such as parameters.</p> <h3 id=devices-and-udev>Devices and udev<a class=headerlink href=#devices-and-udev title="Permanent link">&para;</a></h3> <p><code>udev</code> stands for <strong>User Device management</strong>. It dynamically discovers built-in hardware as well as peripheral devices during boot time or ad-hoc plugged at run time.</p> <p>udev handles loading and unloading device drivers with proper configurations as need, including:</p> <ul> <li>Device naming</li> <li>Device file and symlink creating</li> <li>Setting file attributes</li> <li>Taking other needed actions (such as execute a program)</li> </ul> <p>udev runs as a daemon (either udevd or systemd-udevd) and monitors a netlink socket. When new devices are initialized or removed, the uevent kernel facility sends a message through the socket, which udev receives and takes appropriate action to create or remove device nodes of the right names and properties according to the rules.</p> <p>The three components of udev are:</p> <ul> <li>The <code>libudev</code> library which allows access to information about the devices</li> <li>The <code>udevd</code> or systemd-udevd daemon that manages the <code>/dev</code> directory</li> <li>The <code>udevadm</code> utility for control and diagnostics</li> </ul> <p>The main configuration file is <code>/etc/udev/udev.conf</code>. It contains information such as where to place device nodes, default permissions and ownership, etc</p> <h4 id=udev-rules>udev rules<a class=headerlink href=#udev-rules title="Permanent link">&para;</a></h4> <p>When devices are added or removed from the system, udev receives a message from the kernel. It then parses the rules files under <code>/etc/udev/rules.d</code>, <code>/run/udev/rules.d</code>, or <code>/usr/lib/udev/rules.d</code> for actions. A rules file may look like <code>60-persistent-storage.rules</code>.</p> <p>There are two separate parts defined on a single line:</p> <ul> <li>one or more match pairs denoted by <code>==</code>. These try to match a device’s attributes and/or characteristics to some value.</li> <li>one or more assignment key-value pairs that assign a value to a name, such as a file name, assignment, even file permissions, etc.</li> </ul> <p>The format for a udev rule is simple: <code>&lt;match&gt;&lt;op&gt;value [, ...] &lt;assignment&gt;&lt;op&gt;value [, ... ]</code>. If no matching rule is found, it uses the default device node name and other attributes. Example of a rules file:</p> <div class=highlight><pre><span></span><code>$ cat /etc/udev/rules.d/60-vboxdrv.rules
KERNEL==&quot;vboxdrv&quot;, NAME=&quot;vboxdrv&quot;, OWNER=&quot;root&quot;, GROUP=&quot;vboxusers&quot;, MODE=&quot;0660&quot;
KERNEL==&quot;vboxdrvu&quot;, NAME=&quot;vboxdrvu&quot;, OWNER=&quot;root&quot;, GROUP=&quot;root&quot;, MODE=&quot;0666&quot;
KERNEL==&quot;vboxnetctl&quot;, NAME=&quot;vboxnetctl&quot;, OWNER=&quot;root&quot;, GROUP=&quot;vboxusers&quot;, MODE=&quot;0660&quot;
SUBSYSTEM==&quot;usb_device&quot;, ACTION==&quot;add&quot;, RUN+=&quot;/usr/lib/virtualbox/VBoxCreateUSBNode.sh $major $minor $attr{bDeviceClass}&quot;
SUBSYSTEM==&quot;usb&quot;, ACTION==&quot;add&quot;, ENV{DEVTYPE}==&quot;usb_device&quot;, RUN+=&quot;/usr/lib/virtualbox/VBoxCreateUSBNode.sh $major $minor $attr{bDeviceClass}&quot;
</code></pre></div> <p>System administrators can control how udev operates and craft special udev rules.</p> <h4 id=device-nodes>Device Nodes<a class=headerlink href=#device-nodes title="Permanent link">&para;</a></h4> <p><strong>Device nodes</strong> are used by programs to communicate with devices through nodes using normal I/O methods. Character and block devices have device nodes; network devices do not.</p> <p>A device driver may use multiple device nodes. Device nodes are located in the <code>/dev</code> directory. Device nodes can be created with: <code>sudo mknod [-m mode] /dev/name &lt;type&gt; &lt;/major&gt; &lt;minor&gt;</code></p> <p>The major and minor numbers identify the driver associated with the device, with the driver uniquely reserving a group of numbers. In most cases, device nodes of the same type (block or character) with the same major number use the same driver.</p> <p>The major and minor numbers appear in the same place that file size would when looking at a normal file with <code>ls</code>. The minor number is used only by the device driver to differentiate between the different devices it may control, or how they are used. These may either be different instances of the same kind of device, (such as the first and second sound card, or hard disk partition) or different modes of operation of a given device (such as different density floppy drive media).</p> <p><strong>Device numbers</strong> have meaning in user-space as well. Two system calls, <code>mknod()</code> and <code>stat()</code>, return information about major and minor numbers.</p> <h2 id=virtualization>Virtualization<a class=headerlink href=#virtualization title="Permanent link">&para;</a></h2> <p><strong>Virtual Machines</strong> are a virtualized instance of an entire operating system, and may fulfill the role of a server or a desktop/workstation. The outside world sees the VM as if it were an actual physical machine, present somewhere on the network. Applications running in the VM are generally unaware of their non-physical environment.​</p> <p>Other kinds of virtualization:</p> <ul> <li><strong>Network</strong> - The details of the actual physical network, such as the type of hardware, routers, etc., are abstracted and need not be known by software running on it and configuring it.</li> <li><strong>Storage</strong> - Multiple network storage devices are configured to look like one big storage unit, such as a disk. Examples: Network Attached Storage or NAS.</li> <li><strong>Application</strong> - An application is isolated into a standalone format, such as a container</li> </ul> <p>Virtualization is developed and evolving for several reasons:</p> <ul> <li>Enables better hardware utilization</li> <li>Operating systems often progress more quickly than hardware</li> <li>It is microcode-driven</li> <li>CPUs enhanced to support virtualization led to a boost in performance, easier configuration, and more flexibility in VM installation and migration</li> </ul> <p>From early mainframes to mini-computers, virtualization has been used for expanding limits, debugging and administration enhancements.</p> <p>A host is the underlying physical operating system managing one or more virtual machines. A guest is the VM which is an instance of a complete operating system, running one or more applications. The guest should not care what host it is running on and can be migrated from one host to another.</p> <p>Low-level performance tuning on areas such as CPU utilization, networking throughput, memory utilization, is often best done on the host, while application tuning will be done mostly on the guest.</p> <h3 id=emulation>Emulation<a class=headerlink href=#emulation title="Permanent link">&para;</a></h3> <p>The first implementations of virtualization on the PC architecture were through the use of <strong>emulators</strong>. An Emulator runs completely in software. It is useful for running virtual machines on different architectures, such as running a pretend ARM guest machine on an X86 host. Performance is relatively slow.</p> <h3 id=hypervisors>Hypervisors<a class=headerlink href=#hypervisors title="Permanent link">&para;</a></h3> <p>The host system acts as the <strong>hypervisor</strong> that initiates, terminates, and manages guests. It also called <strong>Virtual Machine Monitor</strong> (VMM). Two basic methods of virtualization:</p> <ul> <li><strong>hardware virtualization</strong> - The guest system runs without being aware it is running as a virtualized guest, and does not require modifications to be run in this fashion. ​It is also known as Full Virtualization.</li> <li><strong>para-virtualization</strong> - The guest system is aware it is running in a virtualized environment, and has been modified specifically to work with it.</li> </ul> <p>You can check directly if your CPU supports hardware virtualization extensions by looking at <code>/proc/cpuinfo</code>; if you have an IVT-capable chip, you will see vmx in the flags field; and, if you have an AMD-V capable chip, you will see svm in the same field. You may also have to ensure the virtualization capability is turned on in your CMOS.</p> <p>The hypervisor can be:</p> <ul> <li>External to the host operating system kernel: VMware</li> <li>Internal to the host operating system kernel: KVM</li> </ul> <p>Going past Emulation, the merging of the hypervisor program into a specially-designed lightweight kernel was the next step in the Virtualization deployment. i.e. the <strong>KVM project</strong> added hypervisor capabilities into the Linux kernel. Specific CPU chip functions and facilities were required and deployed for this type of virtualization.​</p> <h3 id=libvirt>libvirt<a class=headerlink href=#libvirt title="Permanent link">&para;</a></h3> <p>The <a href=https://www.libvirt.org/ target=_blank><code>libvirt</code> project</a> is a toolkit to interact with virtualization technologies. It provides management for virtual machines, virtual networks, and storage, and is available on all enterprise Linux distributions.</p> <h3 id=kvm>KVM<a class=headerlink href=#kvm title="Permanent link">&para;</a></h3> <p>KVM uses the Linux kernel for computing resources, including memory management, scheduling, synchronization, and more. When running a virtual machine, KVM engages in a co-processing relationship with the Linux kernel.</p> <p>Managing KVM can be done with command line tools include: <code>virt-*</code> and <code>qemu-*</code>. Graphical interfaces include <code>virt-manager, kimchi, OpenStack, oVirt</code>, etc.</p> <h3 id=containers>Containers<a class=headerlink href=#containers title="Permanent link">&para;</a></h3> <p>Further integration between the hypervisor and the Linux kernel allowed the creation of operating system-level virtual machines, or containers.</p> <p><strong>Containers</strong> share many facilities in the Linux kernel, and make use of <strong>namespaces</strong> and <strong>cgroups</strong>. Containers are very lightweight and reduce the overhead associated with having whole virtual machines.</p> <p><strong>OS container</strong> is a flavor that runs an image of an operating system with the ability to run init processes and spawn multiple applications. i.e. LXC (Linux Containers)</p> <p><strong>Application virtualization</strong> runs one application for each container. Many single application containers are typically initialized on a single machine which creates a greater flexibility and reduces overhead normally associated with virtualization.</p> <p>Virtual machines run a complete operating system, and can run many services and applications. Virtual machines use more resources than a container. ​Containers usually run one thing. Containers are more portable, and can be run inside a VM.</p> <p>Scaling workloads is different for containers and virtual machines. Orchestration systems such as Kubernetes or Mesos can decide on the proper quantity of containers needed, do load balancing, replicate images and remove them, etc., as needed.</p> <h4 id=docker>Docker<a class=headerlink href=#docker title="Permanent link">&para;</a></h4> <p><strong>Docker</strong> is an application-level virtualization using many individual images to build up the necessary services to support the target application. These images are packaged into containers - they are components in containers. Images may contain:</p> <ul> <li>Application code​</li> <li>Runtime libraries​</li> <li>System tools​</li> <li>​Or just about anything required for an application</li> </ul> <p>Images may reside on a Docker Hub or a registry server. An application can be packaged up with all of its dependent code and services and deployed as a single unit with the minimum of overhead. This deployment can be easily repeated as often as desired.</p> <h4 id=podman>Podman<a class=headerlink href=#podman title="Permanent link">&para;</a></h4> <p>RHEL8/CentOS8 have replaced pure docker with podman. Podman uses a child/parent forking model for container creation and management, while Docker uses a server/client model with a daemon running in background for management. Emulation layer enables backwards compatibility with docker commands. Promised benefits include better security and less overhead.</p> <h2 id=account-management>Account Management<a class=headerlink href=#account-management title="Permanent link">&para;</a></h2> <p>Linux systems provide a multi-user environment which permits people and processes to have separate simultaneous working environments:</p> <ul> <li>Providing each user with their own individualized private space</li> <li>Creating particular user accounts for specific dedicated purposes</li> <li>Distinguishing privileges among users</li> </ul> <h3 id=user-accounts>User Accounts<a class=headerlink href=#user-accounts title="Permanent link">&para;</a></h3> <p>Normal user accounts are for people who will work on the system. Some user accounts (like the daemon account) exist for the purpose of allowing processes to run as a user other than root. Each user on the system has a corresponding line in the <code>/etc/passwd</code> file that describes their basic account attributes.</p> <p>A line in <code>/etc/passwd</code> consists of: user name, user password (use <code>/etc/shadow</code> if value is <code>x</code>), UID, GID, comment, home directory, login shell</p> <p>Add user with <code>sudo useradd &lt;username&gt;</code>, which will create an account using default algorithms for assigning <strong>user and group id</strong>, home directory, and shell choice; the defaults can easily be overruled by using options to <code>useradd</code>. i.e. <code>sudo useradd dexter</code> will:</p> <ul> <li>The next available UID greater than <em>UID_MIN</em> (specified in <code>/etc/login.defs</code>) by default is assigned as dexter's UID.<ul> <li>The convention most Linux distributions have used is that any account with a user ID less than 1000 is considered special and belongs to the system; normal user accounts start at 1000 (UID_MIN defined in <code>/etc/login.defs</code>)</li> </ul> </li> <li>A group called dexter with a GID=UID is also created and assigned as dexter's primary group.<ul> <li>aka <strong>Primary Group ID</strong>, and sometimes called User Private Groups (UPG)</li> </ul> </li> <li>A home directory <code>/home/dexter</code> is created and owned by dexter.</li> <li>dexter's login shell will be <code>/bin/bash</code>.</li> <li>The contents of <code>/etc/skel</code> is copied to <code>/home/dexter</code>. By default, <code>/etc/skel</code> includes startup files for bash and for the X Window system.</li> <li>An entry of either <code>!!</code> or <code>!</code> is placed in the password field of the <code>/etc/shadow</code> file for dexter's entry, thus requiring the administrator to assign a password for the account to be usable.</li> </ul> <p>Use of <code>/etc/shadow</code> enables password aging on a per user basis. At the same time, it also allows for maintaining greater security of hashed passwords since it has permission 400 while <code>/etc/passwd</code> has permission 644.</p> <p>/etc/shadow contains one record (one line) for each user, such as <code>daemon:*:16141:0:99999:7:::</code>. The colon-separated fields are:</p> <ul> <li>username: unique user name</li> <li>password: the hashed (sha512) value of the password</li> <li>lastchange: date that password was last changed</li> <li>mindays: minimum days before password can be changed</li> <li>maxdays: maximum days after which password must be changed</li> <li>warn: days before password expires that the user is warned</li> <li>grace: days after password expires that account is disabled</li> <li>expire: date that account is/will be disabled</li> <li>reserved: reserved field</li> </ul> <p>Note the <em>dates</em> are stored as the number of days since Jan. 1, 1970 (the epoch date). The username in each record must match exactly that found in <code>/etc/passwd</code>, and also must appear in the <strong>identical order</strong>. The password hash is the string <code>"$6$"</code> followed by an <em>eight-character</em> <strong>salt value</strong>, which is then followed by a <code>$</code> and an <em>88-character</em> (sha512) password hash.</p> <p>Additionally, <strong><code>userdel</code></strong> is used to remove user accounts, and <strong><code>usermod</code></strong> is used to change characteristics of a user account.</p> <p>You can lock a user account to prevent login by <code>usermod -L &lt;username&gt;</code> (and unlock with <code>-U</code> option). Linux ships with some system accounts that are locked (such as bin, daemon, or sys), which means they can run programs, but can never login to the system and have no valid password associated with them. These accounts has <code>/sbin/nologin</code> as their login shell. Attempt to login will show message from <code>/etc/nologin.txt</code>.</p> <p>You can also lock a user account by setting an expiration date on an account, with <code>chage</code>: <code>chage [-m mindays] [-M maxdays] [-d lastday] [-I inactive] [-E expiredate] [-W warndays] user</code>. i.e. <code>sudo chage -E 2014-09-11 morgan</code>. Only the root user can use <code>chage</code>. Normal user can run <code>chage -l</code> to check when their password or account will expire.</p> <p>Passwords can be changed with <code>passwd</code>; a normal user can change only their own password, while root can change any user password. </p> <h4 id=sudoers>Sudoers<a class=headerlink href=#sudoers title="Permanent link">&para;</a></h4> <p>The <code>/etc/sudoers</code> defines the sudo access. Usually you don't need to temper with this file and just add new user to the <code>sudo</code> group to grant sudo access.</p> <p>The file has default access mode of 400. To do quick edit, use <code>sudo visudo</code>. The syntax of lines in the <code>/etc/sudoers</code> file is <code>users hosts=(user:group) commands</code>, where <code>group</code> can be omitted.</p> <p>You should use drop-ins under <code>/etc/sudoers.d/</code> to add additional sudoer access, and leave the main sudoers file unchanged.</p> <h4 id=account-restriction>Account Restriction<a class=headerlink href=#account-restriction title="Permanent link">&para;</a></h4> <p>One can set restricted shell as login shell <code>/bin/rbash</code>, which is equivalent to <code>/bin/bash -r</code>. It:</p> <ul> <li>Prevents the user from using <code>cd</code> to change directories.</li> <li>Prevents setting the <code>SHELL, ENV or PATH</code> environment variables.</li> <li>Prohibits specifying <strong>path or command</strong> names containing <code>/</code>.</li> <li>Restricts <strong>redirection</strong> of output and/or input.</li> </ul> <p>However, it is fairly easy to defeat the restricted shell. Read more at <a href=https://www.metahackers.pro/breakout-of-restricted-shell/ target=_blank>"Escaping Restricted Shell rbash"</a> and <a href=https://www.exploit-db.com/docs/english/44592-linux-restricted-shell-bypass-guide.pdf target=_blank>"Linux Restricted Shell Bypass"</a></p> <p>You can also set up restricted user account which:</p> <ul> <li>Uses the restricted shell</li> <li>Limits available system programs and user applications</li> <li>Limits system resources</li> <li>Limits access times</li> <li>Limits access locations</li> </ul> <p>When the restricted shell is invoked, it executes $HOME/.bash profile without restriction. This is why the user must not have either write or execute permissions on the home directory.</p> <p>Make sure that when you set up such an account that you do NOT inadvertently add <strong>system directories</strong> to the PATH environment variable, because this allows the restricted user the ability to execute other system programs, such as an unrestricted shell.</p> <p>By default, root logins through the network are generally prohibited for security reasons. It is generally recommended that all root access be through <code>su</code>, or <code>sudo</code> (causing an audit trail of all root access through <code>sudo</code>). PAM (Pluggable Authentication Modules) can also be used to restrict which users are allowed to <code>su</code> to root. It might also be worth it to configure auditd to log all commands executed as root.</p> <h4 id=ssh>ssh<a class=headerlink href=#ssh title="Permanent link">&para;</a></h4> <p><strong>SSH</strong> (Secure SHell) exists for the needs to login through the network into a remote system, or to transfer files to and from a remote machine.</p> <p>User-specific ssh configuration files are created under every user's home directory in the hidden <code>.ssh</code> directory. Within the directory:</p> <ul> <li><code>id_rsa</code>: The user's private encryption key</li> <li><code>id_rsa.pub</code>: The user's public encryption key</li> <li><code>authorized_keys</code>: A list of public keys that are permitted to login</li> <li><code>known_hosts</code>: A list of hosts from which logins have been allowed in the past</li> <li><code>config</code>: A configuration file for specifying various options</li> </ul> <p>First, a user has to generate their private and public encryption keys with <code>ssh-keygen</code>. The private keys must never be shared. The public key, however, should be given to any machine with which you want to permit <strong>password-less access</strong>. It should also be added to your authorized_keys file, together with all the public keys from other users who have accounts on your machine and you want to permit password-less access to their accounts.</p> <h3 id=group-accounts>Group Accounts<a class=headerlink href=#group-accounts title="Permanent link">&para;</a></h3> <p>Linux systems form collections of users called <strong>groups</strong> which share some common purpose, and share certain files and directories and maintain some common privileges. </p> <p>Groups are defined in <code>/etc/group</code>, which has the same role for groups as <code>/etc/passwd</code> has for users. Each line of the file looks like: <code>groupname:password:GID:user1,user2,...</code>. A Linux user has one primary group; this is listed in /etc/passwd and will also be listed in <code>/etc/group</code>. A user may belong to between 0 and 15 secondary groups.</p> <p>Group passwords may be set, but only if <code>/etc/gshadow</code> exists. GID is the group identifier. Values between 0 and 99 are for system groups. Values between 100 and GID_MIN (as defined in <code>/etc/login.defs</code> and usually the same as UID_MIN) are considered special. Values over GID_MIN are for UPG (User Private Groups)</p> <h4 id=group-management>Group Management<a class=headerlink href=#group-management title="Permanent link">&para;</a></h4> <p>Group accounts may be managed and maintained with:</p> <ul> <li><code>groupadd</code>: Add a new group.</li> <li><code>groupmod</code>: Modify a group and add new users.</li> <li><code>groupdel</code>: Remove a group.</li> <li><code>usermod</code>: Manage a user's group memberships by giving a complete list of groups, or add new group memberships<ul> <li>Note you will have to log out and log back in again for the new group membership to be effective.</li> </ul> </li> </ul> <p>Group membership can be identified by running either of the following commands: <code>groups [user1 user2 ...]</code> or <code>id -Gn [user1 user2 ...]</code></p> <h4 id=user-private-groups>User Private Groups<a class=headerlink href=#user-private-groups title="Permanent link">&para;</a></h4> <p>Each user will have his or her own group, and additional members may be added to someone's private group in <code>/etc/group</code>. By default, users whose accounts are created with useradd have: primary GID = UID and the group name is also identical to the user name.</p> <p>As specified in <code>/etc/profile</code>, the umask is set to 002 for all users created with UPG. Under this scheme, user files are thus created with permissions 664 (rw-rw-r--) and directories with 775 (rwxrwxr-x).</p> <h3 id=file-permissions-and-ownership>File permissions and Ownership<a class=headerlink href=#file-permissions-and-ownership title="Permanent link">&para;</a></h3> <p>When viewing file permission with <code>ls -l a_file</code>, i.e. <code>-rw-rw-r-- 1 coop aproject 1601 Mar 9 15:04 a_file</code>. There are nine more which indicate the access rights granted to potential file users, with each three characters grouped as a triplet.</p> <ul> <li>owner: the user who owns the file (also called user)</li> <li>group: the group of users who have access</li> <li>other: the rest of the world (also called world)</li> </ul> <p>Each of the triplets can have each of the following sets:</p> <ul> <li>r: read access is allowed</li> <li>w: write access is allowed</li> <li>x: execute access is allowed</li> </ul> <p>In addition, other specialized permissions exist for each category, such as the setuid/setgid permissions. Any request to access a file requires comparison of the credentials and identity of the requesting user to those of the owner of the file.</p> <h4 id=manage-permissions-and-ownership>Manage permissions and ownership<a class=headerlink href=#manage-permissions-and-ownership title="Permanent link">&para;</a></h4> <p>Changing file permissions is done with <code>chmod</code>. Permissions can be represented either as a bitmap, usually written in octal, or in a symbolic form. Octal bitmaps usually look like <code>0755</code>, while symbolic representations look like <code>u+rwx, g+rwx, o+rx</code>.</p> <p>The octal number representation is the sum for each digit of:</p> <ul> <li>4 if the read permission is desired</li> <li>2 if the write permission is desired</li> <li>1 if execute permission is desired</li> </ul> <p>Changing the group is done with <code>chgrp</code>. You can only change group ownership to groups that you are a member of. One can change file ownership and group ownership at the same time with <code>chown</code>. The option <code>-R</code> applies the change recursively</p> <h4 id=umask>umask<a class=headerlink href=#umask title="Permanent link">&para;</a></h4> <p>The <strong>default permissions</strong> given when creating a <strong>file</strong> are read/write for owner, group and world <strong>(0666)</strong>, and for a <strong>directory</strong> it is read/write/execute for everyone <strong>(0777)</strong>. </p> <p>However, the actual permissions have changed to 664 for the file and 775 for the directory as they have been modified by the current <code>umask=002</code> whose purpose is to show which permissions should be denied.</p> <p>You can change the <code>umask</code> at any time with the <code>umask</code> command; which is the most conventional value set by system administrators for users. This value is combined with the file creation permissions to get the actual result; i.e., <code>0666 &amp; ~002 = 0664; i.e., rw-rw-r--</code></p> <h4 id=filesystem-acls>Filesystem ACLs<a class=headerlink href=#filesystem-acls title="Permanent link">&para;</a></h4> <p>POSIX ACLs (Access Control Lists) extend the simpler user, group, and world system, by granting privileges to specific users or groups of users when accessing certain objects or classes of objects. Files and directories can be shared without using 777 permissions.</p> <p>All major filesystems used in modern Linux distributions incorporate the ACL extensions, and one can use the option -acl when mounting. A default set of ACLs is created at system install.</p> <p>Use <code>getfacl/setfacl</code> to get/set ACLs. New files <strong>inherit</strong> the default ACL (if set) from the <strong>directory</strong> they reside in. Also <code>mv</code> and <code>cp -p</code> preserve ACLs.</p> <h2 id=pluggable-authentication-modules-pam>Pluggable Authentication Modules (PAM)<a class=headerlink href=#pluggable-authentication-modules-pam title="Permanent link">&para;</a></h2> <p>Historically, authentication of users was performed individually by individual applications; i.e., su, login, and ssh would each authenticate and establish user accounts independently of each other.</p> <p>Most modern Linux applications have been written or rewritten to exploit PAM so that authentication can be done in one uniform way, using <code>libpam</code>.</p> <p>PAM incorporates the following concepts:</p> <ul> <li>PAM-aware applications</li> <li>Configuration files in <code>/etc/pam.d/</code></li> <li>PAM modules in the <code>libpam*</code> libraries, which can be found in different locations depending on the Linux distribution</li> </ul> <h3 id=pam-rules>PAM Rules<a class=headerlink href=#pam-rules title="Permanent link">&para;</a></h3> <p>Each file in <code>/etc/pam.d/</code> corresponds to a service and each (non-commented) line in the file specifies a rule. The rule is formatted as a list of space-separated tokens, the first two of which are case insensitive: <code>type control module-path module-arguments</code></p> <p>The <code>type</code> controls the step of the authentication process:</p> <ul> <li>auth: Instructs the application to <strong>prompt</strong> the user for identification (username, password, etc). May set credentials and grant privileges.</li> <li>account: Checks on aspects of the user's account, such as password aging, access control, etc.</li> <li>password: Responsible for updating the user <strong>authentication token</strong>, usually a password.</li> <li>session: Used to provide <strong>functions</strong> before and after the session is established (such as setting up environment, logging, etc.)</li> </ul> <p>The <code>control</code> flag controls how the success or failure of a module affects the overall authentication process:</p> <ul> <li>required: Must return success for the service to be granted. If part of a stack, all other modules are still executed. Application is not told which module or modules failed.</li> <li>requisite: Same as required, except a failure in any module terminates the stack and a return status is sent to the application.</li> <li>optional: Module is not required. If it is the only module, then its return status to application may cause failure.</li> <li>sufficient: If this module succeeds, then no subsequent modules in the stack are executed. If it fails, then it doesn't necessarily cause the stack to fail, unless it is the only one in the stack.</li> </ul> <h3 id=ldap-authentication>LDAP Authentication<a class=headerlink href=#ldap-authentication title="Permanent link">&para;</a></h3> <p>The <strong>Lightweight Directory Access Protocol</strong> (LDAP) is an industry standard protocol for using and administering distributed directory services <strong>over the network</strong>, and is meant to be both open and vendor-neutral.</p> <p>With LDAP, each system (or client) connects to a centralized LDAP server for user authentication. Using Transport Layer Security (TLS) makes it a secure option and is recommended.</p> <p>When you configure a system for LDAP authentication, five files are changed:</p> <div class=highlight><pre><span></span><code>/etc/openldap/ldap.conf
/etc/pam_ldap.conf
/etc/nslcd.conf
/etc/sssd/sssd.conf
/etc/nsswitch.conf
</code></pre></div> <p>You can edit these files manually or use one of the utility programs available (<code>system-config-authentication</code> or <code>authconfig-tui</code>).</p> <h2 id=network>Network<a class=headerlink href=#network title="Permanent link">&para;</a></h2> <h3 id=network-addresses>Network Addresses<a class=headerlink href=#network-addresses title="Permanent link">&para;</a></h3> <p>The IP address is the number that identifies your system on the network. IP addresses are used to uniquely identify nodes across the internet. They are registered through ISPs (Internet Service Providers).</p> <p>IPv4 is a 32-bit address, composed of 4 octets (an octet is just 8 bits, or a byte); IPv6 is a 128-bit address, composed of 8 16-bit octet pairs. In either case, a set of reserved addresses is also included.</p> <h3 id=ipv4-address-types>IPv4 Address Types<a class=headerlink href=#ipv4-address-types title="Permanent link">&para;</a></h3> <ul> <li><strong>Unicast</strong> - An address associated with a specific host. i.e. <code>140.211.169.4</code></li> <li><strong>Network</strong> - An address whose host portion is set to all binary zeroes. i.e. <code>192.168.1.0</code></li> <li><strong>Broadcast</strong> - An address to which each member of a particular network will listen. i.e. <code>172.16.255.255</code></li> <li><strong>Multicast</strong> - An address to which appropriately configured nodes will listen. Only nodes specifically configured to pay attention to a specific multicast address will interpret packets for that multicast group</li> </ul> <h4 id=reserved-ipv4-addresses>Reserved IPv4 Addresses<a class=headerlink href=#reserved-ipv4-addresses title="Permanent link">&para;</a></h4> <p>Certain addresses and address ranges are <strong>reserved</strong> for special purposes:</p> <ul> <li>127.x.x.x - Reserved for the loopback (local system) interface</li> <li>0.0.0.0 - Used by systems that <strong>do NOT yet know</strong> their own address. Protocols like DHCP and BOOTP use this address when attempting to communicate with a server.</li> <li>255.255.255.255 - Generic broadcast private address, reserved for internal use. These addresses are never assigned or registered to anyone. They are generally not routable.</li> <li>Others<ul> <li>10.0.0.0 - 10.255.255.255</li> <li>172.16.0.0 - 172.31.255.255</li> <li>192.168.0.0 - 192.168.255.255</li> <li>etc.</li> </ul> </li> </ul> <h4 id=ipv4-address-classes>IPv4 Address Classes<a class=headerlink href=#ipv4-address-classes title="Permanent link">&para;</a></h4> <p>Historically, IP addresses are based on defined classes. Classes A, B, and C are used to distinguish a network portion of the address from a host portion of the address, for routing purposes.</p> <table> <thead> <tr> <th>Network Class</th> <th>Highest order octet range</th> <th>Notes</th> </tr> </thead> <tbody> <tr> <td>A</td> <td>1-127</td> <td>networks, 16,772,214 hosts per network, 127.x.x.x reserved for loopback</td> </tr> <tr> <td>B</td> <td>128-191</td> <td>16,384 networks, 65,534 hosts per network</td> </tr> <tr> <td>C</td> <td>192-223</td> <td>2,097,152 networks, 254 hosts per network</td> </tr> <tr> <td>D</td> <td>224-239</td> <td>Multicast addresses</td> </tr> <tr> <td>E</td> <td>240-254</td> <td>Reserved address range</td> </tr> </tbody> </table> <h3 id=ipv6-address-types>IPv6 Address Types<a class=headerlink href=#ipv6-address-types title="Permanent link">&para;</a></h3> <ul> <li>Unicast - a packet is delivered to one interface<ul> <li>link-local - Auto-configured for every interface to have one. Non-routable.</li> <li>global - Dynamically or manually assigned. Routable.</li> <li>or reserved for documentation</li> </ul> </li> <li>Multicast - a packet is delivered to multiple interfaces</li> <li>Anycast - a packet is delivered to the nearest of multiple interfaces in terms of routing distance</li> <li>IPv4-mapped - an IPv4 address mapped to IPv6, i.e. <code>::FFFF:a.b.c.d/96</code></li> </ul> <p>IPv6 has some special types of addresses such as loopback, which is assigned to the lo interface, as <code>::1/128</code>.</p> <h3 id=netmasks>Netmasks<a class=headerlink href=#netmasks title="Permanent link">&para;</a></h3> <p><strong>Netmask</strong> is used to determine how much of the address is used for the network portion and how much for the host portion as we have seen. It is also used to determine network and broadcast addresses.</p> <table> <thead> <tr> <th>Network Class</th> <th>Decimal</th> <th>Hex</th> <th>Binary</th> </tr> </thead> <tbody> <tr> <td>A</td> <td>255.0.0.0</td> <td>ff:00:00:00</td> <td>11111111 00000000 00000000 00000000</td> </tr> <tr> <td>B</td> <td>255.255.0.0</td> <td>ff:ff:00:00</td> <td>11111111 11111111 00000000 00000000</td> </tr> <tr> <td>C</td> <td>255.255.255.0</td> <td>ff:ff:ff:00</td> <td>11111111 11111111 11111111 00000000</td> </tr> </tbody> </table> <p>The network address is obtained by <strong>logical AND</strong>ing (<code>&amp;</code>) the <strong>IP address</strong> with the <strong>netmask</strong>. We are interested in the network addresses because they define a local network which consists of a collection of nodes connected via the same media and <strong>sharing</strong> the same network address. All nodes on the same network can <strong>directly see each other</strong>. For example:</p> <div class=highlight><pre><span></span><code>  172.16.2.17 ip address
&amp; 255.255.0.0 netmask
-----------------------------
  172.16.0.0 network address
</code></pre></div> <h3 id=hostname>hostname<a class=headerlink href=#hostname title="Permanent link">&para;</a></h3> <p>The hostname is simply a label to distinguish a networked device from other nodes. The hostname is generally specified at installation time, and can be modified at any time later. The hostname for a machine can be checked with command <code>hostname</code>.</p> <p>To change hostname only once before next reboot, just execute <code>sudo hostname &lt;new_hostname&gt;</code>; to change it persistently, do <code>sudo hostnamectl set-hostname &lt;new_hostname&gt;</code>.</p> <p>Hostname configuration is stored under <code>/etc/</code>. On Red Hat-based systems this was <code>/etc/sysconfig/network</code>, on Debian-based systems this was <code>/etc/hostname</code> and on SUSE-based systems it was <code>/etc/HOSTNAME</code>.</p> <p>For <strong>DNS</strong> purposes, hostnames are appended with a <strong>period</strong> (dot) and a <strong>domain name</strong>, so that a machine with a hostname of antje could have a <strong>fully qualified domain name</strong> (FQDN) of antje.linuxfoundation.org.</p> <h2 id=network-devices-and-configs>Network Devices and Configs<a class=headerlink href=#network-devices-and-configs title="Permanent link">&para;</a></h2> <h3 id=network-devices>network devices<a class=headerlink href=#network-devices title="Permanent link">&para;</a></h3> <p>Unlike block and character devices, network devices are not associated with special device files (aka device nodes). <strong>Network devices</strong> are known by their names, which usually consist of a type identifier followed by a number:</p> <ul> <li><code>eth0, eth1, eno1, eno2, etc.</code>, for ethernet devices.</li> <li><code>wlan0, wlan1, wlan2, wlp3s0, wlp3s2, etc.</code>, for wireless devices.</li> <li><code>br0, br1, br2, etc.</code>, for bridge interfaces.</li> <li><code>vmnet0, vmnet1, vmnet2, etc.</code>, for virtual devices for communicating with virtual clients</li> </ul> <p>Historically, multiple virtual devices could be associated with single physical devices; these were named with colons and numbers; so, eth0:0 would be the first alias on the eth0 device. This was done to support multiple IP addresses on one network card, but deprecated today. It is also not compatible with IPv6.</p> <h3 id=ip>ip<a class=headerlink href=#ip title="Permanent link">&para;</a></h3> <p><code>ip</code> is the command line utility used to configure, control and query interface parameters and control devices, routing, etc. It is more efficient and versatile than <code>ifconfig</code> because it uses <code>netlink</code> sockets, rather than <code>ioctl()</code> system calls.</p> <p><code>ip</code> basic syntax is <code>ip [ OPTIONS ] OBJECT { COMMAND | help }</code>. It can also be used with <code>ip [ -force ] -batch filename</code> to process commands from a file. The <code>OBJECT</code> argument describes what kind of action is going to be performed; the <code>COMMANDS</code> depends on the OBJECT selected:</p> <table> <thead> <tr> <th>OBJECT</th> <th>Function</th> </tr> </thead> <tbody> <tr> <td>address</td> <td>IPv4 or IPv6 protocol device address</td> </tr> <tr> <td>link</td> <td>Network Devices</td> </tr> <tr> <td>maddress</td> <td>Multicast Address</td> </tr> <tr> <td>monitor</td> <td>Watch for netlink messages</td> </tr> <tr> <td>route</td> <td>Routing table entry</td> </tr> <tr> <td>rule</td> <td>Rule in the routing policy database</td> </tr> <tr> <td>tunnel</td> <td>Tunnel over IP</td> </tr> </tbody> </table> <p>Some examples of using <code>ip</code>:</p> <ul> <li><code>$ ip link show</code> - Show information for all network interfaces</li> <li><code>$ ip -s link show eth0</code> - Show information for the eth0 network interface, including statistics</li> <li><code>$ sudo ip addr add 192.168.1.7 dev eth0</code> - Set the IP address for eth0</li> <li><code>$ sudo ip link set eth0 down</code> - Bring interface eth0 down</li> <li><code>$ sudo ip link set eth0 mtu 1480</code> - Set MTU to 1480 bytes for interface eth0</li> <li><code>$ sudo ip route add 172.16.1.0/24 via 192.168.1.5</code> - Set route to network</li> </ul> <h3 id=ifconfig>ifconfig<a class=headerlink href=#ifconfig title="Permanent link">&para;</a></h3> <p><code>ifconfig</code> is a system administration utility long found in UNIX-like operating systems used to configure, control, and query network interface parameters from either the command line or from system configuration scripts.</p> <p>Some examples of using <code>ifconfig</code>:</p> <ul> <li><code>$ ifconfig</code> - Display information about all interfaces</li> <li><code>$ ifconfig eth0</code> - Display information about only eth0</li> <li><code>$ sudo ifconfig eth0 192.168.1.50</code> - Set the IP address to 192.168.1.50 on interface eth0</li> <li><code>$ sudo ifconfig eth0 netmask 255.255.255.0</code> - Set the netmask to 24-bit</li> <li><code>$ sudo ifconfig eth0 up</code> - Bring interface eth0 up</li> <li><code>$ sudo ifconfig eth0 down</code> - Bring interface eth0 down</li> <li><code>$ sudo ifconfig eth0 mtu 1480</code> - Set the MTU (Maximum Transfer Unit) to 1480 bytes for interface eth0</li> </ul> <h3 id=pnidn>PNIDN<a class=headerlink href=#pnidn title="Permanent link">&para;</a></h3> <p>The <strong>Predictable Network Interface Device Names</strong> (PNIDN) is strongly correlated with the use of udev and integration with systemd. There are now 5 types of names that devices can be given:</p> <ul> <li>Incorporating Firmware or BIOS provided index numbers for on-board devices<ul> <li>Example: eno1</li> </ul> </li> <li>Incorporating Firmware or BIOS provided PCI Express hotplug slot index numbers<ul> <li>Example: ens1</li> </ul> </li> <li>Incorporating physical and/or geographical location of the hardware connection<ul> <li>Example: enp2s0</li> <li>These names are correlated with the physical locations of the hardware on the PCI system: <code>$ lspci | grep Ethernet</code></li> </ul> </li> <li>Incorporating the MAC address<ul> <li>Example: enx7837d1ea46da</li> </ul> </li> <li>Using the old classic method<ul> <li>Example: eth0</li> </ul> </li> </ul> <p>You can choose to turn off the new scheme and go back to the classic names.</p> <h3 id=nic-config-files>NIC Config Files<a class=headerlink href=#nic-config-files title="Permanent link">&para;</a></h3> <p>Each distribution has its own set of files and/or directories, and they may be slightly different, depending on your distribution version.</p> <ul> <li>Red Hat<ul> <li>/etc/sysconfig/network</li> <li>/etc/sysconfig/network-scripts/ifcfg-ethX</li> <li>/etc/sysconfig/network-scripts/ifcfg-ethX:Y</li> <li>/etc/sysconfig/network-scripts/route-ethX</li> </ul> </li> <li>Debian<ul> <li>/etc/network/interfaces</li> </ul> </li> <li>SUSE<ul> <li>/etc/sysconfig/network</li> </ul> </li> </ul> <h3 id=network-manager>Network Manager<a class=headerlink href=#network-manager title="Permanent link">&para;</a></h3> <p>As a system was booted, it consulted the network configuration files in the <code>/etc</code> directory subtree in order to establish the interface properties such as static or dynamic (DCHP) address configuration, whether the device should be started at boot, etc. If there were multiple network devices, policies had to be established as to what order they would be brought up, which networks they would connect to, what they would be called, etc.</p> <p>Modern systems often have dynamic configurations:</p> <ul> <li>Networks may change as a device is moved from place to place.</li> <li>Wireless devices may have a large choice of networks to hook into.</li> <li>Devices may change as hardware such as wireless devices, are plugged in or turned on and off.</li> </ul> <p>Use of a GUI tool, <code>nmtui</code> or <code>nmcli</code> (for scripting) are the common ways to manage networks. Examples of <code>nmcli</code> can be found at <a href=https://fedoraproject.org/wiki/Networking/CLI target=_blank>Networking/CLI Fedora wiki webpage</a> or with <code>man nmcli-examples</code></p> <h3 id=routing>Routing<a class=headerlink href=#routing title="Permanent link">&para;</a></h3> <p><strong>Routing</strong> is the process of selecting paths in a network along which to send network traffic. The <strong>routing table</strong> is a list of routes to other networks managed by the system. It defines paths to all networks and hosts, sending remote traffic to routers.</p> <p>To see the current routing table, you can use <code>route -n</code> or <code>ip route</code>.</p> <p>The <strong>default route</strong> is the way packets are sent when there is no other match in the routing table for reaching the specified network, which can be obtained dynamically using DHCP or manually configured (static). You can set the default gateway at runtime with: <code>sudo route add default gw 192.168.1.10 enp2s0</code></p> <p>To make persistent change, do:</p> <ul> <li>add <code>GATEWAY=x.x.x.x</code> to <code>/etc/sysconfig/network</code> for Red Hat systems<ul> <li>or <code>/etc/sysconfig/network-scripts/ifcfg-ethX</code> for device-specific change</li> </ul> </li> <li>add <code>gateway=x.x.x.x</code> to <code>/etc/network/interfaces</code> for Debian systems</li> </ul> <h4 id=static-routes>Static Routes<a class=headerlink href=#static-routes title="Permanent link">&para;</a></h4> <p><strong>Static routes</strong> are used to control packet flow when there is more than one router or route. They are defined for each interface and can be either persistent or non-persistent. When the system can access more than one router, or perhaps there are multiple interfaces, it is useful to selectively control which packets go to which router.</p> <p>To make static route at run time, do <code>ip route add 10.5.0.0/16 via 192.168.1.100</code></p> <p>To make persistent change, do:</p> <ul> <li>add <code>10.5.0.0/16 via 172.17.9.1</code> to <code>/etc/sysconfig/network-scripts/route-ethX</code> for Red Hat system</li> <li>add following to <code>/etc/network/interfaces</code> for Debian systems:</li> </ul> <div class=highlight><pre><span></span><code>iface eth1 inet dhcp
post-up route add -host 10.1.2.51 eth1
post-up route add -host 10.1.2.52 eth1
</code></pre></div> <ul> <li>for SUSE systems add following to files such as <code>/etc/sysconfig/network/ifroute-eth0</code>:</li> </ul> <div class=highlight><pre><span></span><code># Destination Gateway Netmask Interface [Type] [Options]
# where each field is separated by tabs
192.168.1.150 192.168.1.1 255.255.255.255 eth0
10.1.1.150 192.168.233.1.1 eth0
10.1.1.0/24 192.168.1.1 - eth0
</code></pre></div> <h3 id=name-resolution>Name Resolution<a class=headerlink href=#name-resolution title="Permanent link">&para;</a></h3> <p><strong>Name resolution</strong> is the act of translating hostnames to the IP addresses of their hosts. There are two facilities for doing this translation:</p> <ul> <li>Static name resolution (using <code>/etc/hosts</code>).</li> <li>Dynamic name resolution (using DNS servers).</li> </ul> <p>Commands used to resolve the IP address of a hostname: <code>[dig | host | nslookup] linuxfoundation.org</code></p> <h4 id=etchosts>/etc/hosts<a class=headerlink href=#etchosts title="Permanent link">&para;</a></h4> <p><code>/etc/hosts</code> holds a local database of hostnames and IP addresses. It contains a set of records (each taking one line) which map IP addresses with corresponding hostnames and aliases.</p> <p>Such static name resolution is primarily used for local, small, isolated networks. It is generally checked before DNS is attempted to resolve an address; however, this priority can be controlled by <code>/etc/nsswitch.conf</code> (not often used today).</p> <p>The other host-related files in <code>/etc</code> are <code>/etc/hosts.deny</code> and <code>/etc/hosts.allow</code>. The allow file is searched first and the deny file is only searched if the query is not found there. <code>/etc/host.conf</code> contains general configuration information; it is rarely used.</p> <h4 id=dns>DNS<a class=headerlink href=#dns title="Permanent link">&para;</a></h4> <p>If name resolution cannot be done locally using <code>/etc/hosts</code>, then the system will query a DNS (Domain Name Server) server.</p> <p>DNS is <strong>dynamic</strong> and consists of a <strong>network of servers</strong> which a client uses to look up names. The service is distributed; any one DNS server has only information about its zone of authority; however, all of them together can cooperate to resolve any name.</p> <p>The machine's usage of DNS is configured in <code>/etc/resolv.conf</code>, which historically has looked like:</p> <div class=highlight><pre><span></span><code>search example.com aps.org
nameserver 192.168.1.1
nameserver 8.8.8.8
</code></pre></div> <p>which:</p> <ul> <li>Can specify particular domains to search</li> <li>Defines a strict order of nameservers to query</li> <li>May be manually configured or updated from a service such as DHCP (Dynamic Host Configuration Protocol)</li> </ul> <p>Most modern systems will have an <code>/etc/hosts.resolv</code> file generated automatically which was generated by NetworkManager invoking DHCP on the primary network interface.</p> <h3 id=network-diagnostics>Network Diagnostics<a class=headerlink href=#network-diagnostics title="Permanent link">&para;</a></h3> <p>Some utilities that helps diagnosis network:</p> <ul> <li><code>ping</code> - Sends 64-byte test packets to designated network hosts and tries to report back on the time required to reach it, any lost packets, and some other parameters. You can see whether the network is working and the host is reachable.</li> <li><code>traceroute</code> - Displays a network path to a destination. It shows the routers packets flow through to get to a host, as well as the time it takes for each hop.</li> <li><code>mtr</code> - It combines the functionality of <code>ping</code> and <code>traceroute</code>, and creates a continuously updated display.</li> <li><code>dig</code> - It is useful for testing DNS functionality. Note that one can also use <code>host</code> or <code>nslookup</code>, older programs that also try to return DNS information about a host.</li> </ul> <h2 id=firewall>Firewall<a class=headerlink href=#firewall title="Permanent link">&para;</a></h2> <p>A firewall is a network security system that <strong>monitors and controls</strong> all network traffic. It applies rules on both <strong>incoming and outgoing</strong> network connections and packets and builds flexible <strong>barriers</strong> depending on the level of trust and network topography (or topology) of a given connection.</p> <p>Firewalls can be hardware or software based. They are found both in network routers, as well as in individual computers, or network nodes. Many firewalls also have routing capabilities.</p> <p>Information is transmitted​ across networks in the form of packets, and each one of these packets has: Header, Payload, Footer. The header and footer contain information about destination and source addresses, what kind of packet it is, and which protocol it obeys, various flags, which packet number this is in a stream, and ​all sorts of other metadata about transmissions. The actual data is in the payload.</p> <p>Almost all firewalls are based on <strong>Packet Filtering</strong>. ​Packet filtering intercepts packets at one or more stages in the network transmission, including application, transport, network, and datalink. A firewall establishes a set of rules by which each packet may be:</p> <ul> <li>Accepted or rejected based on content, address, etc.​</li> <li>Mangled in some way</li> <li>Redirected to another address</li> <li>Inspected for security reasons, etc.</li> </ul> <p>The next generation of firewalls were based on stateful filters, which also examine the connection state of the packet, to see if it is a new connection, ​part of an already existing one, or part of none. Denial of service attacks can bombard this kind of firewall to try and overwhelm it.</p> <p>The third generation of firewalls is called Application Layer Firewalls, and are aware of the kind of application and protocol the connection is using. They can block anything which should not be part of the normal flow.​</p> <h3 id=firewall-configurations>Firewall Configurations<a class=headerlink href=#firewall-configurations title="Permanent link">&para;</a></h3> <p>Configuring the firewall with low-level cli tools such as <code>iptables, firewall-cmd, ufw</code>, or GUI tools such as <code>system-config-firewall, firewall-config, gufw, yast</code>.</p> <h4 id=firewalld>firewalld<a class=headerlink href=#firewalld title="Permanent link">&para;</a></h4> <p><code>firewalld</code> is the Dynamic Firewall Manager. It utilizes network/firewall zones which have defined levels of trust for network interfaces or connections. It supports both IPv4 and IPv6 protocols. Additionally, it separates runtime and permanent (persistent) changes to configuration, and also includes interfaces for services or applications to add firewall rules. Configuration files are kept in <code>/etc/firewalld</code> (primary) and <code>/usr/lib/firewalld</code></p> <p>As a service, firewalld replaces the older iptables. It is an error to run both services, firewalld and iptables, at the same time. The command line tool to manage <code>firewalld</code> is <code>firewall-cmd</code>.</p> <p>Note that if you have more than one network interface when using IPv4, you have to turn on ip forwarding, with:</p> <div class=highlight><pre><span></span><code>sudo sysctl net.ipv4.ip_forward<span class=o>=</span><span class=m>1</span>
<span class=nb>echo</span> <span class=m>1</span> <span class=p>|</span> sudo tee /proc/sys/net/ipv4/ip_forward
sudo sysctl -p
</code></pre></div> <h4 id=zones>zones<a class=headerlink href=#zones title="Permanent link">&para;</a></h4> <p><code>firewalld</code> works with zones, each of which has a defined level of trust and a certain known behavior for incoming and outgoing packets. Each interface belongs to a particular zone (normally, it is NetworkManager which informs firewalld which zone is applicable) which can be changed with <code>fireweall-cmd</code>.</p> <p>Types of zones and their effects:</p> <ul> <li>drop - All incoming packets are dropped with no reply. Only outgoing connections are permitted.</li> <li>block - All incoming network connections are rejected. The only permitted connections are those from within the system.</li> <li>public - Do not trust any computers on the network; only certain consciously selected incoming connections are permitted.</li> <li>external - Used when masquerading is being used, such as in routers. Trust levels are the same as in public.</li> <li>dmz (Demilitarized Zone) - Used when access to some (but not all) services are to be allowed to the public. Only particular incoming connections are allowed.</li> <li>work - Trust (but not completely) connected nodes to be not harmful. Only certain incoming connections are allowed.</li> <li>home - You mostly trust the other network nodes, but still select which incoming connections are allowed.</li> <li>internal - Similar to the work zone.</li> <li>trusted - All network connections are allowed.</li> </ul> <p>On system installation, most, if not all Linux distributions, will select the public zone as default for all interfaces.</p> <p>Any zone can be bound not just to a network interface, but also to particular network addresses. A packet is associated with a zone if:</p> <ul> <li>It comes from a source address already bound to the zone; or if not,</li> <li>It comes from an interface bound to the zone.</li> </ul> <p>Any packet not fitting the above criteria is assigned to the default zone (i.e, usually public).</p> <div class=highlight><pre><span></span><code><span class=c1># example commands for adding rules for setting zones on the level of interface, IP addresses, service, port and protocal</span>
sudo firewall-cmd --permanent --zone<span class=o>=</span>internal --change-interface<span class=o>=</span>eno1
sudo firewall-cmd --permanent --zone<span class=o>=</span>trusted --add-source<span class=o>=</span><span class=m>192</span>.168.1.0/24
sudo firewall-cmd --permanent --zone<span class=o>=</span>home --add-service<span class=o>=</span>dhcp
sudo firewall-cmd --zone<span class=o>=</span>home --add-port<span class=o>=</span><span class=m>21</span>/tcp
</code></pre></div> <h2 id=system-startup-and-shutdown>System Startup and Shutdown<a class=headerlink href=#system-startup-and-shutdown title="Permanent link">&para;</a></h2> <p>The boot sequence basic steps are:</p> <ul> <li>The BIOS/UEFI locates and executes the boot program, or boot loader.<ul> <li>POST (Power On Self Test) is run to check the memory and hardware and then search a specific location or device for a boot program</li> <li>boot program is found in MBR or using UEFI. It is usually GRUB.</li> </ul> </li> <li>The boot loader loads the kernel.<ul> <li>kernel need to be decompressed, then performs hardware checks, gains access to important peripheral hardware</li> </ul> </li> <li>The kernel starts the init process (pid=1).</li> <li>init manages system initialization, using <code>systemd</code> or the older Upstart and SysVinit startup scripts.</li> </ul> <h3 id=grub>GRUB<a class=headerlink href=#grub title="Permanent link">&para;</a></h3> <p>Virtually, all (non-embedded) modern Linux distributions use <strong>GRUB</strong> (GRand Unified Boot Loader). <code>efibootmgr</code> is not actually a boot loader, but is a boot manager, used in conjunction with GRUB on multi-boot EFI systems.</p> <p>Some important features of GRUB are:</p> <ul> <li>Alternative operating systems can be chosen at boot time.</li> <li>Alternative kernels and/or initial ramdisks can be chosen at boot time for a given operating system.</li> <li>Boot parameters can be easily <strong>changed at boot time</strong> without having to edit configuration files, etc., in advance.</li> </ul> <p>At boot, a basic configuration file is read, <code>/boot/grub/grub.cfg</code>, or <code>/boot/grub2/grub.cfg</code>, or <code>/boot/efi/EFI/redhat/grub.cfg</code>. This file is auto-generated by <code>update-grub</code> (or <code>grub-mkconfig</code> or <code>grub2-mkconfig</code>) based on configuration files in the <code>/etc/grub.d</code> directory and on <code>/etc/default/grub</code> and should not be edited by hand.</p> <p>Upon system boot, after the initial POST and BIOS stages, GRUB will be entered and display a menu containing a list of bootable images either from one or more Linux distributions or operating systems, with submenus. After selecting an entry, you can type e for edit and then enter into an interactive shell to edit the particular boot option.</p> <p>If there are serious problems, like not being able to find a configuration file, GRUB reverts back to a pure shell mode and you may be able to rescue the system without resorting to rescue media.</p> <p>In both GRUB versions, the first hard drive is denoted as hd0, the second is hd1, etc. However, in Version 1, partitions start counting from 0, and in Version 2 from 1. For example: sda1 is (hd0,1) in GRUB 2, but (hd0,0) in GRUB 1.</p> <p>On systems configured with Boot Loader Specification Configuration (BLSCFG), one still uses the usual grub commands when installing or updating kernels, but detailed information and options for each kernel are found in <code>/boot/loader/entries</code>. This new scheme can be turned on/off with <code>grub2-switch-to-blscfg</code> or altering the variable <code>GRUB_ENABLE_BLSCFGS=[true|false]</code> in <code>/etc/default/grub</code>.</p> <h3 id=configuration-files-in-etc>Configuration Files in <code>/etc</code><a class=headerlink href=#configuration-files-in-etc title="Permanent link">&para;</a></h3> <p>For historical reasons, Linux distributions evolved their own rules about exactly where to place some information in <code>/etc</code>. For example, all Red Hat-derived systems make extensive use of <code>/etc/sysconfig/</code>, while Debian-based systems have used <code>/etc/default/</code>. Interestingly, RHEL and SUSE use both.​</p> <p>There should be only text files found under <code>/etc</code>, no binary formats or data.</p> <h4 id=etcsysconfig>/etc/sysconfig<a class=headerlink href=#etcsysconfig title="Permanent link">&para;</a></h4> <p>Files in this directory and its subdirectories are used by many <strong>system utilities</strong> services, often consulted when the system starts and stops services or queries their status.</p> <h4 id=etcdefault>/etc/default<a class=headerlink href=#etcdefault title="Permanent link">&para;</a></h4> <p>The files are used to provide extra options when starting a service and typically contain code to set environment variables.</p> <h3 id=shutdown>shutdown<a class=headerlink href=#shutdown title="Permanent link">&para;</a></h3> <p><code>shutdown</code> is used to bring the system down in a secure fashion, notifying all users that the system is going down and then stopping it in a graceful and non-destructive way. After it is shut down, the system is either halted or rebooted. There are also the legacy commands <code>reboot</code>, <code>halt</code>, and <code>poweroff</code></p> <p>This <a href=https://sysadminxpert.com/checklist-for-pre-and-post-linux-reboot/ target=_blank>article</a> shows a checklist of things to do pre and post reboot.</p> <h3 id=sbininit>/sbin/init<a class=headerlink href=#sbininit title="Permanent link">&para;</a></h3> <p><code>/sbin/init</code> (usually just called init) is the <strong>first user-level process</strong> (or task) run on the system and continues to run until the system is shutdown. Traditionally, it has been considered the <strong>parent</strong> of all user processes, although technically that is not true, as some processes are started directly by the kernel.</p> <p>init coordinates the later stages of the boot process, configures all aspects of the environment, and starts the processes needed for logging into the system. init also works closely with the kernel in cleaning up after processes when they terminate.</p> <p>Traditionally, nearly all distributions based the init process on UNIX's venerable SysVinit' software. However, this scheme was developed decades ago under rather different circumstances:</p> <ul> <li>The target was multi-user mainframe systems (and not personal computers, laptops, and other devices)</li> <li>The target was a single processor system<ul> <li>startup was viewed as a serial process, divided into a series of sequential stages (run levels).</li> </ul> </li> <li>Startup (and shutdown) time was seen rare and not an important matter; it was far less important than getting things right.</li> </ul> <p>Modern systems have required newer methods with enhanced capabilities.</p> <h3 id=systemd>systemd<a class=headerlink href=#systemd title="Permanent link">&para;</a></h3> <p>The <code>systemd</code> system and session manager for Linux is now dominant in all major distributions. Features include the following:</p> <ul> <li>Boots faster than previous init systems</li> <li>Provides aggressive parallelization capabilities</li> <li>Uses socket and D-Bus activation for starting services</li> <li>Replaces shell scripts with programs</li> <li>Offers on-demand starting of daemons</li> <li>Keeps track of processes using cgroups</li> <li>Maintains mount and automount points</li> <li>Implements an elaborate transactional dependency-based service control logic</li> <li>Can work as a drop-in replacement for SysVinit and is compatible with SysVinit scripts.</li> </ul> <p><code>systemd</code> is backward compatible with <strong>SysVinit</strong> and the concept of <strong>runlevels</strong> is supported via <strong>runlevel targets</strong>. The telinit program is emulated to work with runlevels. <code>systemd</code> prefers to use a set of standardized configuration files, it can also use distribution-dependent legacy configuration files as a fall-back.</p> <table> <thead> <tr> <th>Runlevel</th> <th>Target</th> </tr> </thead> <tbody> <tr> <td>0</td> <td>poweroff.target</td> </tr> <tr> <td>1</td> <td>rescue.target</td> </tr> <tr> <td>2,3,4</td> <td>multi-user.target</td> </tr> <tr> <td>5</td> <td>graphical.target</td> </tr> <tr> <td>6</td> <td>reboot.target</td> </tr> </tbody> </table> <p>The <code>isolate</code> command will immediately stop processes that are not enabled in the new unit, possibly including the graphical environment or terminal you are currently using</p> <div class=highlight><pre><span></span><code><span class=c1># immediately change the target</span>
sudo systemctl isolate multi-user.target
<span class=c1># change the default target, effective after each reboot</span>
sudo systemctl <span class=nb>enable</span> multi-user.target
sudo systemctl set-default multi-user.target
</code></pre></div> <p>Use <code>man systemd.special</code> to learn more.</p> <h4 id=systemctl>systemctl<a class=headerlink href=#systemctl title="Permanent link">&para;</a></h4> <p><code>systemctl</code> is the main utility for managing services. Its basic syntax is: <code>systemctl [options] command [name]</code>. Some examples:</p> <ul> <li><code>systemctl</code> - To show the status of everything that systemd controls</li> <li><code>systemctl list-units -t service --all</code> - To show all available services</li> <li><code>systemctl list-units -t service</code> - To show only active services</li> <li><code>sudo systemctl start/stop foo.service</code> - To start (activate) or stop (deactivate) one or more units (a service or a socket)</li> <li><code>sudo systemctl enable/disable sshd.service</code> - To enable/disable a service</li> </ul> <p>For most commands, you can omit the <code>.service</code> attached to the service name. </p> <p>Also worth read <a href=https://fedoraproject.org/wiki/SysVinit_to_Systemd_Cheatsheet target=_blank>SysVinit to Systemd Cheetsheet</a>.</p> <h4 id=service-file>.service file<a class=headerlink href=#service-file title="Permanent link">&para;</a></h4> <p>To make a service start up when system boots, we need to configure it and put under <code>/etc/systemd/system/multi-user.target.wants/</code>.</p> <p>A simple service file may look like the following. For more info check <code>man systemd.service</code> or <a href=https://www.freedesktop.org/software/systemd/man/systemd.service.html target=_blank>here</a></p> <div class=highlight><pre><span></span><code>[Unit]
Description=Simple notifying service

[Service]
Type=notify
ExecStart=/usr/sbin/simple-notifying-service

[Install]
WantedBy=multi-user.target
</code></pre></div> <h2 id=backup-and-recovery>Backup and Recovery<a class=headerlink href=#backup-and-recovery title="Permanent link">&para;</a></h2> <p>Obviously, files essential to your organization require backup. Configuration files may change frequently, and along with individual user's files, require backup as well.</p> <p>Logging files can be important and worth to backup if you have to investigate your system's history, which can be particularly important for detecting intrusions and other security violations.</p> <p>The simplest backup scheme is to do a full backup of everything once, and then perform incremental backups of everything that subsequently changes. While full backups can take a lot of time, restoring from incremental backups can be more difficult and time consuming. Thus, you can use a mix of both to optimize time and effort.</p> <p>An example of one useful strategy involving tapes (you can easily substitute other media in the description):</p> <ul> <li>Use tape 1 for a full backup on Friday.</li> <li>Use tapes 2-5 for incremental backups on Monday-Thursday.</li> <li>Use tape 6 for full backup on second Friday.</li> <li>Use tapes 2-5 for incremental backups on second Monday-Thursday.</li> <li>Do not overwrite tape 1 until completion of full backup on tape 6.</li> <li>After full backup to tape 6, move tape 1 to external location for disaster recovery.</li> <li>For next full backup (next Friday) get tape 1 and exchange for tape 6.</li> </ul> <p>A good rule of thumb is to have at least two weeks of backups available.</p> <h3 id=backup-utilities>Backup utilities<a class=headerlink href=#backup-utilities title="Permanent link">&para;</a></h3> <ul> <li><code>cpio</code> and <code>tar</code> - create and extract archives of files.</li> <li><code>gzip, bzip2, xz</code> - create archive files to be written to disk, magnetic tape, or any other device which can hold files. Archives are very useful for transferring files from one filesystem or machine to another.</li> <li><code>dd</code> - transfer raw data between media. It can copy entire partitions or entire disks.</li> <li><code>rsync</code> - synchronize directory subtrees or entire filesystems across a network, or between different filesystem locations on a local machine.</li> <li><code>dump</code> and <code>restore</code> - old but designed specifically for backups. They read from the filesystem directly (which is more efficient). However, they must be restored only on the same filesystem type that they came from. There are newer alternatives.</li> <li><code>mt</code> - useful for querying and positioning tapes before performing backups and restores.</li> </ul> <h4 id=dd>dd<a class=headerlink href=#dd title="Permanent link">&para;</a></h4> <p><code>dd</code> is a common UNIX-based program whose primary purpose is the low-level copying and conversion of raw data. It is used to copy a specified number of bytes or blocks, performing on-the-fly byte order conversions, as well as being able to convert data from one form to another. It can also be used to copy regions of raw device files, for example backing up the boot sector of a hard disk, or to read fixed amounts of data from special files like /dev/zero or /dev/random. The basic syntax is: <code>dd if=input-file of=output-file options</code></p> <h4 id=rsync>rsync<a class=headerlink href=#rsync title="Permanent link">&para;</a></h4> <p><code>rsync</code> (remote synchronize) is used to transfer files across a network (or between different locations on the same machine). The basic syntax is: <code>rsync [options] sourcefile destinationfile</code></p> <p>The source and destination can take the form of <code>target:path</code>, where target can be in the form of <code>[user@]host</code>. The <code>user@</code> part is optional and used if the remote user is different from the local user.</p> <p>You have to be very careful with rsync about exact location specifications (especially if you use the <code>--delete</code> option), so it is highly recommended to use the <code>--dry-run</code> option first, and then repeat if the projected action looks correct.</p> <p><code>rsync</code> is very clever; it checks local files against remote files in small chunks, and it is very efficient in that when copying one directory to a similar directory, only the differences are copied over the network. This synchronizes the second directory with the first directory. You may often use the -r option, which causes rsync to recursively walk down the directory tree copying all files and directories below the one listed as the sourcefile. Thus, a very useful way to back up a project directory might be similar to: <code>rsync -r project-X archive-machine:archives/project-X</code></p> <p>A simple (and very effective and very fast) backup strategy is to simply duplicate directories or partitions across a network with rsync commands and to do so frequently.</p> <h4 id=cpio>cpio<a class=headerlink href=#cpio title="Permanent link">&para;</a></h4> <p><code>cpio</code> (copy in and out) is a general file archiver utility that has been around since the earliest days of UNIX and was originally designed for tape backups. It is light weight than <code>tar</code>.</p> <p>The <code>-o</code> or <code>--create</code> option tells cpio to copy files out to an archive, which reads a list of file names (one per line) from standard input and writes the archive to standard output. The <code>-i</code> or <code>--extract</code> option tells cpio to copy files from an archive, reading the archive from standard input. The <code>-t</code> or <code>--list</code> option tells cpio to list the archive contents.</p> <h4 id=backup-programs>Backup programs<a class=headerlink href=#backup-programs title="Permanent link">&para;</a></h4> <ul> <li>Amanda - (Advanced Maryland Automatic Network Disk Archiver) uses native utilities (including tar and dump) but is far more robust and controllable. Amanda is generally available on Enterprise Linux systems through the usual repositories.</li> <li>Bacula - designed for automatic backup on heterogenous networks. It can be rather complicated to use and is recommended (by its authors) only to experienced administrators. Bacula is generally available on Enterprise Linux systems through the usual repositories.</li> <li>Clonezilla - a very robust disk cloning program, which can make images of disks and deploy them, either to restore a backup, or to be used for ghosting, to provide an image that can be used to install many machines.</li> </ul> <h2 id=linux-security-modules>Linux Security Modules<a class=headerlink href=#linux-security-modules title="Permanent link">&para;</a></h2> <p>Linux Security Modules (LSM) emphasis the idea of implementing mandatory access controls over the variety of requests made to the kernel in a way that:</p> <ul> <li>Minimizes changes to the kernel</li> <li>Minimizes overhead on the kernel</li> <li>Permits flexibility and choice between different implementations, each of which is presented as a self-contained LSM (Linux Security Module)</li> </ul> <p>The basic idea is to hook system calls and insert code whenever an application requests a transition to kernel (system) mode. This code makes sure permissions are valid, malicious intent is protected against, by invoking security-related functional steps before and/or after a system call is fulfilled by the kernel.</p> <p>The current LSM implementations: SELinux, AppArmor, Smack, Tomoyo.</p> <h3 id=selinux>SELinux<a class=headerlink href=#selinux title="Permanent link">&para;</a></h3> <p>SELinux was originally developed by the United States NSA (National Security Administration) and has been brought into a large usage base.</p> <p>Operationally, SELinux is a set of security rules that are used to determine which processes can access which files, directories, ports, and other items on the system.</p> <p>It works with three conceptual quantities:</p> <ul> <li>Contexts - Context are labels to files, processes and ports. Examples of contexts are SELinux user, role, type, level.</li> <li>Rules - Rules describe access control in terms of contexts, processes, files, ports, users, etc.</li> <li>Policies - Policies are a set of rules that describe what system-wide access control decisions should be made by SELinux.</li> </ul> <p>SELinux modes are selected (and explained) in <code>/etc/sysconfig/selinux</code> (CentOS and openSUSE) or <code>/etc/selinux/config</code> (Ubuntu). The <code>sestatus</code> utility can display the current mode and policy. The list of SELinux modes:</p> <ul> <li>Enforcing - All SELinux code is operative and access is denied according to policy. All violations are audited and logged. </li> <li>Permissive - Enables SELinux code, but only audits and warns about operations that would be denied in enforcing mode.</li> <li>Disabled - Completely disables SELinux kernel and application code, leaving the system without any of its protections.</li> </ul> <p>Read this comprehensive guide to <a href=https://linuxconfig.org/how-to-disable-enable-selinux-on-ubuntu-20-04-focal-fossa-linux target=_blank>install and enable SELinux</a>.</p> <h4 id=getenforce-setenforce>getenforce, setenforce<a class=headerlink href=#getenforce-setenforce title="Permanent link">&para;</a></h4> <p><code>getenforce</code> can be used to get the current SELinux mode. <code>setenforce</code> can be used to switch between enforcing and permissive modes on the fly while the system is in operation, but it does not allow you to enable/disable SELinux completely.</p> <p>Disable SELinux is done through either:</p> <ul> <li>Edit the SELinux configuration file and set <code>SELINUX=disabled</code></li> <li>Add selinux=0 to the kernel parameter list when rebooting</li> </ul> <p>Note that disabling SELinux on systems in which SELinux will be re-enabled is not recommended. It is preferable to use the permissive mode instead of disabling SELinux, so as to avoid relabeling the entire filesystem, which can be time-consuming.</p> <h4 id=policies>Policies<a class=headerlink href=#policies title="Permanent link">&para;</a></h4> <p>SELinux configuration file also sets the SELinux policy. Multiple policies are allowed, but only one can be active at a time.</p> <p>Changing the policy may require a reboot of the system and a time-consuming re-labeling of filesystem contents. Each policy has files which must be installed under <code>/etc/selinux/[SELINUXTYPE]</code>. Some common SELinux policies:</p> <ul> <li>targeted - The default policy in which SELinux is more restricted to targeted processes. User processes and init processes are not targeted, while network service processes are targeted. SELinux enforces memory restrictions for all processes, which reduces the vulnerability to buffer overflow attacks.</li> <li>minimum - A modification of the targeted policy where only selected processes are protected.</li> <li>MLS - The Multi-Level Security policy is much more restrictive; all processes are placed in fine-grained security domains with particular policies.</li> </ul> <p>SELinux policy behavior can be configured at runtime without rewriting the policy. This is accomplished by configuring SELinux Booleans, which are policy parameters that can be enabled and disabled:</p> <ul> <li><code>getsebool</code> - to see booleans</li> <li><code>setsebool</code> - to set booleans<ul> <li>default the change is not persistent. Make it persistent with option <code>-P</code></li> </ul> </li> <li><code>semanage boolean -l</code> - to see persistent boolean settings</li> </ul> <h4 id=contexts>Contexts<a class=headerlink href=#contexts title="Permanent link">&para;</a></h4> <p>There are four SELinux contexts: User, Role, Type, Level.</p> <p>Use <code>-Z</code> with utilities such as <code>ls</code>, <code>ps</code>, <code>cp</code>, <code>mv</code>, and <code>mkdir</code>. To see the context associated witha file/process. Type is the most commonly utilized context, and its label should end with <code>_t</code>, as in <code>kernel_t</code>.</p> <p>You can use <code>chcon</code> to change a file's context, as in <code>chcon -t etc_t somefile</code>.</p> <p>Note that newly created files inherit the context from their parent directory, but when moving files, it is the context of the source directory which may be preserved. In that event, use <code>restorecon</code> which resets file contexts, based on parent directory settings. i.e. <code>restorecon -Rv /home/jimih</code> on a directory will correct the context recursively for files under.</p> <p>To configure the default context for a newly created directory, use <code>semanage fcontext</code> (from <code>policycoreutils-python</code> package). After the change, a call to <code>restorecon</code> is still required.</p> <h4 id=monitoring-access>Monitoring Access<a class=headerlink href=#monitoring-access title="Permanent link">&para;</a></h4> <p>SELinux comes with a set of tools that collect issues at run time, log these issues and propose solutions to prevent same issues from happening again, via <code>setroubleshoot-server</code> package.</p> <h3 id=apparmor>AppArmor<a class=headerlink href=#apparmor title="Permanent link">&para;</a></h3> <p>AppArmor is an LSM alternative to SELinux, used by SUSE, Ubuntu and other distributions. It:</p> <ul> <li>Provides Mandatory Access Control (MAC)</li> <li>Allows administrators to associate a security profile to a program which restricts its capabilities</li> <li>Is considered easier (by some but not all) to use than SELinux</li> <li>Is considered filesystem-neutral (no security labels required)</li> </ul> <p>In addition to manually specifying profiles, AppArmor includes a learning mode, in which violations of the profile are logged, but not prevented. This log can then be turned into a profile, based on the program's typical behavior.</p> <p>To view its status, do <code>sudo apparmor_status</code> or <code>sudo aa_status</code>.</p> <p>AppArmor Modes:</p> <ul> <li>Enforce Mode - Applications are prevented from acting in ways which are restricted. Attempted violations are reported to the system logging files. This is the default mode. A profile can be set to this mode with aa-enforce.</li> <li>Complain Mode - Policies are not enforced, but attempted policy violations are reported. This is also called the learning mode. A profile can be set to this mode with aa-complain.</li> </ul> <p>Profiles restrict how executable programs that have pathnames on the system can be used. Linux distributions come with​ pre-packaged profiles or installed with an AppArmor package (<code>apparmor-profiles</code>), included in <code>/etc/apparmor.d</code>.</p> <p>Some common AppArmor utilities:</p> <table> <thead> <tr> <th>Program</th> <th>Use</th> </tr> </thead> <tbody> <tr> <td>apparmor_status</td> <td>Show status of all profiles and processes with profiles</td> </tr> <tr> <td>apparmor_notify</td> <td>Show a summary for AppArmor log messages</td> </tr> <tr> <td>complain</td> <td>Set a specified profile to complain mode</td> </tr> <tr> <td>enforce</td> <td>Set a specified profile to enforce mode</td> </tr> <tr> <td>disable</td> <td>Unload a specified profile from the current kernel and prevent from being loaded on system startup</td> </tr> <tr> <td>logprof</td> <td>Scan log files, and, if AppArmor events that are not covered by existing profiles have been recorded, suggest how to take into account, and, if approved, modify and reload</td> </tr> <tr> <td>easyprof</td> <td>Help set up a basic AppArmor profile for a program</td> </tr> </tbody> </table> <h2 id=local-system-security>Local System Security<a class=headerlink href=#local-system-security title="Permanent link">&para;</a></h2> <p>Security can be defined in terms of the system's ability to regularly do what it is supposed to do, integrity and correctness of the system, and ensuring that the system is only available to those authorized to use it.</p> <p>The biggest problem with security is to find that appropriate mix of security and productivity; if security restrictions are tight, opaque, and difficult, especially with ineffective measures, users will circumvent procedures.</p> <p>It is important to create and publicize to your organization a clear security policy that is descriptive, easy to understand, and constantly updated. Policies should be generic and specify enforcement actions and response to breach.</p> <p>Essential aspects to cover:</p> <ul> <li>Confidentiality</li> <li>Data Integrity</li> <li>Availability</li> <li>Consistency</li> <li>Control</li> <li>Audit</li> </ul> <p>You should make sure that the data is correct and the system behaves as it is expected to do. There should be processes in effect to determine who is given access to your system.</p> <h3 id=risk-analysis>Risk Analysis<a class=headerlink href=#risk-analysis title="Permanent link">&para;</a></h3> <p>Risk analysis is based on the following three questions:</p> <ul> <li>What do I want to protect (identify assets)?</li> <li>What am I protecting it against (identify threats)?</li> <li>How much time, personnel, and money is needed to provide adequate protection?</li> </ul> <p>Two basic philosophies found in use in most computing environments:</p> <ul> <li>Anything not expressly permitted is denied.​</li> <li>Anything not expressly forbidden is permitted.</li> </ul> <p>The first choice is tighter: a user is allowed to do only what is clearly and explicitly specified as permissible without privilege. This is the most commonly used philosophy.</p> <p>The second choice builds a more liberal environment where users are allowed to do anything except what is expressly forbidden. It implies a high degree of assumed trust and is less often deployed for obvious reasons.</p> <h3 id=patch-system-updates>Patch system updates<a class=headerlink href=#patch-system-updates title="Permanent link">&para;</a></h3> <p>Most attacks exploit known security holes and are deployed in the time period between revelation of a problem and patches being applied. It is critical to pay attention to your Linux distributor's updates and upgrades and apply them as soon as possible.</p> <h3 id=hardware-accessibility>Hardware Accessibility<a class=headerlink href=#hardware-accessibility title="Permanent link">&para;</a></h3> <p>Any time hardware is physically accessible security can be compromised by:</p> <ul> <li>Key logging: Recording the real time activity of a computer user including the keys they press. The captured data can either be stored locally or transmitted to remote machines.</li> <li>Network sniffing: Capturing and viewing the network packet level data on your network.</li> <li>Booting with a live or rescue disk.</li> <li>Remounting and modifying disk content.</li> </ul> <p>Physical access to a system makes it possible for attackers to easily leverage several attack vectors, in a way that makes all operating system level recommendations irrelevant. Thus, security policy should start with requirements on how to properly secure physical access to servers and workstations.</p> <p>Necessary protective steps include:</p> <ul> <li>Locking down workstations and servers</li> <li>Protecting your network links against access by people you do not trust</li> <li>Protecting your keyboards where passwords are entered to ensure the keyboards cannot be tampered with</li> <li>Configuring password protection of the BIOS in such a way that the system cannot be booted with a live or rescue CD/DVD or USB key</li> </ul> <p>Setting a BIOS password protects against unauthorized persons changing the boot options to gain access to your system. You can secure the boot process further with a secure bootloader password to prevent someone from bypassing the user authentication step.</p> <h3 id=secure-mount-filesystem>Secure Mount Filesystem<a class=headerlink href=#secure-mount-filesystem title="Permanent link">&para;</a></h3> <p>When a filesystem is mounted, either at the command line with a mount command, or automatically by inclusion in /etc/fstab, various options can be specified to enhance security:</p> <ul> <li>nodev - Do not interpret character or block special devices on the filesystem.</li> <li>nosuid - The set-user-identifier or set-group-identifier bits are not to take effect.​</li> <li>noexec - Restrict direct execution of any binaries on the mounted filesystem.</li> <li>ro - Mount the filesystem in read-only mode as in: <code>mount -o ro,noexec,nodev /dev/sda2 /edsel</code></li> </ul> <p>By setting the <code>setuid</code> (set user ID) flag on an executable file, you modify this normal behavior by giving the program the access rights of the owner rather than the user of the program. Similar rule apply for <code>setgid</code> bit for giving runtime group access rights.</p> <p>By default, when a file is created in a directory, it is owned by the user and group of the user that created it. Using the setgid setting on the directory changes this so that files created in the directory are group owned by the group owner of the directory. This allows you to create a shared directory in which a group of users can share files.</p> <p>Set the setuid bit with <code>chmod u+s somefile</code>, and setgid bit with <code>chmod g+s somefile</code></p> <h2 id=troubleshooting>Troubleshooting<a class=headerlink href=#troubleshooting title="Permanent link">&para;</a></h2> <p>Troubleshooting involves taking a number of steps which need to be repeated iteratively until solutions are found. A basic recipe might be:</p> <ul> <li>Characterize the problem</li> <li>Reproduce the problem</li> <li>Always try the easy things first</li> <li>Eliminate possible causes one at a time</li> <li>Change only one thing at a time; if that doesn't fix the problem, change it back</li> <li>Check the system logs (/var/log/messages, /var/log/secure, etc.) for further information</li> </ul> <h3 id=system-rescue>System Rescue<a class=headerlink href=#system-rescue title="Permanent link">&para;</a></h3> <p>Sooner or later a system is likely to undergo a significant failure. System Rescue media in the form of optical disks or portable USB drives can be used to fix the situation. Booting into either emergency or single user mode can enable using the full suite of Linux tools to repair the system back to normal function.</p> <p>The rescue image can be mounted and use <code>chroot</code> to change into that environment. You may install software packages from inside the chroot-ed environment. You may also be able to install them from outside the chroot-ed environment. i.e. <code>sudo rpm -ivh --force --root=/mnt/sysimage /mnt/source/Packages/vsftpd-2*.rpm</code>.</p> <p>Emergency boot media are useful when your system won't boot due to some issue such as missing, misconfigured, or corrupted files or a misconfigured service.</p> <p>In emergency mode you are booted into the most minimal environment possible. The root filesystem is mounted read-only, no init scripts are run and almost nothing is set up. To enter emergency mode, you need to select an entry from the GRUB boot menu and then hit e for edit. Then add the word emergency to the kernel command line before telling the system to boot.</p> <p>If your system boots, but does not allow you to log in when it has completed booting, try single user mode:</p> <ul> <li>init is started</li> <li>Services are not started</li> <li>Network is not activated</li> <li>All possible filesystems are mounted</li> <li>root access is granted without a password</li> <li>A system maintenance command line shell is launched</li> </ul> <p>In this mode, your system boots to runlevel 1 (in SysVinit language). To enter single user mode, you need to select an entry from the GRUB boot menu and then hit e for edit. Then add the word single to the kernel command line before telling the system to boot.</p> </article> </div> </div> </main> <footer class=md-footer> <div class=md-footer-nav> <nav class="md-footer-nav__inner md-grid" aria-label=Footer> <a href=../Linux_Foundation/ class="md-footer-nav__link md-footer-nav__link--prev" rel=prev> <div class="md-footer-nav__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer-nav__title> <div class=md-ellipsis> <span class=md-footer-nav__direction> Previous </span> Linux Foundation </div> </div> </a> <a href=../Linux_Foundation_Network_Admin/ class="md-footer-nav__link md-footer-nav__link--next" rel=next> <div class=md-footer-nav__title> <div class=md-ellipsis> <span class=md-footer-nav__direction> Next </span> Linux Network Administration </div> </div> <div class="md-footer-nav__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <script src=../../../assets/javascripts/vendor.53cc9318.min.js></script> <script src=../../../assets/javascripts/bundle.e9c9f54f.min.js></script><script id=__lang type=application/json>{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script> <script>
        app = initialize({
          base: "../../..",
          features: ['navigation.tabs', 'navigation.instant'],
          search: Object.assign({
            worker: "../../../assets/javascripts/worker/search.9c0e82ba.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script> </body> </html>