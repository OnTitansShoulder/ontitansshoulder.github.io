<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="We are all standing on the shoulders of the giants..."><meta name=author content="Zhongkai Liu"><link rel="shortcut icon" href=../../assets/favicon.ico><meta name=generator content="mkdocs-1.1.2, mkdocs-material-6.2.6"><title>Kafka - Ontitansshoulder</title><link rel=stylesheet href=../../assets/stylesheets/main.cb6bc1d0.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.39b8e14a.min.css><meta name=theme-color content=#4051b5><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style><link rel=stylesheet href=../../css/extra.css></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#main-concepts class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid" aria-label=Header> <a href=../.. title=Ontitansshoulder class="md-header-nav__button md-logo" aria-label=Ontitansshoulder> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg> </a> <label class="md-header-nav__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header-nav__title data-md-component=header-title> <div class=md-header-nav__ellipsis> <div class=md-header-nav__topic> <span class=md-ellipsis> Ontitansshoulder </span> </div> <div class=md-header-nav__topic> <span class=md-ellipsis> Kafka </span> </div> </div> </div> <label class="md-header-nav__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query data-md-state=active required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <button type=reset class="md-search__icon md-icon" aria-label=Clear data-md-component=search-reset tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Notes </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=Ontitansshoulder class="md-nav__button md-logo" aria-label=Ontitansshoulder> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg> </a> Ontitansshoulder </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1 type=checkbox id=nav-1> <label class=md-nav__link for=nav-1> Notes <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Notes data-md-level=1> <label class=md-nav__title for=nav-1> <span class="md-nav__icon md-icon"></span> Notes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> Welcome </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-2 type=checkbox id=nav-1-2> <label class=md-nav__link for=nav-1-2> Foundamentals <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Foundamentals data-md-level=2> <label class=md-nav__title for=nav-1-2> <span class="md-nav__icon md-icon"></span> Foundamentals </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Foundamental/Data_Structures_and_Algos/ class=md-nav__link> Data Structures and Algos </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-3 type=checkbox id=nav-1-3> <label class=md-nav__link for=nav-1-3> Linux <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Linux data-md-level=2> <label class=md-nav__title for=nav-1-3> <span class="md-nav__icon md-icon"></span> Linux </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-3-1 type=checkbox id=nav-1-3-1> <label class=md-nav__link for=nav-1-3-1> Concepts <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Concepts data-md-level=3> <label class=md-nav__title for=nav-1-3-1> <span class="md-nav__icon md-icon"></span> Concepts </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Linux/Concepts/Linux_Foundation/ class=md-nav__link> Linux Foundation </a> </li> <li class=md-nav__item> <a href=../../Linux/Concepts/Linux_Foundation_System_Admin/ class=md-nav__link> Linux System Administration </a> </li> <li class=md-nav__item> <a href=../../Linux/Concepts/Linux_Foundation_Network_Admin/ class=md-nav__link> Linux Network Administration </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-3-2 type=checkbox id=nav-1-3-2> <label class=md-nav__link for=nav-1-3-2> Practical References <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Practical References" data-md-level=3> <label class=md-nav__title for=nav-1-3-2> <span class="md-nav__icon md-icon"></span> Practical References </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Linux/Commands/Freq-Used-Shell-Cmds/ class=md-nav__link> Freq Used Shell Cmds </a> </li> <li class=md-nav__item> <a href=../../Linux/Commands/Networking-Shell-Cmds/ class=md-nav__link> Freq Used Network Cmds </a> </li> <li class=md-nav__item> <a href=../../Linux/Commands/Text-Manipulating-Cmds/ class=md-nav__link> Text Manipulating Cmds </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-3-3 type=checkbox id=nav-1-3-3> <label class=md-nav__link for=nav-1-3-3> Tricks <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Tricks data-md-level=3> <label class=md-nav__title for=nav-1-3-3> <span class="md-nav__icon md-icon"></span> Tricks </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Linux/References/Freq-Tasks/ class=md-nav__link> Freq Linux Tasks </a> </li> <li class=md-nav__item> <a href=../../Linux/References/Terminal-Tricks/ class=md-nav__link> Linux Terminal Tricks </a> </li> <li class=md-nav__item> <a href=../../Linux/References/Vim-Tricks/ class=md-nav__link> Vim Tricks </a> </li> <li class=md-nav__item> <a href=../../Linux/References/Account-Administration/ class=md-nav__link> Manage Accounts & Groups </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-4 type=checkbox id=nav-1-4> <label class=md-nav__link for=nav-1-4> Cloud <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Cloud data-md-level=2> <label class=md-nav__title for=nav-1-4> <span class="md-nav__icon md-icon"></span> Cloud </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Cloud-and-Containers/Architecture/Cloud-App-Architecture/ class=md-nav__link> Cloud App Architecture </a> </li> <li class=md-nav__item> <a href=../../Cloud-and-Containers/Docker/Docker/ class=md-nav__link> Docker and Containers </a> </li> <li class=md-nav__item> <a href=../../Cloud-and-Containers/Docker/Docker-Practical/ class=md-nav__link> Docker Practical </a> </li> <li class=md-nav__item> <a href=../../Cloud-and-Containers/k8s/K8s-Knowledge/ class=md-nav__link> K8s Knowledge </a> </li> <li class=md-nav__item> <a href=../../Cloud-and-Containers/k8s/service_mesh/ class=md-nav__link> Service Mesh </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-5 type=checkbox id=nav-1-5> <label class=md-nav__link for=nav-1-5> Monitoring <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Monitoring data-md-level=2> <label class=md-nav__title for=nav-1-5> <span class="md-nav__icon md-icon"></span> Monitoring </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-5-1 type=checkbox id=nav-1-5-1> <label class=md-nav__link for=nav-1-5-1> Splunk <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Splunk data-md-level=3> <label class=md-nav__title for=nav-1-5-1> <span class="md-nav__icon md-icon"></span> Splunk </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Dev-Tools-Reference/Splunk/Splunk-References/ class=md-nav__link> Splunk Knowledge </a> </li> <li class=md-nav__item> <a href=../../Dev-Tools-Reference/Splunk/Splunk-Dashboarding/ class=md-nav__link> Splunk Dashboarding </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-6 type=checkbox id=nav-1-6> <label class=md-nav__link for=nav-1-6> Programming Langs <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Programming Langs" data-md-level=2> <label class=md-nav__title for=nav-1-6> <span class="md-nav__icon md-icon"></span> Programming Langs </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-6-1 type=checkbox id=nav-1-6-1> <label class=md-nav__link for=nav-1-6-1> Golang <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Golang data-md-level=3> <label class=md-nav__title for=nav-1-6-1> <span class="md-nav__icon md-icon"></span> Golang </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Programming-Lang-Reference/Golang/Golang-Specs/ class=md-nav__link> Golang Language Reference </a> </li> <li class=md-nav__item> <a href=../../Programming-Lang-Reference/Golang/Best-Practices/ class=md-nav__link> Effective Go </a> </li> <li class=md-nav__item> <a href=../../Programming-Lang-Reference/Golang/Freq-Used-Libs/ class=md-nav__link> Go libraries and examples </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-6-2 type=checkbox id=nav-1-6-2> <label class=md-nav__link for=nav-1-6-2> Java <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Java data-md-level=3> <label class=md-nav__title for=nav-1-6-2> <span class="md-nav__icon md-icon"></span> Java </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Programming-Lang-Reference/Java/Style-Guide/ class=md-nav__link> Style Guide </a> </li> <li class=md-nav__item> <a href=../../Programming-Lang-Reference/Java/Best-Practices/ class=md-nav__link> Effective Java </a> </li> <li class=md-nav__item> <a href=../../Programming-Lang-Reference/Java/Design-Patterns/ class=md-nav__link> Java Design Patterns </a> </li> <li class=md-nav__item> <a href=../../Programming-Lang-Reference/Java/Testing-Design-Patterns/ class=md-nav__link> Testing Design Patterns </a> </li> <li class=md-nav__item> <a href=../../Programming-Lang-Reference/Java/Java_Std_Lib_Cheatsheet/ class=md-nav__link> Java Std Lib Cheatsheet </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-6-3 type=checkbox id=nav-1-6-3> <label class=md-nav__link for=nav-1-6-3> C++ <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=C++ data-md-level=3> <label class=md-nav__title for=nav-1-6-3> <span class="md-nav__icon md-icon"></span> C++ </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Programming-Lang-Reference/CPP/CPlusPlus_Lang_Specs/ class=md-nav__link> C++ Language Reference </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-6-4 type=checkbox id=nav-1-6-4> <label class=md-nav__link for=nav-1-6-4> Perl <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Perl data-md-level=3> <label class=md-nav__title for=nav-1-6-4> <span class="md-nav__icon md-icon"></span> Perl </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Programming-Lang-Reference/Perl/Perl-Lang-Specs/ class=md-nav__link> Perl Language Reference </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-6-5 type=checkbox id=nav-1-6-5> <label class=md-nav__link for=nav-1-6-5> Shell <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Shell data-md-level=3> <label class=md-nav__title for=nav-1-6-5> <span class="md-nav__icon md-icon"></span> Shell </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Programming-Lang-Reference/Shell/Shell-Scripting/ class=md-nav__link> Shell Scripting </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../Programming-Lang-Reference/Github-Markdown/ class=md-nav__link> Github Markdown Guide </a> </li> <li class=md-nav__item> <a href=../../Programming-Lang-Reference/Regex-Specs/ class=md-nav__link> Regex Cheatsheet </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-7 type=checkbox id=nav-1-7> <label class=md-nav__link for=nav-1-7> Reading Notes <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Reading Notes" data-md-level=2> <label class=md-nav__title for=nav-1-7> <span class="md-nav__icon md-icon"></span> Reading Notes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Reading-Notes/How-Netflix-Works/ class=md-nav__link> How Netflix Works </a> </li> <li class=md-nav__item> <a href=../../Reading-Notes/System-Design-Concepts/ class=md-nav__link> System Design Guide </a> </li> <li class=md-nav__item> <a href=../../Reading-Notes/Why-Latency-Matters/ class=md-nav__link> Why Latency Matters </a> </li> <li class=md-nav__item> <a href=../../Reading-Notes/DevOps_SRE/ class=md-nav__link> Intro to DevOps and SRE </a> </li> <li class=md-nav__item> <a href=../../Reading-Notes/Leading-without-formal-authority/ class=md-nav__link> Leading Without Formal Authority </a> </li> <li class=md-nav__item> <a href=../../Reading-Notes/Google-SRE-Book/ class=md-nav__link> Google SRE Book </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../Good-Reads/ class=md-nav__link> Good Reads </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#main-concepts class=md-nav__link> Main Concepts </a> </li> <li class=md-nav__item> <a href=#kafka-apis class=md-nav__link> Kafka APIs </a> </li> <li class=md-nav__item> <a href=#kafka-deeper-look class=md-nav__link> Kafka Deeper Look </a> <nav class=md-nav aria-label="Kafka Deeper Look"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#kafkas-high-throughput class=md-nav__link> Kafka's High Throughput </a> <nav class=md-nav aria-label="Kafka's High Throughput"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#log-based-message class=md-nav__link> Log-based message </a> </li> <li class=md-nav__item> <a href=#topic-partitioning class=md-nav__link> Topic Partitioning </a> </li> <li class=md-nav__item> <a href=#batch-sendreceive class=md-nav__link> Batch Send/Receive </a> </li> <li class=md-nav__item> <a href=#sendfile-syscall class=md-nav__link> sendfile syscall </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#use-cases class=md-nav__link> Use Cases </a> <nav class=md-nav aria-label="Use Cases"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#messing-queue class=md-nav__link> Messing Queue </a> </li> <li class=md-nav__item> <a href=#activity-tracking class=md-nav__link> Activity Tracking </a> </li> <li class=md-nav__item> <a href=#metrics-collection class=md-nav__link> Metrics Collection </a> </li> <li class=md-nav__item> <a href=#log-aggregation class=md-nav__link> Log Aggregation </a> </li> <li class=md-nav__item> <a href=#stream-processing class=md-nav__link> Stream Processing </a> </li> <li class=md-nav__item> <a href=#event-sourcing class=md-nav__link> Event Sourcing </a> </li> <li class=md-nav__item> <a href=#commit-logs class=md-nav__link> Commit Logs </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <h1>Kafka</h1> <p><strong>Kafka</strong> is an event streaming platform that implements the key capabilities end-to-end, and all the functionalities are provided in a <strong>distributed</strong>, highly <strong>scalable</strong>, <strong>elastic</strong>, <strong>fault-tolerant</strong>, and <strong>secure</strong> mannor.</p> <p>Kafka is a distributed system consisting of servers and clients that communicate via a high-performance TCP network protocol.</p> <p>Kafka servers can span multiple regions. Some form the <strong>storage</strong> layer, called <strong>brokers</strong>. Others run <strong>Kafka Connect</strong> to continuously <strong>import and export</strong> data as event streams to integrate Kafka with your existing systems such as relational databases as well as other Kafka clusters.</p> <p>Kafka clients can be distributed <strong>applications</strong> and <strong>microservices</strong> you built that read, write, and process streams of events in parallel, at scale, and in a fault-tolerant manner. Kafka ships with some such clients included; there are also <strong>Kafka Streams</strong> library and REST APIs for many languages.</p> <p>Kafka is widely used in software industry and is backed by a large and active community of opensource engineers.</p> <h2 id=main-concepts>Main Concepts<a class=headerlink href=#main-concepts title="Permanent link">&para;</a></h2> <p>An <strong>event</strong> records the fact that "something happened" in the world or in your business. An event has a <code>key, value, timestamp</code>, and optional <code>metadata</code> headers. </p> <p><strong>Producers</strong> are those client applications that publish (write) events to Kafka. </p> <p><strong>Clients</strong> talk to Producers/Brokers to insert events to Kafka, and several other components work with Producers to ensure the non-duplicated successful deliver of a client message:</p> <ol> <li>A Client sends the message to Producer and get an ACK.</li> <li>Client sends a synchronous blocking request to the Future server</li> <li>Once Producer gets a message, it append it to the RecordAccumulator</li> <li>Once certain condition is met (time, numb of records), the RecordAccumulator prepares and make the accumulated records as a RecordAppendResult to persist to storage</li> <li>Once it is complete, it sends a confirmation to the Future server</li> <li>The Future server responses to the Client that the message send is complete.</li> </ol> <p><strong>Consumers</strong> are those that subscribe to (read and process) these events. Producers and consumers are fully decoupled and agnostic of each other, which is a key design element to achieve the high scalability.</p> <p><strong>Consumer group</strong> is the unit which Kafka uses to map one topic partition to. Each partition can only be connected and consumed by one of the consumers within a consumer group. A consumer group can have one or more consumers. A consumer can connect to multiple partitions from multiple topics. A partition, however, can ONLY have one consumer connected to it.</p> <p>Events are organized and durably stored in <strong>topics</strong>. Topics in Kafka are always multi-producer and multi-subscriber. Events in a topic can be read as often as needed and are <strong>NOT deleted</strong> after consumption; an event retain limit can be defined instead. Kafka's performance is effectively <strong>constant</strong> with respect to data size.</p> <p>Topics are <strong>partitioned</strong>, meaning a topic is spread over a number of "buckets" located on different Kafka brokers. Kafka guarantees that any consumer of a given topic-partition will always read that partition's events in exactly the <strong>same order</strong> as they were written. Every topic can be <strong>replicated</strong> for fault-tolerance and availability.</p> <h2 id=kafka-apis>Kafka APIs<a class=headerlink href=#kafka-apis title="Permanent link">&para;</a></h2> <ul> <li><strong>Producer</strong> API - publish (write) a stream of events to one or more Kafka topics</li> <li><strong>Consumer</strong> API - subscribe to (read) one or more topics and to process the stream of events produced</li> <li><strong>Streams</strong> API - for implementing stream processing applications and microservices, provides higher-level functions including transformations, stateful operations like aggregations and joins, windowing, processing based on event-time, etc., effectively transforming the input streams to output streams<ul> <li>alternative open source stream processing tools include Apache Storm and Apache Samza</li> </ul> </li> <li><strong>Connect</strong> API - build and run reusable data import/export connectors that consume (read) or produce (write) streams of events from and to external systems and applications</li> <li><strong>Admin</strong> API - manage and inspect topics, brokers, and other Kafka objects<ul> <li>talks to the Zookeeper</li> </ul> </li> </ul> <h2 id=kafka-deeper-look>Kafka Deeper Look<a class=headerlink href=#kafka-deeper-look title="Permanent link">&para;</a></h2> <h3 id=kafkas-high-throughput>Kafka's High Throughput<a class=headerlink href=#kafkas-high-throughput title="Permanent link">&para;</a></h3> <h4 id=log-based-message>Log-based message<a class=headerlink href=#log-based-message title="Permanent link">&para;</a></h4> <p><strong>log-based</strong> event message format allows append-only operation, fast to write. Log files are saved in directories of the name <code>topic name</code> appended with <code>partition number</code>.</p> <p>The log files in each partition are <strong>indexed</strong> for fast search. Each log message is of <code>1+4+n</code> bytes long:</p> <ul> <li>"magic" value of 1 byte: version number</li> <li>CRC (Cyclic Redundancy Check) of 4 bytes: ensures message integrity</li> <li>payload of n bytes: actual message body</li> </ul> <h4 id=topic-partitioning>Topic Partitioning<a class=headerlink href=#topic-partitioning title="Permanent link">&para;</a></h4> <p>Topics are <strong>partitioned</strong> to distribute the load and allow fast search and send. Each partition logs are saved as same-sized <strong>segments</strong>, the number of messages in each segment may vary depends on the message length.</p> <p>Logs in each partition are append-only and write to the last segment; the segment got written to disk once a condition is met. Logs are read in order.</p> <p>Log indexes stores the start location of each message based on its id. There is also a timeIndex that stores the start location based on its timestamp.</p> <h4 id=batch-sendreceive>Batch Send/Receive<a class=headerlink href=#batch-sendreceive title="Permanent link">&para;</a></h4> <p><strong>Batch</strong> sending and receiving with data compression saves number of network calls and bandwidth</p> <h4 id=sendfile-syscall>sendfile syscall<a class=headerlink href=#sendfile-syscall title="Permanent link">&para;</a></h4> <p>A typical read file and send file over network flow is roughly as such:</p> <ul> <li>Server program instructs Kernel to load a file from disk<ul> <li>Kernel does syscall to load file into Kernel buffer memory</li> <li>File content is copied from Kernel buffer to User space buffer memory for the Server program</li> <li>Kernel returns control back to the Server program</li> </ul> </li> <li>Server program initiates send to the Network interface<ul> <li>File content is optionally serialized and put back to memory</li> <li>File content is copied to socket buffer</li> <li>File content is sent through Network interface</li> </ul> </li> <li>Data pass through the Internet hops and reach the target user</li> </ul> <p>Use Linux <strong><code>sendfile</code></strong> system call to pass files to network socket buffer, avoid re-copying IO from filesystem to user space memory and then copied to the network socket buffer memory, which saves two copy operations.</p> <h2 id=use-cases>Use Cases<a class=headerlink href=#use-cases title="Permanent link">&para;</a></h2> <h3 id=messing-queue>Messing Queue<a class=headerlink href=#messing-queue title="Permanent link">&para;</a></h3> <p>Unlike other MessageQueue solutions such as ActiveMQ, Kafka does NOT guarantee the <strong>strict order</strong> of messages being processed, because Kafka holds messages for potential re-processing.</p> <p>Message order on each partition is ordered. Use key and offset to keep a rough order of messages during read.</p> <h3 id=activity-tracking>Activity Tracking<a class=headerlink href=#activity-tracking title="Permanent link">&para;</a></h3> <h3 id=metrics-collection>Metrics Collection<a class=headerlink href=#metrics-collection title="Permanent link">&para;</a></h3> <h3 id=log-aggregation>Log Aggregation<a class=headerlink href=#log-aggregation title="Permanent link">&para;</a></h3> <h3 id=stream-processing>Stream Processing<a class=headerlink href=#stream-processing title="Permanent link">&para;</a></h3> <h3 id=event-sourcing>Event Sourcing<a class=headerlink href=#event-sourcing title="Permanent link">&para;</a></h3> <h3 id=commit-logs>Commit Logs<a class=headerlink href=#commit-logs title="Permanent link">&para;</a></h3> </article> </div> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <script src=../../assets/javascripts/vendor.53cc9318.min.js></script> <script src=../../assets/javascripts/bundle.e9c9f54f.min.js></script><script id=__lang type=application/json>{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script> <script>
        app = initialize({
          base: "../..",
          features: ['navigation.tabs', 'navigation.instant'],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.9c0e82ba.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script> </body> </html>