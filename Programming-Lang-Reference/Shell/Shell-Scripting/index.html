<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="We are all standing on the shoulders of the giants..."><meta name=author content="Zhongkai Liu"><link rel="shortcut icon" href=../../../assets/favicon.ico><meta name=generator content="mkdocs-1.1.2, mkdocs-material-6.2.6"><title>Shell Scripting - Ontitansshoulder</title><link rel=stylesheet href=../../../assets/stylesheets/main.cb6bc1d0.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.39b8e14a.min.css><meta name=theme-color content=#4051b5><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style><link rel=stylesheet href=../../../css/extra.css></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#getting-to-know-shell-script class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid" aria-label=Header> <a href=../../.. title=Ontitansshoulder class="md-header-nav__button md-logo" aria-label=Ontitansshoulder> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg> </a> <label class="md-header-nav__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header-nav__title data-md-component=header-title> <div class=md-header-nav__ellipsis> <div class=md-header-nav__topic> <span class=md-ellipsis> Ontitansshoulder </span> </div> <div class=md-header-nav__topic> <span class=md-ellipsis> Shell Scripting </span> </div> </div> </div> <label class="md-header-nav__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query data-md-state=active required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <button type=reset class="md-search__icon md-icon" aria-label=Clear data-md-component=search-reset tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class="md-tabs__link md-tabs__link--active"> Notes </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title=Ontitansshoulder class="md-nav__button md-logo" aria-label=Ontitansshoulder> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg> </a> Ontitansshoulder </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1 type=checkbox id=nav-1 checked> <label class=md-nav__link for=nav-1> Notes <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Notes data-md-level=1> <label class=md-nav__title for=nav-1> <span class="md-nav__icon md-icon"></span> Notes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> Welcome </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-2 type=checkbox id=nav-1-2> <label class=md-nav__link for=nav-1-2> Foundamentals <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Foundamentals data-md-level=2> <label class=md-nav__title for=nav-1-2> <span class="md-nav__icon md-icon"></span> Foundamentals </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Foundamental/Data_Structures_and_Algos/ class=md-nav__link> Data Structures and Algos </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-3 type=checkbox id=nav-1-3> <label class=md-nav__link for=nav-1-3> Linux <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Linux data-md-level=2> <label class=md-nav__title for=nav-1-3> <span class="md-nav__icon md-icon"></span> Linux </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-3-1 type=checkbox id=nav-1-3-1> <label class=md-nav__link for=nav-1-3-1> Concepts <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Concepts data-md-level=3> <label class=md-nav__title for=nav-1-3-1> <span class="md-nav__icon md-icon"></span> Concepts </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Linux/Concepts/Linux_Foundation/ class=md-nav__link> Linux Foundation </a> </li> <li class=md-nav__item> <a href=../../../Linux/Concepts/Linux_Foundation_System_Admin/ class=md-nav__link> Linux System Administration </a> </li> <li class=md-nav__item> <a href=../../../Linux/Concepts/Linux_Foundation_Network_Admin/ class=md-nav__link> Linux Network Administration </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-3-2 type=checkbox id=nav-1-3-2> <label class=md-nav__link for=nav-1-3-2> Practical References <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Practical References" data-md-level=3> <label class=md-nav__title for=nav-1-3-2> <span class="md-nav__icon md-icon"></span> Practical References </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Linux/Commands/Freq-Used-Shell-Cmds/ class=md-nav__link> Freq Used Shell Cmds </a> </li> <li class=md-nav__item> <a href=../../../Linux/Commands/Networking-Shell-Cmds/ class=md-nav__link> Freq Used Network Cmds </a> </li> <li class=md-nav__item> <a href=../../../Linux/Commands/Text-Manipulating-Cmds/ class=md-nav__link> Text Manipulating Cmds </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-3-3 type=checkbox id=nav-1-3-3> <label class=md-nav__link for=nav-1-3-3> Tricks <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Tricks data-md-level=3> <label class=md-nav__title for=nav-1-3-3> <span class="md-nav__icon md-icon"></span> Tricks </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Linux/References/Freq-Tasks/ class=md-nav__link> Freq Linux Tasks </a> </li> <li class=md-nav__item> <a href=../../../Linux/References/Terminal-Tricks/ class=md-nav__link> Linux Terminal Tricks </a> </li> <li class=md-nav__item> <a href=../../../Linux/References/Vim-Tricks/ class=md-nav__link> Vim Tricks </a> </li> <li class=md-nav__item> <a href=../../../Linux/References/Account-Administration/ class=md-nav__link> Manage Accounts & Groups </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-4 type=checkbox id=nav-1-4> <label class=md-nav__link for=nav-1-4> Cloud <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Cloud data-md-level=2> <label class=md-nav__title for=nav-1-4> <span class="md-nav__icon md-icon"></span> Cloud </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Cloud-and-Containers/Architecture/Cloud-App-Architecture/ class=md-nav__link> Cloud App Architecture </a> </li> <li class=md-nav__item> <a href=../../../Cloud-and-Containers/Docker/Docker/ class=md-nav__link> Docker and Containers </a> </li> <li class=md-nav__item> <a href=../../../Cloud-and-Containers/Docker/Docker-Practical/ class=md-nav__link> Docker Practical </a> </li> <li class=md-nav__item> <a href=../../../Cloud-and-Containers/k8s/K8s-Knowledge/ class=md-nav__link> K8s Knowledge </a> </li> <li class=md-nav__item> <a href=../../../Cloud-and-Containers/k8s/service_mesh/ class=md-nav__link> Service Mesh </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-5 type=checkbox id=nav-1-5> <label class=md-nav__link for=nav-1-5> Monitoring <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Monitoring data-md-level=2> <label class=md-nav__title for=nav-1-5> <span class="md-nav__icon md-icon"></span> Monitoring </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-5-1 type=checkbox id=nav-1-5-1> <label class=md-nav__link for=nav-1-5-1> Splunk <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Splunk data-md-level=3> <label class=md-nav__title for=nav-1-5-1> <span class="md-nav__icon md-icon"></span> Splunk </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Dev-Tools-Reference/Splunk/Splunk-References/ class=md-nav__link> Splunk Knowledge </a> </li> <li class=md-nav__item> <a href=../../../Dev-Tools-Reference/Splunk/Splunk-Dashboarding/ class=md-nav__link> Splunk Dashboarding </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-6 type=checkbox id=nav-1-6 checked> <label class=md-nav__link for=nav-1-6> Programming Langs <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Programming Langs" data-md-level=2> <label class=md-nav__title for=nav-1-6> <span class="md-nav__icon md-icon"></span> Programming Langs </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-6-1 type=checkbox id=nav-1-6-1> <label class=md-nav__link for=nav-1-6-1> Golang <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Golang data-md-level=3> <label class=md-nav__title for=nav-1-6-1> <span class="md-nav__icon md-icon"></span> Golang </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Golang/Golang-Specs/ class=md-nav__link> Golang Language Reference </a> </li> <li class=md-nav__item> <a href=../../Golang/Best-Practices/ class=md-nav__link> Effective Go </a> </li> <li class=md-nav__item> <a href=../../Golang/Freq-Used-Libs/ class=md-nav__link> Go libraries and examples </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-6-2 type=checkbox id=nav-1-6-2> <label class=md-nav__link for=nav-1-6-2> Java <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Java data-md-level=3> <label class=md-nav__title for=nav-1-6-2> <span class="md-nav__icon md-icon"></span> Java </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Java/Style-Guide/ class=md-nav__link> Style Guide </a> </li> <li class=md-nav__item> <a href=../../Java/Best-Practices/ class=md-nav__link> Effective Java </a> </li> <li class=md-nav__item> <a href=../../Java/Design-Patterns/ class=md-nav__link> Java Design Patterns </a> </li> <li class=md-nav__item> <a href=../../Java/Testing-Design-Patterns/ class=md-nav__link> Testing Design Patterns </a> </li> <li class=md-nav__item> <a href=../../Java/Java_Std_Lib_Cheatsheet/ class=md-nav__link> Java Std Lib Cheatsheet </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-6-3 type=checkbox id=nav-1-6-3> <label class=md-nav__link for=nav-1-6-3> C++ <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=C++ data-md-level=3> <label class=md-nav__title for=nav-1-6-3> <span class="md-nav__icon md-icon"></span> C++ </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../CPP/CPlusPlus_Lang_Specs/ class=md-nav__link> C++ Language Reference </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-6-4 type=checkbox id=nav-1-6-4> <label class=md-nav__link for=nav-1-6-4> Perl <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Perl data-md-level=3> <label class=md-nav__title for=nav-1-6-4> <span class="md-nav__icon md-icon"></span> Perl </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Perl/Perl-Lang-Specs/ class=md-nav__link> Perl Language Reference </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-6-5 type=checkbox id=nav-1-6-5 checked> <label class=md-nav__link for=nav-1-6-5> Shell <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Shell data-md-level=3> <label class=md-nav__title for=nav-1-6-5> <span class="md-nav__icon md-icon"></span> Shell </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Shell Scripting <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Shell Scripting </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#getting-to-know-shell-script class=md-nav__link> Getting to Know Shell Script </a> </li> <li class=md-nav__item> <a href=#shell-environment-variables class=md-nav__link> shell (environment) variables </a> </li> <li class=md-nav__item> <a href=#filtering-commands class=md-nav__link> Filtering Commands </a> </li> <li class=md-nav__item> <a href=#expansion class=md-nav__link> Expansion </a> </li> <li class=md-nav__item> <a href=#permissions class=md-nav__link> Permissions </a> </li> <li class=md-nav__item> <a href=#job-control class=md-nav__link> Job Control </a> </li> <li class=md-nav__item> <a href=#editing-shell-scripts class=md-nav__link> Editing Shell Scripts </a> </li> <li class=md-nav__item> <a href=#creating-shell-functions class=md-nav__link> Creating shell functions </a> </li> <li class=md-nav__item> <a href=#here-script class=md-nav__link> Here Script </a> </li> <li class=md-nav__item> <a href=#variables class=md-nav__link> Variables </a> </li> <li class=md-nav__item> <a href=#control-flow class=md-nav__link> Control flow </a> </li> <li class=md-nav__item> <a href=#io-redirection class=md-nav__link> I/O Redirection </a> </li> <li class=md-nav__item> <a href=#take-user-inputs class=md-nav__link> Take user inputs </a> </li> <li class=md-nav__item> <a href=#positional-parameters class=md-nav__link> Positional parameters </a> </li> <li class=md-nav__item> <a href=#error-handling class=md-nav__link> Error Handling </a> </li> <li class=md-nav__item> <a href=#signals-and-traps class=md-nav__link> Signals and Traps </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../Github-Markdown/ class=md-nav__link> Github Markdown Guide </a> </li> <li class=md-nav__item> <a href=../../Regex-Specs/ class=md-nav__link> Regex Cheatsheet </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-1-7 type=checkbox id=nav-1-7> <label class=md-nav__link for=nav-1-7> Reading Notes <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Reading Notes" data-md-level=2> <label class=md-nav__title for=nav-1-7> <span class="md-nav__icon md-icon"></span> Reading Notes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../Reading-Notes/How-Netflix-Works/ class=md-nav__link> How Netflix Works </a> </li> <li class=md-nav__item> <a href=../../../Reading-Notes/System-Design-Concepts/ class=md-nav__link> System Design Guide </a> </li> <li class=md-nav__item> <a href=../../../Reading-Notes/Why-Latency-Matters/ class=md-nav__link> Why Latency Matters </a> </li> <li class=md-nav__item> <a href=../../../Reading-Notes/DevOps_SRE/ class=md-nav__link> Intro to DevOps and SRE </a> </li> <li class=md-nav__item> <a href=../../../Reading-Notes/Leading-without-formal-authority/ class=md-nav__link> Leading Without Formal Authority </a> </li> <li class=md-nav__item> <a href=../../../Reading-Notes/Google-SRE-Book/ class=md-nav__link> Google SRE Book </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../Good-Reads/ class=md-nav__link> Good Reads </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#getting-to-know-shell-script class=md-nav__link> Getting to Know Shell Script </a> </li> <li class=md-nav__item> <a href=#shell-environment-variables class=md-nav__link> shell (environment) variables </a> </li> <li class=md-nav__item> <a href=#filtering-commands class=md-nav__link> Filtering Commands </a> </li> <li class=md-nav__item> <a href=#expansion class=md-nav__link> Expansion </a> </li> <li class=md-nav__item> <a href=#permissions class=md-nav__link> Permissions </a> </li> <li class=md-nav__item> <a href=#job-control class=md-nav__link> Job Control </a> </li> <li class=md-nav__item> <a href=#editing-shell-scripts class=md-nav__link> Editing Shell Scripts </a> </li> <li class=md-nav__item> <a href=#creating-shell-functions class=md-nav__link> Creating shell functions </a> </li> <li class=md-nav__item> <a href=#here-script class=md-nav__link> Here Script </a> </li> <li class=md-nav__item> <a href=#variables class=md-nav__link> Variables </a> </li> <li class=md-nav__item> <a href=#control-flow class=md-nav__link> Control flow </a> </li> <li class=md-nav__item> <a href=#io-redirection class=md-nav__link> I/O Redirection </a> </li> <li class=md-nav__item> <a href=#take-user-inputs class=md-nav__link> Take user inputs </a> </li> <li class=md-nav__item> <a href=#positional-parameters class=md-nav__link> Positional parameters </a> </li> <li class=md-nav__item> <a href=#error-handling class=md-nav__link> Error Handling </a> </li> <li class=md-nav__item> <a href=#signals-and-traps class=md-nav__link> Signals and Traps </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <h1>Shell Scripting</h1> <p>Big thanks to William Shotts Jr. from linuxcommand.org for this great educational resource. Here are my reading notes taken.</p> <p><br></p> <h3 id=getting-to-know-shell-script>Getting to Know Shell Script<a class=headerlink href=#getting-to-know-shell-script title="Permanent link">&para;</a></h3> <p>There is no way to remember every command and every option associated with it. The real power is to know how to quickly learn from man page and write scripts to do what you need to do.</p> <div class=highlight><pre><span></span><code><span class=ch>#!/bin/bash</span>
<span class=c1># A line of comment</span>
<span class=nb>echo</span> <span class=s2>&quot;Hello World!&quot;</span>
</code></pre></div> <p>The first line is called a <strong>shebang</strong>, indicating what program is used to interpret the script.</p> <p>Other scripting languages such as Perl, awk, tcl, Tk, and python also use this mechanism.</p> <p>After giving a file execution permission, it can be run using <code>./script_name</code></p> <p><strong>PATH</strong> is where Linux scans for commands and executable scripts</p> <p>If a directory need to be added to the PATH var, do <code>export PATH=$PATH:directory</code>.</p> <p>It is better to add this line to the <code>.bash_profile</code> or <code>.profile</code> file in your home directory.</p> <p>Linux encourage each user to have a specific directory for programs the user personally uses, <code>bin</code> in the user's home directory. This is automatically included in the <code>$PATH</code> var.</p> <p><br></p> <h3 id=shell-environment-variables>shell (environment) variables<a class=headerlink href=#shell-environment-variables title="Permanent link">&para;</a></h3> <p>Linux is a multi-user system, each person logged-in will get a bash to use. Each bash will have a set of environment variables to make sure users workspace clean.</p> <p>To set a <strong>shell variable</strong>, a few things:</p> <ol> <li><code>var_name=value</code></li> <li>no spaces on two sides of '='</li> <li><em>var_name</em> can't start with number; var_name contains only alphanumeric chars</li> <li>if var's value contains spaces, use <code>""</code> or <code>''</code> to wrap it up;</li> <li>variables can be evaluated within <code>""</code>, but not <code>''</code></li> <li>use escape char <code>\</code> to include special chars in variables created within <code>""</code>.</li> <li>can assign variable value from command's output using <code>$( &lt;shell_expression&gt; )</code></li> <li>use <code>export var_name</code> to make the variable an <strong>environment variable</strong></li> <li>usually <strong>capitalized</strong> VAR_NAME is an environment variable</li> <li>use <code>unset</code> to cancel/remove a variable</li> </ol> <p>use <code>env</code> to see a list of all environment vars</p> <ul> <li><code>$RANDOM</code> is a special env var that gives a random number between 0-32767 every time used.</li> </ul> <p>use <code>set</code> to see a list of user defined vars</p> <ul> <li><code>$PS1</code> is the command character as well as anything before it! It can be customized to display more info at the beginning of each line of command in terminal.<ul> <li>see <em>Linux Terminal Tricks</em> notes</li> </ul> </li> <li><code>$$</code> itself is a variable showing current shell's PID.<ul> <li>sub-program of bash can only <strong>inherit</strong> the parent's environment vars, not regular vars</li> <li>export normal vars as env vars if necessary</li> </ul> </li> </ul> <p><code>read</code> command allows user to enter something and store it as a variable. Useful for script requires user input.</p> <p><code>declare</code> or <code>typeset</code> both can set the variable type of a variable</p> <ul> <li><code>-a</code>: array</li> <li><code>-i</code>: integer</li> <li><code>-x</code>: environment variable</li> <li><code>-r</code>: readonly variable</li> <li><code>+x</code>: cancel env var setting; '+' means cancel here...</li> <li>i.e. <code>declare -i sum=100+300+50</code></li> </ul> <p><strong>Modify variable content</strong></p> <table> <thead> <tr> <th>expression -</th> <th>- purpose</th> </tr> </thead> <tbody> <tr> <td><code>${variable#key_word}</code></td> <td>from begin to end, find shortest match and delete <em>key_word</em></td> </tr> <tr> <td><code>${variable##key_word}</code></td> <td>from begin to end, find longest match and delete <em>key_word</em></td> </tr> <tr> <td><code>${variable%key_word}</code></td> <td>from end to beginning, find shortest match and delete <em>key_word</em></td> </tr> <tr> <td><code>${variable%%key_word}</code></td> <td>from end to beginning, find longest match and delete <em>key_word</em></td> </tr> <tr> <td><code>${variable/key_word/new_word}</code></td> <td>find one match of <em>key_word</em> and replace with <em>new_word</em></td> </tr> <tr> <td><code>${variable//key_word/new_word}</code></td> <td>find all matches of <em>key_word</em> and replace with <em>new_word</em></td> </tr> </tbody> </table> <p><br></p> <p><strong>Variable evaluation from another variable</strong></p> <table> <thead> <tr> <th>expression -</th> <th>- <code>str</code> not set -</th> <th>- <code>str</code> is empty -</th> <th>- <code>str</code> set and non-empty</th> </tr> </thead> <tbody> <tr> <td><code>var=${str-expr}</code></td> <td>$var=expr</td> <td>$var=</td> <td>$var=$str</td> </tr> <tr> <td><code>var=${str:-expr}</code></td> <td>$var=expr</td> <td>$var=expr</td> <td>$var=$str</td> </tr> <tr> <td><code>var=${str+expr}</code></td> <td>$var=</td> <td>$var=expr</td> <td>$var=expr</td> </tr> <tr> <td><code>var=${str:+expr}</code></td> <td>$var=</td> <td>$var=</td> <td>$var=expr</td> </tr> <tr> <td><code>var=${str=expr}</code></td> <td>$str=expr, $var=expr</td> <td>$str unchanged, $var=</td> <td>$str unchanged, $var=$str</td> </tr> <tr> <td><code>var=${str:=expr}</code></td> <td>$str=expr, $var=expr</td> <td>$str=expr, $var=expr</td> <td>$str unchanged, $var=$str</td> </tr> <tr> <td><code>var=${str?expr}</code></td> <td>prints <code>expr</code> to stderr</td> <td>$var=</td> <td>$var=$str</td> </tr> <tr> <td><code>var=${str:?expr}</code></td> <td>prints <code>expr</code> to stderr</td> <td>prints <code>expr</code> to stderr</td> <td>$var=$str</td> </tr> </tbody> </table> <p><br></p> <p>use <code>${#Var_Name}</code> to get the string length of a variable.</p> <p><strong>array/list variable</strong> can be created using syntax of <code>VARS=()</code> - initialize with values <code>VARS=(a b c)</code> - change index value with <code>VARS[0]="values"</code> - access array indexes with <code>${VARS[0]}</code> - get a string of all items of an array variable with <code>${VARS[@]}</code> - get array length with <code>${#VARS[@]}</code> - indexes start at 0. No need to specify initial capacity.</p> <p><br></p> <p>use <code>source</code> to load configuration from a file immediately</p> <p><br></p> <h3 id=filtering-commands>Filtering Commands<a class=headerlink href=#filtering-commands title="Permanent link">&para;</a></h3> <p>Take std input and perform operations upon it and send results to std output</p> <table> <thead> <tr> <th>Command -</th> <th>- What it does</th> </tr> </thead> <tbody> <tr> <td><code>sort</code></td> <td>sorts std input then outputs sorted result</td> </tr> <tr> <td><code>uniq</code></td> <td>given a stream of data, removes duplicate lines</td> </tr> <tr> <td><code>grep</code></td> <td>examines each line receives, outputs lines containing specified patterns</td> </tr> <tr> <td><code>fmt</code></td> <td>reads text from input and outputs formatted text</td> </tr> <tr> <td><code>pr</code></td> <td>takes text input and splits data into pages with page breaks, headers and footers in preparation for printing</td> </tr> <tr> <td><code>head</code></td> <td>outputs first few lines of input</td> </tr> <tr> <td><code>tail</code></td> <td>outputs last few lines of input</td> </tr> <tr> <td><code>tr</code></td> <td>translate characters, such as upper/lowercase conversions, changing line termination chars.</td> </tr> <tr> <td><code>sed</code></td> <td>stream editor, perform more sophisticated text translations than <code>tr</code>. supports regex</td> </tr> <tr> <td><code>awk</code></td> <td>a programming lang designed for constructing filters</td> </tr> </tbody> </table> <p><br></p> <p>Example: Printing from the command line</p> <ul> <li><code>cat report.txt | sort | uniq | fmt | pr | lpr</code></li> <li><code>cat</code> is used to concatenate files and gives to output. here can be used to put single file content to std output</li> <li><code>fmt</code> formats text into neat paragraphs</li> <li><code>pr</code> splits text neatly into pages</li> <li><code>lpr</code> sends std input to printer</li> </ul> <p><strong>use of -</strong></p> <ul> <li>use <code>-</code> can replace stdin and stdout without creating files.</li> <li>i.e. <code>tar -cvf - /home | tar -xvf -</code></li> <li>will pack the files and pass it to next command without writing to a file.</li> </ul> <p><br></p> <h3 id=expansion>Expansion<a class=headerlink href=#expansion title="Permanent link">&para;</a></h3> <p>expansion is when your command typed-in expanded into something else before shell acts upon it.</p> <p><strong>Pathname Expansion</strong>: we can use <code>echo D*</code> to show files starting with 'D' in the current directory.</p> <p><strong>Tilde Expansion</strong></p> <ul> <li><code>~</code> char has special meanings:<ul> <li>at beginning of a word, it expands to the name of the home directory of the named user.</li> <li>at the end of a filename, it means this file is a temporary backup</li> <li>if used alone it refers to the home directory of current user</li> </ul> </li> </ul> <p><strong>Arithmetic Expansion</strong>: the use of <code>$((expression))</code> allows arithmetic evaluation inside the <code>$()</code> syntax</p> <ul> <li>if shell variables are used, their values must be numbers</li> <li><code>+ - * / % **(exponential function)</code> are supported by shell script.</li> </ul> <p><strong>Brace Expansion</strong></p> <ul> <li>create multiple text strings from a pattern containing braces<ul> <li>i.e. <code>echo Front-{A,B,C}-Back</code></li> <li>i.e. <code>echo Front-{1..5}-Back</code></li> </ul> </li> <li>Common good application is to make lists of files or directories to be created<ul> <li>i.e. <code>mkdir {2007..2009}-0{1..9} {2007..2009}-{10..12}</code></li> </ul> </li> </ul> <p><strong>Parameter Expansion</strong></p> <ul> <li>make use of the system's ability to store small chunks of data and give each chunk a name (shell variables).</li> <li><code>printenv</code> gives all available variables</li> </ul> <p><strong>Command Substitution</strong></p> <ul> <li>allows us to use the output of a command as an expansion, like this: <code>echo $(ls)</code>, <code>ls -l $(which cp)</code></li> <li>alternatively, can also use back-quotes to do the same thing: <code>ls -l `which cp`</code></li> </ul> <p><strong>Quoting</strong></p> <ul> <li>some special characters may need escapes using <code>\</code> or simply using double quotes "" to include the parts having special characters</li> <li>speical characters quoted within <code>''</code> don't need to be escaped</li> </ul> <p>Here is a comparison of three levels of expansion suppressions</p> <div class=highlight><pre><span></span><code><span class=nb>echo</span> text ~/*.txt <span class=o>{</span>a,b<span class=o>}</span> <span class=k>$(</span><span class=nb>echo</span> foo<span class=k>)</span> <span class=k>$((</span><span class=m>2</span><span class=o>+</span><span class=m>2</span><span class=k>))</span> <span class=nv>$USER</span>
<span class=c1># text /home/me/ls-output.txt a b foo 4 me</span>
<span class=nb>echo</span> <span class=s2>&quot;text ~/*.txt {a,b} </span><span class=k>$(</span><span class=nb>echo</span> foo<span class=k>)</span><span class=s2> </span><span class=k>$((</span><span class=m>2</span><span class=o>+</span><span class=m>2</span><span class=k>))</span><span class=s2> </span><span class=nv>$USER</span><span class=s2>&quot;</span>
<span class=c1># text ~/*.txt {a,b} foo 4 me</span>
<span class=nb>echo</span> <span class=s1>&#39;text ~/*.txt {a,b} $(echo foo) $((2+2)) $USER&#39;</span>
<span class=c1># text ~/*.txt {a,b} $(echo foo) $((2+2)) $USER</span>
</code></pre></div> <p>use backslash also to start a new line for a single line of command. Like this:</p> <div class=highlight><pre><span></span><code>ls -l <span class=se>\</span>
    --reverse <span class=se>\</span>
    --human-readable <span class=se>\</span>
    --full-time
</code></pre></div> <p>Sometimes use the long version of the options help you read and know its purpose instantly.</p> <p><br></p> <h3 id=permissions>Permissions<a class=headerlink href=#permissions title="Permanent link">&para;</a></h3> <p>Linux is a multitasking and multi-user system.</p> <ul> <li>chmod - modify file access rights<ul> <li>rwx = 111, rw- = 110, r-x = 101, r-- 4, ...</li> <li><code>chmod 600 some_file</code> makes the file only read/writable for the user, strips the rights for group and global</li> <li>for directory, x allows directory to be entered. r/w is for its contents to be listed/modified</li> </ul> </li> <li>su - temporarily become the superuser</li> <li>sudo - temporarily become the superuser</li> <li>chown - change file ownership<ul> <li><code>chown new_owner_username file</code></li> <li>superuser or owner can do this</li> </ul> </li> <li>chgrp - change a file's group ownership<ul> <li><code>chgrp new_group_name file</code></li> <li>only owner can do this</li> </ul> </li> </ul> <p><strong>Frequently used file permission settings</strong></p> <table> <thead> <tr> <th>Value -</th> <th>- Meaning</th> </tr> </thead> <tbody> <tr> <td><code>777</code></td> <td>(rwxrwxrwx) No restriction on permission.</td> </tr> <tr> <td><code>755</code></td> <td>(rwxr-xr-x) Owner may read/write/exec, no one else may write the file but only read/exec</td> </tr> <tr> <td><code>700</code></td> <td>(rwx------) Only Owner has all access</td> </tr> <tr> <td><code>666</code></td> <td>(rw-rw-rw-) All users may read/write, not exec</td> </tr> <tr> <td><code>644</code></td> <td>(rw-r--r--) Owner may read/write, others can only read</td> </tr> <tr> <td><code>600</code></td> <td>(rw-------) Owner read/write only</td> </tr> </tbody> </table> <p><br></p> <h3 id=job-control>Job Control<a class=headerlink href=#job-control title="Permanent link">&para;</a></h3> <p>commands used to control processes.</p> <ul> <li><code>ps</code> - list the processes running on the system</li> <li><code>kill</code> - send a terminate signal to one or more processes (usually to "kill" a process)</li> <li><code>jobs</code> - an alternate way of listing your own processes</li> <li><code>bg</code> - put a process in the background</li> <li><code>fg</code> - put a process in the forground</li> </ul> <p><strong>Some commond kill signals</strong></p> <table> <thead> <tr> <th>Signal# -</th> <th>- Name -</th> <th>- Description</th> </tr> </thead> <tbody> <tr> <td><code>1</code></td> <td>SIGHUP</td> <td>Hang up signal. Programs can listen for this signal and act upon it. This signal is sent to processes running in a terminal when you close the terminal.</td> </tr> <tr> <td><code>2</code></td> <td>SIGINT</td> <td>Interrupt signal. This signal is given to processes to interrupt them. Programs can process this signal and act upon it. You can also issue this signal directly by typing Ctrl-c in the terminal window where the program is running.</td> </tr> <tr> <td><code>15</code></td> <td>SIGTERM</td> <td>Termination signal. This signal is given to processes to terminate them. Again, programs can process this signal and act upon it. This is the default signal sent by the kill command if no signal is specified.</td> </tr> <tr> <td><code>9</code></td> <td>SIGKILL</td> <td>Kill signal. This signal causes the immediate termination of the process by the Linux kernel. Programs cannot listen for this signal.</td> </tr> </tbody> </table> <p><br></p> <h3 id=editing-shell-scripts>Editing Shell Scripts<a class=headerlink href=#editing-shell-scripts title="Permanent link">&para;</a></h3> <p><strong>environment</strong></p> <p>The Linux environment contains your path, your user name, etc. A complete list of the environment entries can be viewed using the command <code>set</code>.</p> <p>Two types of commands are often contained in the environment: <em>aliases</em> and <em>shell functions</em>.</p> <p>Login shells read one or more startup files:</p> <table> <thead> <tr> <th>File -</th> <th>- Contents</th> </tr> </thead> <tbody> <tr> <td><code>/etc/profile</code></td> <td>A global configuration script that applies to all users.</td> </tr> <tr> <td><code>~/.bash_profile</code></td> <td>A user's personal startup file. Can be used to extend or override settings in the global configuration script.</td> </tr> <tr> <td><code>~/.bash_login</code></td> <td>If ~/.bash_profile is not found, bash attempts to read this script.</td> </tr> <tr> <td><code>~/.profile</code></td> <td>If neither ~/.bash_profile nor ~/.bash_login is found, bash attempts to read this file.</td> </tr> </tbody> </table> <p>Non-login shell sessions read the following:</p> <table> <thead> <tr> <th>File -</th> <th>- Contents</th> </tr> </thead> <tbody> <tr> <td><code>/etc/bash.bashrc</code></td> <td>A global configuration script that applies to all users.</td> </tr> <tr> <td><code>~/.bashrc</code></td> <td>A user's personal startup file. Can be used to extend or override settings in the global configuration script.</td> </tr> </tbody> </table> <p><strong>Creating alias</strong> for longer commands can be set like this <code>alias today='date +"%A, %B %-d, %Y"'</code></p> <p><br></p> <h3 id=creating-shell-functions>Creating shell functions<a class=headerlink href=#creating-shell-functions title="Permanent link">&para;</a></h3> <ul> <li>inside a shell script, functions can be invoked by just using its name, or using <code>$(func_name)</code></li> <li>shell commands can be called within functions simply with the command name.</li> <li>functions must be defined before using them.</li> </ul> <div class=highlight><pre><span></span><code>today<span class=o>()</span> <span class=o>{</span>
    <span class=nb>echo</span> -n <span class=s2>&quot;Today&#39;s date is: &quot;</span>
    date +<span class=s2>&quot;%A, %B %-d, %Y&quot;</span>
<span class=o>}</span>
<span class=c1># same as</span>
<span class=k>function</span> today <span class=o>{</span>
    <span class=nb>echo</span> -n <span class=s2>&quot;Today&#39;s date is: &quot;</span>
    date +<span class=s2>&quot;%A, %B %-d, %Y&quot;</span>
<span class=o>}</span>
</code></pre></div> <p>A function local variables can be declared by appending <code>local</code> before it, like this: <code>local argc=0</code></p> <p><br></p> <h3 id=here-script>Here Script<a class=headerlink href=#here-script title="Permanent link">&para;</a></h3> <p>A <strong>here script</strong> (a.k.a. <strong>here document</strong>) is an additional form of <strong>I/O redirection</strong>.</p> <p>It provides a way to include content that will be given to the standard input of a command.</p> <div class=highlight><pre><span></span><code><span class=nb>command</span> <span class=s>&lt;&lt; token</span>
<span class=s>content to be used as the command&#39;s standard input</span>
<span class=s>more lines here... until</span>
<span class=s>token</span>
</code></pre></div> <p><code>token</code> can be any string of characters, by convention is <code>EOF</code></p> <p>Another trick to have the here script ignoring the leading <code>tabs</code> (not spaces) is by writing it this way:</p> <div class=highlight><pre><span></span><code><span class=nb>command</span> <span class=s>&lt;&lt;- token</span>
<span class=s>  line1</span>
<span class=s>  line2</span>
<span class=s>  ...</span>
<span class=s>token</span>
</code></pre></div> <p><br></p> <h3 id=variables>Variables<a class=headerlink href=#variables title="Permanent link">&para;</a></h3> <p>define and use a variable:</p> <div class=highlight><pre><span></span><code><span class=nv>var_name</span><span class=o>=</span><span class=s2>&quot;value&quot;</span> <span class=c1># to define</span>
<span class=nv>$var_name</span> <span class=c1># to use it</span>
</code></pre></div> <p>Rules for variables:</p> <ul> <li>names must start with a letter</li> <li>names contain no embedded spaces; use underscores instead</li> <li>names cannot use punctuation marks</li> </ul> <p><strong>Environment Variables</strong></p> <p>use <code>printenv</code> to view all environment variables loaded by shell</p> <p>These environment variables can be accessed directly in the shell script running within current shell session.</p> <p>Environment variables names are uppercase by convention.</p> <p><strong>Inline commands</strong></p> <ul> <li>we can have shell substitute the results of a command to existing script by using: <code>$(command_here)</code></li> <li>can also assign the result of a command to a variable: <code>var_1=$(command_here)</code></li> <li>variables inside <code>$(())</code> don't need a '$'</li> <li>Variables can be directly replaced with its value inside "" quoted strings, like so <code>"Today's date: $date"</code></li> </ul> <p><br></p> <h3 id=control-flow>Control flow<a class=headerlink href=#control-flow title="Permanent link">&para;</a></h3> <p>An <strong>if/else block</strong></p> <div class=highlight><pre><span></span><code><span class=k>if</span> <span class=o>(</span>condition_expression<span class=o>)</span><span class=p>;</span> <span class=k>then</span>
  commands...
<span class=k>elif</span> <span class=o>(</span>condition_expression<span class=o>)</span><span class=p>;</span> <span class=k>then</span>
  commands...
<span class=k>else</span>
  commands...
<span class=k>fi</span>
</code></pre></div> <p>An <strong>switch/case block</strong></p> <div class=highlight><pre><span></span><code><span class=k>case</span> <span class=nv>$character</span> <span class=k>in</span>
  <span class=m>1</span> <span class=o>)</span> <span class=nb>echo</span> <span class=s2>&quot;character is: 1&quot;</span> <span class=p>;;</span>
  <span class=m>2</span> <span class=o>)</span> <span class=nb>echo</span> <span class=s2>&quot;character is: 2&quot;</span> <span class=p>;;</span>
  <span class=m>3</span> <span class=o>)</span> <span class=nb>echo</span> <span class=s2>&quot;character is: 3&quot;</span> <span class=p>;;</span>
  <span class=m>4</span><span class=p>|</span><span class=m>5</span><span class=p>|</span><span class=m>6</span> <span class=o>)</span> <span class=nb>echo</span> <span class=s2>&quot;character matched one of: 4 5 6&quot;</span> <span class=p>;;</span>
  * <span class=o>)</span> <span class=nb>echo</span> <span class=s2>&quot;character matched to be anything else&quot;</span> <span class=p>;;</span>
<span class=k>esac</span>
</code></pre></div> <p><strong>Loops: while, until, and for</strong></p> <p>An <strong>while block</strong></p> <div class=highlight><pre><span></span><code><span class=nv>number</span><span class=o>=</span><span class=m>0</span>
<span class=k>while</span> <span class=o>[</span> <span class=s2>&quot;</span><span class=nv>$number</span><span class=s2>&quot;</span> -lt <span class=m>10</span> <span class=o>]</span><span class=p>;</span> <span class=k>do</span>
  <span class=nb>echo</span> <span class=s2>&quot;Number = </span><span class=nv>$number</span><span class=s2>&quot;</span>
  <span class=nv>number</span><span class=o>=</span><span class=k>$((</span>number <span class=o>+</span> <span class=m>1</span><span class=k>))</span>
<span class=k>done</span>
</code></pre></div> <p>An <strong>until block</strong> does exact the same thing as the while example</p> <div class=highlight><pre><span></span><code><span class=nv>number</span><span class=o>=</span><span class=m>0</span>
<span class=k>until</span> <span class=o>[</span> <span class=s2>&quot;</span><span class=nv>$number</span><span class=s2>&quot;</span> -ge <span class=m>10</span> <span class=o>]</span><span class=p>;</span> <span class=k>do</span>
  <span class=nb>echo</span> <span class=s2>&quot;Number = </span><span class=nv>$number</span><span class=s2>&quot;</span>
  <span class=nv>number</span><span class=o>=</span><span class=k>$((</span>number <span class=o>+</span> <span class=m>1</span><span class=k>))</span>
<span class=k>done</span>
</code></pre></div> <p>An <strong>for block</strong> assigns a word form a list of words to the specified variable, executes the commands, repeats until all words are exhausted.</p> <div class=highlight><pre><span></span><code><span class=k>for</span> variable <span class=k>in</span> words<span class=p>;</span> <span class=k>do</span>
  commands
<span class=k>done</span>
</code></pre></div> <p><strong>for</strong> treats a string of text as a list of words by breaking by space chars</p> <div class=highlight><pre><span></span><code><span class=nv>count</span><span class=o>=</span><span class=m>0</span>
<span class=k>for</span> i <span class=k>in</span> <span class=k>$(</span>cat ~/.bash_profile<span class=k>)</span><span class=p>;</span> <span class=k>do</span>
  <span class=nv>count</span><span class=o>=</span><span class=k>$((</span>count <span class=o>+</span> <span class=m>1</span><span class=k>))</span>
  <span class=nb>echo</span> <span class=s2>&quot;Word </span><span class=nv>$count</span><span class=s2> (</span><span class=nv>$i</span><span class=s2>) contains </span><span class=k>$(</span><span class=nb>echo</span> -n <span class=nv>$i</span> <span class=p>|</span> wc -c<span class=k>)</span><span class=s2> characters&quot;</span>
<span class=k>done</span>
</code></pre></div> <p><strong>Exit Status</strong>: a zero exit-code indicates <strong>success</strong> by convention.</p> <ul> <li>Exit status can be examined by variable <code>$?</code> after running a program/script.</li> <li>Shell provides <code>true</code> and <code>false</code> commands that do nothing except terminate with either a zero or one exit status</li> <li><code>exit</code> command causes the script to terminate immediately and set the exit status to a value, like this <code>exit 5</code></li> </ul> <p><strong>test/assertion</strong></p> <p><code>test</code> command is used most often as the condition check command. If the given expression is true, <code>test</code> exits with status 0; otherwise it exits with status 1.</p> <div class=highlight><pre><span></span><code><span class=nb>test</span> expression
<span class=c1># is the same as</span>
<span class=o>[</span> expression <span class=o>]</span> <span class=c1># spaces are required!!</span>
<span class=c1># or</span>
<span class=o>[[</span> expression <span class=o>]]</span> <span class=c1># spaces are required!! also use this everywhere, it is better than [ ]</span>
</code></pre></div> <p>Most cases test can be used as a shortcut for <code>if</code>, like this <code>test -e path_to_file &amp;&amp; echo "exist" || echo "not exist"</code></p> <p>In the <code>if</code> statement, a exit code of 0 evaluated as 'true' while other exit codes are evaluated as 'false'</p> <div class=highlight><pre><span></span><code><span class=k>if</span> <span class=o>[</span> -f .bash_profile <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
    <span class=nb>echo</span> <span class=s2>&quot;You have a .bash_profile. Things are fine.&quot;</span>
<span class=k>else</span>
    <span class=nb>echo</span> <span class=s2>&quot;Yikes! You have no .bash_profile!&quot;</span>
<span class=k>fi</span>
</code></pre></div> <p><em>;</em> the semicolon allows command statements to appear on the same line.</p> <p>A full list of <strong><code>test</code> options</strong></p> <table> <thead> <tr> <th>option -</th> <th>- meaning</th> </tr> </thead> <tbody> <tr> <td><code>-e</code></td> <td>exists?</td> </tr> <tr> <td><code>-f</code></td> <td>is a <strong>file</strong>?</td> </tr> <tr> <td><code>-d</code></td> <td>is a <strong>directory</strong>?</td> </tr> <tr> <td><code>-b</code></td> <td>is a block device?</td> </tr> <tr> <td><code>-c</code></td> <td>is a character device?</td> </tr> <tr> <td><code>-S</code></td> <td>is a Socket file?</td> </tr> <tr> <td><code>-P</code></td> <td>is a FIFO (pipe) file?</td> </tr> <tr> <td><code>-L</code></td> <td>is a link?</td> </tr> <tr> <td><code>-r</code></td> <td><strong>read privilege</strong>?</td> </tr> <tr> <td><code>-w</code></td> <td><strong>write privilege</strong>?</td> </tr> <tr> <td><code>-x</code></td> <td><strong>execute privilege</strong>?</td> </tr> <tr> <td><code>-u</code></td> <td>having SUID property?</td> </tr> <tr> <td><code>-g</code></td> <td>having SGID property?</td> </tr> <tr> <td><code>-k</code></td> <td>having sticky bit?</td> </tr> <tr> <td><code>-s</code></td> <td><strong>exists and non empty</strong>?</td> </tr> <tr> <td><code>$file1 -nt $file2</code></td> <td>file1 newer than file2?</td> </tr> <tr> <td><code>$file1 -ot $file2</code></td> <td>file1 older than file2?</td> </tr> <tr> <td><code>$file1 -ef $file2</code></td> <td>file1 the same file as file2? check whether they point to the same <strong>inode</strong></td> </tr> <tr> <td><code>$n1 -eq $n2</code></td> <td>strings equal?</td> </tr> <tr> <td><code>$n1 -ne $n2</code></td> <td>strings not equal?</td> </tr> <tr> <td><code>$n1 -gt $n2</code></td> <td>greater than?</td> </tr> <tr> <td><code>$n1 -lt $n2</code></td> <td>less than?</td> </tr> <tr> <td><code>$n1 -ge $n2</code></td> <td>greater than or equal?</td> </tr> <tr> <td><code>$n1 -le $n2</code></td> <td>less than or equal?</td> </tr> <tr> <td><code>-z string</code></td> <td>whether string is empty?</td> </tr> <tr> <td><code>-n string</code></td> <td>whether string is not empty?</td> </tr> <tr> <td><code>test $var1 == $var2</code></td> <td>var1 is the same as var2?</td> </tr> <tr> <td><code>test $var1 != $var2</code></td> <td>var1 is not the same as var2?</td> </tr> <tr> <td><code>-a</code></td> <td><strong>and</strong>, same as <code>&amp;&amp;</code></td> </tr> <tr> <td><code>-o</code></td> <td><strong>or</strong>, same as <code>||</code></td> </tr> <tr> <td><code>!</code></td> <td><strong>not</strong></td> </tr> </tbody> </table> <p><br></p> <h3 id=io-redirection>I/O Redirection<a class=headerlink href=#io-redirection title="Permanent link">&para;</a></h3> <p>redirect output of commands to files, devices, and input of other commands.</p> <p><strong>Std I/O</strong></p> <ul> <li><code>ls &gt; file.txt</code> write output to file.txt, create if not exist</li> <li><code>ls &gt;&gt; file.txt</code> append output to file.txt, create if not exist</li> <li><code>sort &lt; file.txt</code> redirect file.txt contents to command <code>sort</code> as input</li> <li><code>ls -l | less</code> piping output of <code>ls</code> to program <code>less</code> as input</li> </ul> <p>Whenever a new program is run on the system, the kernel creates a table of <strong>file descriptors</strong> for the program to use.</p> <ul> <li>File descriptors are <strong>pointers</strong> to files.</li> <li>By convention, <strong>descriptors</strong> <code>0 (STDIN)</code>, <code>1 (STDOUT)</code>, and <code>2 (STDERR)</code> are available.</li> <li>Initially, all three descriptors point to the <em>terminal device</em> (which the system treats as a read/write file)</li> <li><strong>Redirection</strong> is the process of manipulating the file descriptors so that input and output can be routed from/to different files.</li> <li>the shell assumes we want to redirect standard output if the file descriptor is omitted.</li> </ul> <div class=highlight><pre><span></span><code><span class=nb>command</span> &gt; file
<span class=nb>command</span> <span class=m>1</span>&gt; file
<span class=c1># the above two are equivalent, so as the following two lines</span>
<span class=nb>command</span> &lt; file
<span class=nb>command</span> <span class=m>0</span>&lt; file
</code></pre></div> <p><strong>Duplicating File Descriptors</strong></p> <ul> <li>i.e. <code>command 1&gt; file 2&gt;&amp;1</code> to achieve sending both STDOUT and STDERR to the <em>file</em><ul> <li>first redirects STDOUT to 1, which is to the <em>file</em></li> <li>then redirects STDERR to 1 (the <em>file</em>)</li> </ul> </li> </ul> <p><strong>Create additional File Descriptors</strong></p> <div class=highlight><pre><span></span><code><span class=nb>exec</span> <span class=m>3</span>&gt; some_file.txt <span class=c1># Open new file descriptor 3</span>
<span class=nb>command</span> <span class=m>1</span>&gt;<span class=p>&amp;</span><span class=m>3</span> <span class=c1># redirect STDOUT to file descriptor 3</span>
<span class=nb>exec</span> <span class=m>3</span>&gt;<span class=p>&amp;</span>- <span class=c1># Close file descriptor 3</span>
</code></pre></div> <p><strong>Debug Mode</strong></p> <ul> <li>Simply include <code>#!/bin/bash -x</code> at the beginning of the file.</li> <li>Alternatively, use <code>set -x</code> to turn tracing on and <code>set +x</code> to turn tracing off.</li> </ul> <p><br></p> <h3 id=take-user-inputs>Take user inputs<a class=headerlink href=#take-user-inputs title="Permanent link">&para;</a></h3> <p><code>read</code> command takes input from the keyboard</p> <ul> <li>if <code>-s</code> option is passed, user's typing will not be displayed</li> <li>if <code>-t</code> option is passes, user has only specified seconds to enter the information.</li> <li><code>read text</code> will store user's input into variable <code>text</code></li> <li><code>read -p "prompt\t" var</code> will print a prompt before asking</li> </ul> <p><br></p> <h3 id=positional-parameters>Positional parameters<a class=headerlink href=#positional-parameters title="Permanent link">&para;</a></h3> <ul> <li>these are special variables <code>$0 through $9</code> that contain the contents of the command line arguments</li> <li><code>$?</code> contains the exit status of last executed command/script</li> <li><code>$#</code> contains the number of items on the command line in addition to the name of the command <code>$0</code></li> <li><code>shift</code> is a shell built-in that operates on the positional parameters.<ul> <li>Each time calling <code>shift</code>, the arguments <code>$2</code> becomes <code>$1</code>, <code>$3</code> becomes <code>$2</code>, so on.</li> <li><code>shift</code> can follow a number, <code>shift 3</code> means move and discard 3 arguments</li> </ul> </li> </ul> <div class=highlight><pre><span></span><code><span class=k>while</span> <span class=o>[</span> <span class=s2>&quot;</span><span class=nv>$1</span><span class=s2>&quot;</span> -ne <span class=s2>&quot;&quot;</span> <span class=o>]</span><span class=p>;</span> <span class=k>do</span>
  <span class=nb>echo</span> <span class=s2>&quot;Parameter 1 equals </span><span class=nv>$1</span><span class=s2>&quot;</span>
  <span class=nb>echo</span> <span class=s2>&quot;now have </span><span class=nv>$#</span><span class=s2> positional parameters&quot;</span>
  <span class=nb>shift</span>
<span class=k>done</span>
</code></pre></div> <p><br></p> <h3 id=error-handling>Error Handling<a class=headerlink href=#error-handling title="Permanent link">&para;</a></h3> <ul> <li>One trivial way is to check <code>$?</code> for status of last command</li> <li>alternatively, can directly check the command's exit code in the <code>if [ command ]; then</code></li> </ul> <div class=highlight><pre><span></span><code>error_exit<span class=o>()</span>
<span class=o>{</span>
    <span class=nb>echo</span> <span class=s2>&quot;</span><span class=nv>$1</span><span class=s2>&quot;</span> <span class=m>1</span>&gt;<span class=p>&amp;</span><span class=m>2</span>
    <span class=nb>exit</span> <span class=m>1</span>
<span class=o>}</span>
<span class=k>if</span> <span class=nb>cd</span> <span class=nv>$some_directory</span><span class=p>;</span> <span class=k>then</span>
    rm *
<span class=k>else</span>
    error_exit <span class=s2>&quot;Cannot change directory!  Aborting.&quot;</span>
<span class=k>fi</span>
</code></pre></div> <p>here <code>$1</code> in <code>error_exit()</code> function is the first argument</p> <p>By using <code>&amp;&amp;</code> or <code>||</code> can simplify the above example to the following:</p> <div class=highlight><pre><span></span><code><span class=nb>cd</span> <span class=nv>$some_directory</span> <span class=o>||</span> error_exit <span class=s2>&quot;Cannot change directory! Aborting&quot;</span>
rm *
<span class=c1># or simply</span>
<span class=nb>cd</span> <span class=nv>$some_directory</span> <span class=o>&amp;&amp;</span> rm *
</code></pre></div> <p>A more slicker example of <code>error_exit</code> function:</p> <div class=highlight><pre><span></span><code><span class=nv>PROGNAME</span><span class=o>=</span><span class=k>$(</span>basename <span class=nv>$0</span><span class=k>)</span>
error_exit<span class=o>()</span>
<span class=o>{</span>
    <span class=nb>echo</span> <span class=s2>&quot;</span><span class=si>${</span><span class=nv>PROGNAME</span><span class=si>}</span><span class=s2>: </span><span class=si>${</span><span class=nv>1</span><span class=k>:-</span><span class=s2>&quot;Unknown Error&quot;</span><span class=si>}</span><span class=s2>&quot;</span> <span class=m>1</span>&gt;<span class=p>&amp;</span><span class=m>2</span>
    <span class=nb>exit</span> <span class=m>1</span>
<span class=o>}</span>
</code></pre></div> <p>As shown before, the <code>1:-</code> means if variable <code>$1</code> is undefined, a default value "Unknown Error" is used.</p> <p><br></p> <h3 id=signals-and-traps>Signals and Traps<a class=headerlink href=#signals-and-traps title="Permanent link">&para;</a></h3> <p>Errors are not the only way a script can terminate unexpectedly. Signals can do too.</p> <p><strong>SIGINT</strong> is a signal sent to the script when user pressed <code>ctrl-c</code> in the middle of the program execution</p> <p><code>trap</code> is the command allows you to execute a command/function when a signal is received by your script</p> <ul> <li><code>trap &lt;arg&gt; &lt;signals&gt;</code></li> <li><code>&lt;signals&gt;</code> is a list of signals to intercept</li> <li><code>&lt;arg&gt;</code> is a command or function to execute when one of the signals is received.</li> <li>i.e. <code>trap "rm $TEMP_FILE; exit" SIGHUP SIGINT SIGTERM</code></li> <li>The signals can be specified by number as well.<ul> <li>signal <code>9 (SIGKILL)</code> however, cannot be handled.</li> <li>many programs create <strong>lock files</strong> to prevent multiple copies of the program running at the same time.</li> <li>A program killed by <code>SIGKILL</code> doesn't get the chance to remove the lock file, which has to be manually removed for restarting the program</li> </ul> </li> <li>it is better to write a function that does the clean up, and pass it to <code>trap</code>: <code>trap clean_up SIGHUP SIGINT SIGTERM</code></li> </ul> <p>A best practice in shell scripting is to use <strong>absolute path</strong> instead of <strong>relative path</strong> to ensure the correctness!</p> </article> </div> </div> </main> <footer class=md-footer> <div class=md-footer-nav> <nav class="md-footer-nav__inner md-grid" aria-label=Footer> <a href=../../Perl/Perl-Lang-Specs/ class="md-footer-nav__link md-footer-nav__link--prev" rel=prev> <div class="md-footer-nav__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer-nav__title> <div class=md-ellipsis> <span class=md-footer-nav__direction> Previous </span> Perl Language Reference </div> </div> </a> <a href=../../Github-Markdown/ class="md-footer-nav__link md-footer-nav__link--next" rel=next> <div class=md-footer-nav__title> <div class=md-ellipsis> <span class=md-footer-nav__direction> Next </span> Github Markdown Guide </div> </div> <div class="md-footer-nav__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <script src=../../../assets/javascripts/vendor.53cc9318.min.js></script> <script src=../../../assets/javascripts/bundle.e9c9f54f.min.js></script><script id=__lang type=application/json>{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script> <script>
        app = initialize({
          base: "../../..",
          features: ['navigation.tabs', 'navigation.instant'],
          search: Object.assign({
            worker: "../../../assets/javascripts/worker/search.9c0e82ba.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script> </body> </html>